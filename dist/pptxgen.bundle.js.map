{"version":3,"sources":["pptxgen.bundle.js"],"names":["JSZip","require","sizeOf","$","Number","isInteger","value","isFinite","Math","floor","PptxGenJS","doExportPresentation","outputType","arrChartPromises","intSlideNum","zip","folder","file","makeXmlContTypes","makeXmlRootRels","makeXmlApp","makeXmlCore","makeXmlPresentationRels","makeXmlTheme","makeXmlPresentation","makeXmlPresProps","makeXmlTableStyles","makeXmlViewProps","idx","gObjPptx","slideLayouts","length","makeXmlLayout","makeXmlSlideLayoutRel","slides","makeXmlSlide","makeXmlSlideRel","makeXmlMaster","masterSlide","makeXmlMasterRel","forEach","layout","createMediaFiles","slide","Promise","all","then","arrResults","strExportName","fileName","toLowerCase","indexOf","fileExtn","JSZIP_OUTPUT_TYPES","generateAsync","type","saveCallback","content","writeFileToBrowser","catch","strErr","console","error","a","document","createElement","body","appendChild","style","window","navigator","msSaveOrOpenBlob","blobObject","Blob","click","removeChild","URL","createObjectURL","blob","url","href","download","setTimeout","revokeObjectURL","getExcelColName","strName","LETTERS","componentToHex","c","hex","toString","createColorElement","colorStr","innerElements","isHexaRgb","REGEX_HEX_COLOR","test","SCHEME_COLOR_NAMES","warn","DEF_FONT_COLOR","join","tagName","colorAttr","rgbToHex","r","g","b","ex","toUpperCase","inch2Emu","inches","replace","round","EMU","convertImgToDataURLviaCanvas","slideRel","image","Image","onload","this","width","height","canvas","ctx","getContext","drawImage","callbackImgToDataURLDone","toDataURL","onerror","location","path","substring","lastIndexOf","IMG_BROKEN","src","inStr","intEmpty","clbk","rel","i","data","rels","getShapeInfo","shapeName","gObjPptxShapes","RECTANGLE","name","displayName","avLst","objShape","filter","obj","getSmartParseNumber","inVal","inDir","isNaN","parseInt","pptLayout","decodeXmlEntities","createHyperlinkRels","inText","slideRels","arrTextObjects","Array","isArray","text","options","hyperlink","rId","log","intRels","intRelId","push","Target","parseTextToLines","cell","inWidth","CHAR","opts","lineWeight","CPL","font_size","DEF_FONT_SIZE","arrLines","strCurrLine","trim","each","split","line","word","CRLF","getSlidesForTableRows","inArrRows","arrInchMargins","DEF_SLIDE_MARGIN_IN","arrObjTabHeadRows","arrObjSlides","arrRows","currRow","emuTabCurrH","emuSlideTabW","emuSlideTabH","numCols","debug","w","colW","slideMargin","master","margin","cellOpts","colspan","val","x","toFixed","arrColW","iCol","row","iRow","arrCellsLines","arrCellsLineHeights","intMaxLineCnt","intMaxColIdx","y","h","iCell","lines","opt","ONEPT","lineHeight","rowspan","col","extend","addHeaderToEach","headRow","createShadowElement","defaults","isShape","strXml","mix","blur","offset","angle","color","opacity","rotateWithShape","correctShadowOptions","shadowOpts","correctGridLineOptions","glOpts","undefined","size","createGridLineElement","encodeImageRelations","arrRelsDone","idy","inArray","chartPromises","gObjPptxGenerators","createExcelWorksheet","pop","base64","o1","o2","etc","o","arguments","oN","Object","keys","key","makeXmlCharts","showTitle","genXmlTitle","title","fontSize","titleFontSize","DEF_FONT_TITLE_SIZE","titleColor","fontFace","titleFontFace","rotate","titleRotate","titleAlign","titlePos","usesSecondaryValAxis","chartType","valAxisId","secondaryValAxis","AXIS_ID_VALUE_SECONDARY","AXIS_ID_VALUE_PRIMARY","catAxisId","secondaryCatAxis","AXIS_ID_CATEGORY_SECONDARY","AXIS_ID_CATEGORY_PRIMARY","makeChartType","valAxes","Error","catAxes","makeCatAxis","hasArea","some","item","has","makeValueAxis","showDataTable","showDataTableHorzBorder","showDataTableVertBorder","showDataTableOutline","showDataTableKeys","fill","genXmlColorSelection","border","pt","showLegend","legendPos","legendFontSize","barDir","barGrouping","colorIndex","index","strSerColor","chartColors","chartColorsOpacity","lineSize","line_dash","dataBorder","shadow","DEF_SHAPE_SHADOW","lineDataSymbol","lineDataSymbolSize","random","symbolLineColor","lineDataSymbolLineColor","lineDataSymbolLineSize","valueBarColors","BARCHART_COLORS","values","arrColors","invertedColors","catLabelFormatCode","labels","label","lineSmooth","dataLabelFormatCode","dataLabelFontSize","dataLabelColor","dataLabelFontFace","dataLabelPosition","showValue","barGapWidthPct","dataNoEffects","showLabel","showPercent","holeSize","axisId","showCatAxisTitle","catAxisTitle","catAxisTitleFontSize","catAxisTitleColor","catAxisTitleFontFace","catAxisTitleRotate","catAxisOrientation","catAxisHidden","catGridLine","DEF_CHART_GRIDLINE","catAxisLabelFontSize","catAxisLabelColor","catAxisLabelFontFace","catAxisLabelFrequency","catAxisBaseTimeUnit","catAxisMajorTimeUnit","catAxisMinorTimeUnit","catAxisMajorUnit","catAxisMinorUnit","axisPos","crosses","crossAxId","showValAxisTitle","valAxisTitle","valAxisTitleFontSize","valAxisTitleColor","valAxisTitleFontFace","valAxisTitleRotate","valAxisOrientation","valAxisMaxVal","valAxisMinVal","valAxisHidden","valGridLine","valAxisLabelFormatCode","valAxisLabelFontSize","valAxisLabelColor","valAxisLabelFontFace","valAxisMajorUnit","convertRotationDegrees","d","align","sizeAttr","genXmlTextBody","slideObj","isTableCell","tagStart","tagClose","strSlideXml","strXmlBullet","strXmlLnSpc","paragraphPropXml","bullet","breakLine","genXmlBodyProperties","textObj","rtlMode","lineIdx","lineSpacing","indentLevel","paraPropXmlCore","code","bulletCode","BULLET_TYPES","genXmlTextRun","font_face","lang","text_string","parsedText","xmlTextRun","startInfo","bold","italic","underline","subscript","superscript","tooltip","outTextData","total_size_i","objOptions","bodyProperties","bodyProp","wrap","anchor","bIns","lIns","rIns","tIns","shrinkText","autoFit","color_info","back_info","colorVal","fillType","internalElements","outText","alpha","extn","company","subject","author","revision","Date","toISOString","intRelNum","inSlide","slideObjectToXml","slideLayoutObject","slideObject","layoutDefs","map","layoutDef","LAYOUT_IDX_SERIES_BASE","layoutNumber","slideObjectRelationsToXml","target","slideNumber","getLayoutIdxForSlide","masterSlideObject","defaultRels","layoutName","intCurPos","MASTER_OBJECTS","chart","rect","LAYOUTS","LAYOUT_4x3","LAYOUT_16x9","LAYOUT_16x10","LAYOUT_WIDE","LAYOUT_USER","BASE_SHAPES","LINE","DEFAULT","CHECK","STAR","TRIANGLE","CHART_TYPES","AREA","BAR","PIE","DOUGHNUT","PIECHART_COLORS","IMG_PLAYBTN","DEF_CELL_BORDER","DEF_CELL_MARGIN_PT","slideNumberObj","chartCounter","imageCounter","charts","colors","gObjPptxColors","shapes","masters","gObjPptxMasters","clrKey","bind","addBackgroundDefinition","bkg","targetRels","strImgExtn","bkgdImgRid","back","addTextDefinition","resultObject","valign","shape","line_size","inset","addShapeDefinition","addImageDefinition","strImagePath","intPosX","intPosY","intWidth","intHeight","strImageData","sizing","cx","cy","objHyperlink","imageRelId","exec","imgObj","imageRid","addChartDefinition","tmpOpt","chartId","chartRelId","tmpData","concat","lineShadow","globalId","chartRid","createSlideObject","slideDef","bkgd","objects","object","intTableNum","slideItemObj","locationAttr","shapeType","flipH","flipV","arrTabRows","objTableGrid","objTabOpts","intColCnt","intColW","numb","rIdx","cIdx","currColIdx","hmerge","idz","vmerge","rowObj","intRowH","rowH","cellValign","cellColspan","cellRowspan","cellFill","optImp","cellMargin","marginPt","strC","intW","strClr","strAttr","tmp","isTextBox","rectRadius","min","line_head","line_tail","boxW","boxH","boxX","boxY","imageSizingXml","mtype","mediaRid","media","shift","lastRid","max","cover","imgSize","boxDim","imgRatio","isBoxBased","hzPerc","vzPerc","contain","widthBased","crop","imageSize","l","t","chartObject","resolve","reject","zipExcel","strSharedStrings","objData","strTableXml","strSheetXml","getVersion","APP_VER","getLayout","setRTL","inBool","setLayout","inLayout","setTitle","inStrTitle","setAuthor","inStrAuthor","setRevision","inStrRevision","setSubject","inStrSubject","setCompany","inStrCompany","save","inStrExportName","funcCallback","addNewSlide","inMaster","inMasterOpts","slideNum","pageNum","hasSlideNumber","getPageNumber","inObj","addChart","addImage","intSizeX","intSizeY","addMedia","strData","strLink","link","strPath","strType","strExtn","slideObjNum","slideObjRels","addShape","addTable","inOpt","tabOpt","attr","autoPage","arrTableMargin","numColWidth","numTabWidth","currSlide","newPageStartY","addText","objLayout","objOpts","isNumbered","defineSlideMaster","inObjMasterDef","addSlidesForTable","tabEleId","inOpts","api","arrObjTabBodyRows","arrObjTabFootRows","arrTabColW","intTabW","find","outerWidth","intMinWidth","intCalcWidth","arrObjTabCells","arrRGB1","arrRGB2","css","intBorderW","arrRGB","strBorderC","$cell2","clone","html","newSlide","rows","module","exports"],"mappings":"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","file":"pptxgen.bundle.js","sourcesContent":["/*\\\r\n|*|  :: pptxgen.js ::\r\n|*|\r\n|*|  JavaScript framework that creates PowerPoint (pptx) presentations\r\n|*|  https://github.com/gitbrent/PptxGenJS\r\n|*|\r\n|*|  This framework is released under the MIT Public License (MIT)\r\n|*|\r\n|*|  PptxGenJS (C) 2015-2017 Brent Ely -- https://github.com/gitbrent\r\n|*|\r\n|*|  Some code derived from the OfficeGen project:\r\n|*|  github.com/Ziv-Barber/officegen/ (Copyright 2013 Ziv Barber)\r\n|*|\r\n|*|  Permission is hereby granted, free of charge, to any person obtaining a copy\r\n|*|  of this software and associated documentation files (the \"Software\"), to deal\r\n|*|  in the Software without restriction, including without limitation the rights\r\n|*|  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n|*|  copies of the Software, and to permit persons to whom the Software is\r\n|*|  furnished to do so, subject to the following conditions:\r\n|*|\r\n|*|  The above copyright notice and this permission notice shall be included in all\r\n|*|  copies or substantial portions of the Software.\r\n|*|\r\n|*|  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n|*|  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n|*|  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n|*|  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n|*|  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n|*|  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\r\n|*|  SOFTWARE.\r\n\\*/\r\n\r\n/*\r\n  PPTX Units are \"DXA\" (except for font sizing)\r\n  ....: There are 1440 DXA per inch. 1 inch is 72 points. 1 DXA is 1/20th's of a point (20 DXA is 1 point).\r\n  ....: There is also something called EMU's (914400 EMUs is 1 inch, 12700 EMUs is 1pt).\r\n  SEE: https://startbigthinksmall.wordpress.com/2010/01/04/points-inches-and-emus-measuring-units-in-office-open-xml/\r\n  |\r\n  OBJECT LAYOUTS: 16x9 (10\" x 5.625\"), 16x10 (10\" x 6.25\"), 4x3 (10\" x 7.5\"), Wide (13.33\" x 7.5\") and Custom (any size)\r\n  |\r\n  REFS:\r\n  * \"Structure of a PresentationML document (Open XML SDK)\"\r\n  * @see: https://msdn.microsoft.com/en-us/library/office/gg278335.aspx\r\n  * TableStyleId enumeration\r\n  * @see: https://msdn.microsoft.com/en-us/library/office/hh273476(v=office.14).aspx\r\n*/\r\n\r\n\r\n// A: Load depdendencies\r\nvar JSZip = require(\"jszip\");\r\nvar sizeOf = require(\"image-size\");\r\nvar $ = require(\"jquery\");\r\n\r\n// Polyfill for IE11 (https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isInteger)\r\nNumber.isInteger = Number.isInteger || function(value) {\r\n  return typeof value === \"number\" && isFinite(value) && Math.floor(value) === value;\r\n};\r\n\r\nvar PptxGenJS = function(){\r\n  // APP\r\n  var APP_VER = \"1.9.0-beta\";\r\n  var APP_REL = \"20170920\";\r\n\r\n  // CONSTANTS\r\n  var MASTER_OBJECTS = {\r\n    'chart': { name:'chart' },\r\n    'image': { name:'image' },\r\n    'line' : { name:'line'  },\r\n    'rect' : { name:'rect'  },\r\n    'text' : { name:'text'  }\r\n  };\r\n  var LAYOUTS = {\r\n    'LAYOUT_4x3'  : { name: 'screen4x3',   width:  9144000, height: 6858000 },\r\n    'LAYOUT_16x9' : { name: 'screen16x9',  width:  9144000, height: 5143500 },\r\n    'LAYOUT_16x10': { name: 'screen16x10', width:  9144000, height: 5715000 },\r\n    'LAYOUT_WIDE' : { name: 'custom',      width: 12191996, height: 6858000 },\r\n    'LAYOUT_USER' : { name: 'custom',      width: 12191996, height: 6858000 }\r\n  };\r\n  var BASE_SHAPES = {\r\n    'RECTANGLE': { 'displayName': 'Rectangle', 'name': 'rect', 'avLst': {} },\r\n    'LINE'     : { 'displayName': 'Line',      'name': 'line', 'avLst': {} }\r\n  };\r\n  // NOTE: 20170304: BULLET_TYPES: Only default is used so far. I'd like to combine the two peices of code that use these before implementing these as options\r\n  // Since we close <p> within the text object bullets, its slightly more difficult than combining into a func and calling to get the paraProp\r\n  // and i'm not sure if anyone will even use these... so, skipping for now.\r\n  var BULLET_TYPES = {\r\n    'DEFAULT' : \"&#x2022;\",\r\n    'CHECK'   : \"&#x2713;\",\r\n    'STAR'    : \"&#x2605;\",\r\n    'TRIANGLE': \"&#x25B6;\"\r\n  };\r\n  var CHART_TYPES = {\r\n    'AREA'    : { 'displayName':'Area Chart',      'name':'area'     },\r\n    'BAR'     : { 'displayName':'Bar Chart' ,      'name':'bar'      },\r\n    'LINE'    : { 'displayName':'Line Chart',      'name':'line'     },\r\n    'PIE'     : { 'displayName':'Pie Chart' ,      'name':'pie'      },\r\n    'DOUGHNUT': { 'displayName':'Doughnut Chart' , 'name':'doughnut' }\r\n  };\r\n  var PIECHART_COLORS = ['5DA5DA','FAA43A','60BD68','F17CB0','B2912F','B276B2','DECF3F','F15854','A7A7A7', '5DA5DA','FAA43A','60BD68','F17CB0','B2912F','B276B2','DECF3F','F15854','A7A7A7'];\r\n  var BARCHART_COLORS = ['C0504D','4F81BD','9BBB59','8064A2','4BACC6','F79646','628FC6','C86360', 'C0504D','4F81BD','9BBB59','8064A2','4BACC6','F79646','628FC6','C86360'];\r\n  // IMAGES (base64)\r\n  {\r\n    var IMG_BROKEN  = 'data:image/png;base64,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';\r\n    var IMG_PLAYBTN = 'data:image/png;base64,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';\r\n  }\r\n  //\r\n  var CRLF = '\\r\\n'; // AKA: Chr(13) & Chr(10)\r\n  var EMU = 914400;  // One (1) inch (OfficeXML measures in EMU (English Metric Units))\r\n  var ONEPT = 12700; // One (1) point (pt)\r\n  var LAYOUT_IDX_SERIES_BASE = 2147483649;\r\n  var LETTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');\r\n  var JSZIP_OUTPUT_TYPES = ['arraybuffer', 'base64', 'binarystring', 'blob', 'nodebuffer', 'uint8array']; /** @see https://stuk.github.io/jszip/documentation/api_jszip/generate_async.html */\r\n  var REGEX_HEX_COLOR = /^[0-9a-fA-F]{6}$/;\r\n  var SLDNUMFLDID = '{F7021451-1387-4CA6-816F-3879F97B5CBC}';\r\n  //\r\n  var DEF_CELL_BORDER = { color:\"666666\" };\r\n  var DEF_CELL_MARGIN_PT = [3, 3, 3, 3]; // TRBL-style\r\n  var DEF_FONT_COLOR = '000000';\r\n  var DEF_FONT_SIZE = 12;\r\n  var DEF_FONT_TITLE_SIZE = 18;\r\n  var DEF_SLIDE_MARGIN_IN = [0.5, 0.5, 0.5, 0.5]; // TRBL-style\r\n  var DEF_CHART_GRIDLINE = { color: \"888888\", style: \"solid\", size: 1 };\r\n  var DEF_SHAPE_SHADOW = { type: 'outer', blur: 3, offset: (23000 / 12700), angle: 90, color: '000000', opacity: 0.35, rotateWithShape: true };\r\n  var DEF_TEXT_SHADOW = { type: 'outer', blur: 8, offset: 4, angle: 270, color: '000000', opacity: 0.75 };\r\n  var AXIS_ID_VALUE_PRIMARY = '2094734552';\r\n  var AXIS_ID_VALUE_SECONDARY = '2094734553';\r\n  var AXIS_ID_CATEGORY_PRIMARY = '2094734554';\r\n  var AXIS_ID_CATEGORY_SECONDARY = '2094734555';\r\n\r\n  // A: Create internal pptx object\r\n  var gObjPptx = {};\r\n\r\n  // B: Set Presentation Property Defaults\r\n  {\r\n    // Presentation props/metadata\r\n    gObjPptx.author    = 'PptxGenJS';\r\n    gObjPptx.company   = 'PptxGenJS';\r\n    gObjPptx.revision  = '1';\r\n    gObjPptx.subject   = 'PptxGenJS Presentation';\r\n    gObjPptx.title     = 'PptxGenJS Presentation';\r\n\r\n    // PptxGenJS props\r\n    gObjPptx.saveCallback = null;\r\n    gObjPptx.fileName     = 'Presentation';\r\n    gObjPptx.fileExtn     = '.pptx';\r\n    gObjPptx.pptLayout    = LAYOUTS['LAYOUT_16x9'];\r\n    gObjPptx.rtlMode      = false;\r\n\r\n    // PptxGenJS data\r\n    /** @type {object} master slide layout object */\r\n    gObjPptx.masterSlide = {\r\n      slide: {},\r\n      data : [],\r\n      rels : [],\r\n      slideNumberObj: null\r\n    };\r\n\r\n    /** @type {Number} global counter for included charts (used for index in their filenames) */\r\n    gObjPptx.chartCounter = 0;\r\n\r\n    /** @type {Number} global counter for included images (used for index in their filenames) */\r\n    gObjPptx.imageCounter = 0;\r\n\r\n    /** @type {object[]} this Presentations Slides (Slide objects) */\r\n    gObjPptx.slides = [];\r\n\r\n    /** @type {object[]} slide layout definition objects, used for generating slide layout files */\r\n    gObjPptx.slideLayouts = [{\r\n      name : 'BLANK',\r\n      slide: {},\r\n      data : [],\r\n      rels : [],\r\n      margin: DEF_SLIDE_MARGIN_IN,\r\n      slideNumberObj: null\r\n    }];\r\n  }\r\n\r\n  // C: Expose shape library to clients\r\n  this.charts  = CHART_TYPES;\r\n  this.colors  = ( typeof gObjPptxColors  !== 'undefined' ? gObjPptxColors  : {} );\r\n  this.shapes  = ( typeof gObjPptxShapes  !== 'undefined' ? gObjPptxShapes  : BASE_SHAPES );\r\n  this.masters = ( typeof gObjPptxMasters !== 'undefined' ? gObjPptxMasters : {} );\r\n  /* LEGACY/DEPRECATED ^^^ - WILL BE REMOVED in 2.0 */\r\n  // Declare only after `this.colors` is initialized\r\n  var SCHEME_COLOR_NAMES = Object.keys(this.colors).map(function(clrKey){return this.colors[clrKey]}.bind(this));\r\n\r\n  // D: Fall back to base shapes if shapes file was not linked\r\n  gObjPptxShapes =  this.shapes;\r\n\r\n  /* ===============================================================================================\r\n  |\r\n   #####\r\n  #     # ###### #    # ###### #####    ##   #####  ####  #####   ####\r\n  #       #      ##   # #      #    #  #  #    #   #    # #    # #\r\n  #  #### #####  # #  # #####  #    # #    #   #   #    # #    #  ####\r\n  #     # #      #  # # #      #####  ######   #   #    # #####       #\r\n  #     # #      #   ## #      #   #  #    #   #   #    # #   #  #    #\r\n   #####  ###### #    # ###### #    # #    #   #    ####  #    #  ####\r\n  |\r\n  ==================================================================================================\r\n  */\r\n\r\n  var gObjPptxGenerators = {\r\n    /**\r\n     * Adds a background image or color to a slide definition.\r\n     * @param {String|Object} bkg color string or an object with image definition\r\n     * @param {Object} target slide object that the background is set to\r\n     * DEPRECATED `src` is replaced by `path` in v1.5.0\r\n     */\r\n    addBackgroundDefinition: function addBackgroundDefinition(bkg, target) {\r\n      if ( typeof bkg === 'object' && (bkg.src || bkg.path || bkg.data) ) {\r\n        // Allow the use of only the data key (no src reqd)\r\n        bkg.src = bkg.src || bkg.path || null;\r\n        if (!bkg.src) bkg.src = 'preencoded.png';\r\n        var targetRels = target.rels;\r\n        var strImgExtn = bkg.src.substring( bkg.src.indexOf('.')+1 ).toLowerCase();\r\n        if ( strImgExtn == 'jpg' ) strImgExtn = 'jpeg';\r\n        if ( strImgExtn == 'gif' ) strImgExtn = 'png'; // MS-PPT: canvas.toDataURL for gif comes out image/png, and PPT will show \"needs repair\" unless we do this\r\n        // FIXME: The next few lines are copies from .addImage above. A bad idea thats already bit me once! So of course it's makred as future :)\r\n        var intRels = targetRels.length + 1;\r\n        targetRels.push({\r\n          path: bkg.src,\r\n          type: 'image/'+strImgExtn,\r\n          extn: strImgExtn,\r\n          data: (bkg.data || ''),\r\n          rId: intRels,\r\n          Target: '../media/image' + (++gObjPptx.imageCounter) + '.' + strImgExtn\r\n        });\r\n        target.slide.bkgdImgRid = intRels;\r\n      }\r\n      else if ( bkg && typeof bkg === 'string' ) {\r\n        target.slide.back = bkg;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Adds a text object to a slide definition.\r\n     * @param {String} text\r\n     * @param {Object} opt\r\n     * @param {Object} target slide object that the text should be added to\r\n     */\r\n    addTextDefinition: function addTextDefinition(text, opt, target) {\r\n      var opt = ( opt && typeof opt === 'object' ? opt : {} );\r\n      var resultObject = {};\r\n      var text = ( text || '' );\r\n      if ( Array.isArray(text) && text.length == 0 ) text = '';\r\n\r\n      // STEP 2: Set some options\r\n      // Set color (options > inherit from Slide > default to black)\r\n      opt.color = ( opt.color || target.slide.color || DEF_FONT_COLOR );\r\n\r\n      // ROBUST: Convert attr values that will likely be passed by users to valid OOXML values\r\n      if ( opt.valign ) opt.valign = opt.valign.toLowerCase().replace(/^c.*/i,'ctr').replace(/^m.*/i,'ctr').replace(/^t.*/i,'t').replace(/^b.*/i,'b');\r\n      if ( opt.align  ) opt.align  = opt.align.toLowerCase().replace(/^c.*/i,'center').replace(/^m.*/i,'center').replace(/^l.*/i,'left').replace(/^r.*/i,'right');\r\n\r\n      // ROBUST: Set rational values for some shadow props if needed\r\n      correctShadowOptions(opt.shadow);\r\n\r\n      // STEP 3: Set props\r\n      resultObject.type = 'text';\r\n      resultObject.text = text;\r\n\r\n      // STEP 4: Set options\r\n      resultObject.options = opt;\r\n      if ( opt.shape && opt.shape.name == 'line' ) {\r\n        opt.line      = (opt.line      || '333333' );\r\n        opt.line_size = (opt.line_size || 1 );\r\n      }\r\n      resultObject.options.bodyProp = {};\r\n      resultObject.options.bodyProp.autoFit = (opt.autoFit || false); // If true, shape will collapse to text size (Fit To Shape)\r\n      resultObject.options.bodyProp.anchor = (opt.valign || 'ctr'); // VALS: [t,ctr,b]\r\n      resultObject.options.lineSpacing = (opt.lineSpacing && !isNaN(opt.lineSpacing) ? opt.lineSpacing : null);\r\n\r\n      if ( (opt.inset && !isNaN(Number(opt.inset))) || opt.inset == 0 ) {\r\n        resultObject.options.bodyProp.lIns = inch2Emu(opt.inset);\r\n        resultObject.options.bodyProp.rIns = inch2Emu(opt.inset);\r\n        resultObject.options.bodyProp.tIns = inch2Emu(opt.inset);\r\n        resultObject.options.bodyProp.bIns = inch2Emu(opt.inset);\r\n      }\r\n\r\n      target.data.push(resultObject);\r\n      createHyperlinkRels(text || '', target.rels);\r\n\r\n      return resultObject;\r\n    },\r\n\r\n    /**\r\n     * Adds a shape object to a slide definition.\r\n     * @param {Object} shape shape const object (pptx.shapes)\r\n     * @param {Object} opt\r\n     * @param {Object} target slide object that the shape should be added to\r\n     * @return {Object} shape object\r\n     */\r\n    addShapeDefinition: function addShapeDefinition(shape, opt, target) {\r\n      var resultObject = {};\r\n      var options = ( typeof opt === 'object' ? opt : {} );\r\n\r\n      if ( !shape || typeof shape !== 'object' ) {\r\n        console.log(\"ERROR: Missing/Invalid shape parameter! Example: `addShape(pptx.shapes.LINE, {x:1, y:1, w:1, h:1});` \");\r\n        return;\r\n      }\r\n\r\n      resultObject.type = 'text';\r\n      resultObject.options = options;\r\n      options.shape     = shape;\r\n      options.x         = ( options.x || (options.x == 0 ? 0 : 1) );\r\n      options.y         = ( options.y || (options.y == 0 ? 0 : 1) );\r\n      options.w         = ( options.w || 1.0 );\r\n      options.h         = ( options.h || (shape.name == 'line' ? 0 : 1.0) );\r\n      options.line      = ( options.line || (shape.name == 'line' ? '333333' : null) );\r\n      options.line_size = ( options.line_size || (shape.name == 'line' ? 1 : null) );\r\n      if ( ['dash','dashDot','lgDash','lgDashDot','lgDashDotDot','solid','sysDash','sysDot'].indexOf(options.line_dash || '') < 0 ) options.line_dash = 'solid';\r\n\r\n      target.data.push(resultObject);\r\n      return resultObject;\r\n    },\r\n\r\n    /**\r\n     * Adds an image object to a slide definition.\r\n     * This method can be called with only two args (opt, target) - this is supposed to be the only way in future.\r\n     * @param {String|Object} strImagePath image path or object options\r\n     * @param {Number|Object} intPosX x-position or slide object that the image should be addded to\r\n     * @param {Number} intPosY\r\n     * @param {Number} intSizeX\r\n     * @param {Number} intWidth\r\n     * @param {Number} intHeight\r\n     * @param {String} strImageData base64 encoded representation of the image\r\n     * @param {Object} target slide that the image should be added to (if not specified as the 2nd arg)\r\n     * @return {Object} image object\r\n     */\r\n    addImageDefinition: function addImageDefinition(strImagePath, intPosX, intPosY, intWidth, intHeight, strImageData, target) {\r\n      var resultObject = {};\r\n      var sizing = null;\r\n      // FIRST: Set vars for this image (object param replaces positional args in 1.1.0)\r\n      // FIXME: FUTURE: DEPRECATED: Only allow object param in 1.5 or 2.0\r\n      if ( typeof strImagePath === 'object' ) {\r\n        target = intPosX; // if the opts are an object, the second arg is supposed to be a target\r\n        intPosX = (strImagePath.x || 0);\r\n        intPosY = (strImagePath.y || 0);\r\n        intWidth = (strImagePath.cx || strImagePath.w || 0);\r\n        intHeight = (strImagePath.cy || strImagePath.h || 0);\r\n        sizing = strImagePath.sizing || null;\r\n        objHyperlink = (strImagePath.hyperlink || '');\r\n        strImageData = (strImagePath.data || '');\r\n        strImagePath = (strImagePath.path || ''); // IMPORTANT: This line must be last as were about to ovewrite ourself!\r\n      }\r\n\r\n      var imageRelId = target.rels.length + 1;\r\n\r\n      // REALITY-CHECK:\r\n      if ( !strImagePath && !strImageData ) {\r\n        console.error(\"ERROR: `addImage()` requires either 'data' or 'path' parameter!\");\r\n        return null;\r\n      }\r\n      else if ( strImageData && strImageData.toLowerCase().indexOf('base64,') == -1 ) {\r\n        console.error(\"ERROR: Image `data` value lacks a base64 header! Ex: 'image/png;base64,NMP[...]')\");\r\n        return null;\r\n      }\r\n\r\n      // Every image encoded via canvas>base64 is png (as of early 2017 no browser will produce other mime types)\r\n      var strImgExtn = 'png';\r\n      // However, pre-encoded images can be whatever mime-type they want (and good for them!)\r\n      if ( strImageData && /image\\/(\\w+)\\;/.exec(strImageData) && /image\\/(\\w+)\\;/.exec(strImageData).length > 0 ) {\r\n        strImgExtn = /image\\/(\\w+)\\;/.exec(strImageData)[1];\r\n      }\r\n\r\n      resultObject.type  = 'image';\r\n      resultObject.image = (strImagePath || 'preencoded.png');\r\n\r\n      // STEP 3: Set image properties & options\r\n      // FIXME: Measure actual image when no intWidth/intHeight params passed\r\n      // ....: This is an async process: we need to make getSizeFromImage use callback, then set H/W...\r\n      // if ( !intWidth || !intHeight ) { var imgObj = getSizeFromImage(strImagePath);\r\n      var imgObj = { width:1, height:1 };\r\n      resultObject.options = {\r\n        x: (intPosX  || 0),\r\n        y: (intPosY  || 0),\r\n        cx: (intWidth || imgObj.width),\r\n        cy: (intHeight || imgObj.height),\r\n        sizing: sizing\r\n      };\r\n\r\n      // STEP 4: Add this image to this Slide Rels (rId/rels count spans all slides! Count all images to get next rId)\r\n      target.rels.push({\r\n        path: (strImagePath || 'preencoded'+strImgExtn),\r\n        type: 'image/'+strImgExtn,\r\n        extn: strImgExtn,\r\n        data: (strImageData || ''),\r\n        rId:  imageRelId,\r\n        Target: '../media/image'+ (++gObjPptx.imageCounter) +'.'+ strImgExtn\r\n      });\r\n      resultObject.imageRid = imageRelId;\r\n\r\n      // STEP 5: (Issue#77) Hyperlink support\r\n      if ( typeof objHyperlink === 'object' ) {\r\n        if ( !objHyperlink.url || typeof objHyperlink.url !== 'string' ) console.log(\"ERROR: 'hyperlink.url is required and/or should be a string'\");\r\n        else {\r\n          var intRelId = imageRelId + 1;\r\n\r\n          target.rels.push({\r\n            type: 'hyperlink',\r\n            data: 'dummy',\r\n            rId:  intRelId,\r\n            Target: objHyperlink.url\r\n          });\r\n\r\n          objHyperlink.rId = intRelId;\r\n          resultObject.hyperlink = objHyperlink;\r\n        }\r\n      }\r\n\r\n      target.data.push(resultObject);\r\n      return resultObject;\r\n    },\r\n\r\n    /**\r\n     * Generate the chart based on input data.\r\n     * OOXML Chart Spec: ISO/IEC 29500-1:2016(E)\r\n     *\r\n     * @param {object} type should belong to: 'column', 'pie'\r\n     * @param {object} data a JSON object with follow the following format\r\n     * @param {object} opt\r\n     * @param {object} target slide object that the chart should be added to\r\n     * @return {Object} chart object\r\n     * {\r\n     *   title: 'eSurvey chart',\r\n     *   data: [\r\n     *    {\r\n     *      name: 'Income',\r\n     *      labels: ['2005', '2006', '2007', '2008', '2009'],\r\n     *      values: [23.5, 26.2, 30.1, 29.5, 24.6]\r\n     *    },\r\n     *    {\r\n     *      name: 'Expense',\r\n     *      labels: ['2005', '2006', '2007', '2008', '2009'],\r\n     *      values: [18.1, 22.8, 23.9, 25.1, 25]\r\n     *    }\r\n     *   ]\r\n     *  }\r\n     */\r\n    addChartDefinition: function addChartDefinition(type, data, opt, target) {\r\n      var targetRels = target.rels;\r\n      var chartId = (++gObjPptx.chartCounter);\r\n      var chartRelId = target.rels.length + 1;\r\n      var resultObject = {};\r\n      // DESIGN: `type` can an object (ex: `pptx.charts.DOUGHNUT`) or an array of chart objects\r\n      // EX: addChartDefinition([ { type:pptx.charts.BAR, data:{name:'', labels:[], values[]} }, {<etc>} ])\r\n      // Multi-Type Charts\r\n      var tmpOpt;\r\n      var tmpData = [], options;\r\n      if (Array.isArray(type)) {\r\n        // For multi-type charts there needs to be data for each type,\r\n        // as well as a single data source for non-series operations.\r\n        // The data is indexed below to keep the data in order when segmented\r\n        // into types.\r\n        type.forEach(function(obj) {\r\n          tmpData = tmpData.concat(obj.data)\r\n        });\r\n        tmpOpt = data || opt;\r\n      }\r\n      else {\r\n        tmpData = data;\r\n        tmpOpt = opt;\r\n      }\r\n      tmpData.forEach(function(item,i){ item.index = i; });\r\n      options = ( tmpOpt && typeof tmpOpt === 'object' ? tmpOpt : {} );\r\n\r\n      // STEP 1: TODO: check for reqd fields, correct type, etc\r\n      // `type` exists in CHART_TYPES\r\n      // Array.isArray(data)\r\n      /*\r\n      if ( Array.isArray(rel.data) && rel.data.length > 0 && typeof rel.data[0] === 'object'\r\n        && rel.data[0].labels && Array.isArray(rel.data[0].labels)\r\n        && rel.data[0].values && Array.isArray(rel.data[0].values) ) {\r\n        obj = rel.data[0];\r\n      }\r\n      else {\r\n        console.warn(\"USAGE: addChart( 'pie', [ {name:'Sales', labels:['Jan','Feb'], values:[10,20]} ], {x:1, y:1} )\");\r\n        return;\r\n      }\r\n      */\r\n\r\n      // STEP 2: Set default options/decode user options\r\n      // A: Core\r\n      options.type = type;\r\n      options.x = (typeof options.x !== 'undefined' && options.x != null && !isNaN(options.x) ? options.x : 1);\r\n      options.y = (typeof options.y !== 'undefined' && options.y != null && !isNaN(options.y) ? options.y : 1);\r\n      options.w = (options.w || '50%');\r\n      options.h = (options.h || '50%');\r\n\r\n      // B: Options: misc\r\n      if ( ['bar','col'].indexOf(options.barDir || '') < 0 ) options.barDir = 'col';\r\n      // IMPORTANT: 'bestFit' will cause issues with PPT-Online in some cases, so defualt to 'ctr'!\r\n      if ( ['bestFit','b','ctr','inBase','inEnd','l','outEnd','r','t'].indexOf(options.dataLabelPosition || '') < 0 ) options.dataLabelPosition = (options.type.name == 'pie' || options.type.name == 'doughnut' ? 'bestFit' : 'ctr');\r\n      if ( ['b','l','r','t','tr'].indexOf(options.legendPos || '') < 0 ) options.legendPos = 'r';\r\n      // barGrouping: \"21.2.3.17 ST_Grouping (Grouping)\"\r\n      if ( ['clustered','standard','stacked','percentStacked'].indexOf(options.barGrouping || '') < 0 ) options.barGrouping = 'standard';\r\n      if ( options.barGrouping.indexOf('tacked') > -1 ) {\r\n        options.dataLabelPosition = 'ctr'; // IMPORTANT: PPT-Online will not open Presentation when 'outEnd' etc is used on stacked!\r\n        if (!options.barGapWidthPct) options.barGapWidthPct = 50;\r\n      }\r\n      // lineDataSymbol: http://www.datypic.com/sc/ooxml/a-val-32.html\r\n      // Spec has [plus,star,x] however neither PPT2013 nor PPT-Online support them\r\n      if ( ['circle','dash','diamond','dot','none','square','triangle'].indexOf(options.lineDataSymbol || '') < 0 ) options.lineDataSymbol = 'circle';\r\n      options.lineDataSymbolSize = ( options.lineDataSymbolSize && !isNaN(options.lineDataSymbolSize ) ? options.lineDataSymbolSize : 6 );\r\n      options.lineDataSymbolLineSize = ( options.lineDataSymbolLineSize && !isNaN(options.lineDataSymbolLineSize ) ? options.lineDataSymbolLineSize * ONEPT : 0.75 * ONEPT );\r\n      // `layout` allows the override of PPT defaults to maximize space\r\n      if ( options.layout ) {\r\n        ['x', 'y', 'w', 'h'].forEach(function(key) {\r\n          var val = options.layout[key];\r\n          if (isNaN(Number(val)) || val < 0 || val > 1) {\r\n            console.warn('Warning: chart.layout.' + key + ' can only be 0-1');\r\n            delete options.layout[key]; // remove invalid value so that default will be used\r\n          }\r\n        });\r\n      }\r\n\r\n      // use default lines only for y-axis if nothing specified\r\n      options.valGridLine = options.valGridLine || {};\r\n      options.catGridLine = options.catGridLine || 'none';\r\n      correctGridLineOptions(options.catGridLine);\r\n      correctGridLineOptions(options.valGridLine);\r\n\r\n      if ( options.lineShadow ) {\r\n        console.warn('`lineShadow` is deprecated - please switch to `shadow`');\r\n        options.shadow = options.lineShadow;\r\n      }\r\n\r\n      correctShadowOptions(options.shadow);\r\n\r\n      // C: Options: plotArea\r\n      options.showDataTable           = (options.showDataTable           == true || options.showDataTable           == false ? options.showDataTable           : false);\r\n      options.showDataTableHorzBorder = (options.showDataTableHorzBorder == true || options.showDataTableHorzBorder == false ? options.showDataTableHorzBorder : true );\r\n      options.showDataTableVertBorder = (options.showDataTableVertBorder == true || options.showDataTableVertBorder == false ? options.showDataTableVertBorder : true );\r\n      options.showDataTableOutline    = (options.showDataTableOutline    == true || options.showDataTableOutline    == false ? options.showDataTableOutline    : true );\r\n      options.showDataTableKeys       = (options.showDataTableKeys       == true || options.showDataTableKeys       == false ? options.showDataTableKeys       : true );\r\n      options.showLabel     = (options.showLabel     == true || options.showLabel     == false ? options.showLabel     : false);\r\n      options.showLegend    = (options.showLegend    == true || options.showLegend    == false ? options.showLegend    : false);\r\n      options.showPercent   = (options.showPercent   == true || options.showPercent   == false ? options.showPercent   : true );\r\n      options.showTitle     = (options.showTitle     == true || options.showTitle     == false ? options.showTitle     : false);\r\n      options.showValue     = (options.showValue     == true || options.showValue     == false ? options.showValue     : false);\r\n\r\n      // D: Options: chart\r\n      options.barGapWidthPct = (!isNaN(options.barGapWidthPct) && options.barGapWidthPct >= 0 && options.barGapWidthPct <= 1000 ? options.barGapWidthPct : 150);\r\n      options.chartColors = ( Array.isArray(options.chartColors) ? options.chartColors : (options.type == 'pie' || options.type == 'doughnut' ? PIECHART_COLORS : BARCHART_COLORS) );\r\n      options.chartColorsOpacity = ( options.chartColorsOpacity && !isNaN(options.chartColorsOpacity) ? options.chartColorsOpacity : null );\r\n      //\r\n      options.border = ( options.border && typeof options.border === 'object' ? options.border : null );\r\n      if ( options.border && (!options.border.pt || isNaN(options.border.pt)) ) options.border.pt = 1;\r\n      if ( options.border && (!options.border.color || typeof options.border.color !== 'string' || options.border.color.length != 6) ) options.border.color = '363636';\r\n      //\r\n      options.dataBorder = ( options.dataBorder && typeof options.dataBorder === 'object' ? options.dataBorder : null );\r\n      if ( options.dataBorder && (!options.dataBorder.pt || isNaN(options.dataBorder.pt)) ) options.dataBorder.pt = 0.75;\r\n      if ( options.dataBorder && (!options.dataBorder.color || typeof options.dataBorder.color !== 'string' || options.dataBorder.color.length != 6) ) options.dataBorder.color = 'F9F9F9';\r\n      //\r\n      options.dataLabelFormatCode = options.dataLabelFormatCode && typeof options.dataLabelFormatCode === 'string' ? options.dataLabelFormatCode : (options.type.name == 'pie' || options.type.name == 'doughnut') ? '0%' : '#,##0';\r\n      //\r\n      options.lineSize = ( typeof options.lineSize === 'number' ? options.lineSize : 2 );\r\n      options.valAxisMajorUnit = ( typeof options.valAxisMajorUnit === 'number' ? options.valAxisMajorUnit : null );\r\n\r\n      // STEP 4: Set props\r\n      resultObject.type    = 'chart';\r\n      resultObject.options = options;\r\n\r\n      // STEP 5: Add this chart to this Slide Rels (rId/rels count spans all slides! Count all images to get next rId)\r\n      targetRels.push({\r\n        rId:     chartRelId,\r\n        data:    tmpData,\r\n        opts:    options,\r\n        type:    'chart',\r\n        globalId: chartId,\r\n        fileName:'chart'+ chartId +'.xml',\r\n        Target:  '/ppt/charts/chart'+ chartId +'.xml'\r\n      });\r\n      resultObject.chartRid = chartRelId;\r\n\r\n      target.data.push(resultObject);\r\n      return resultObject;\r\n    },\r\n\r\n    /* ===== */\r\n\r\n    /**\r\n     * Transforms a slide definition to a slide object that is then passed to the XML transformation process.\r\n     * The following object is expected as a slide definition:\r\n     * {\r\n     *   bkgd: 'FF00FF',\r\n     *   objects: [{\r\n     *     text: {\r\n     *       text: 'Hello World',\r\n     *       x: 1,\r\n     *       y: 1\r\n     *     }\r\n     *   }]\r\n     * }\r\n     * @param {Object} slideDef slide definition\r\n     * @param {Object} target empty slide object that should be updated by the passed definition\r\n     *\r\n     */\r\n    createSlideObject: function createSlideObject(slideDef, target) {\r\n      // STEP 1: Add background\r\n      if ( slideDef.bkgd ) {\r\n        gObjPptxGenerators.addBackgroundDefinition(slideDef.bkgd, target);\r\n      }\r\n\r\n      // STEP 2: Add all Slide Master objects in the order they were given (Issue#53)\r\n      if ( slideDef.objects && Array.isArray(slideDef.objects) && slideDef.objects.length > 0 ) {\r\n        slideDef.objects.forEach(function(object,idx){\r\n          var key = Object.keys(object)[0];\r\n          if      ( MASTER_OBJECTS[key] && key == 'chart' ) gObjPptxGenerators.addChartDefinition(CHART_TYPES[(object.chart.type||'').toUpperCase()], object.chart.data, object.chart.opts, target);\r\n          else if ( MASTER_OBJECTS[key] && key == 'image' ) gObjPptxGenerators.addImageDefinition(object[key], target);\r\n          else if ( MASTER_OBJECTS[key] && key == 'line'  ) gObjPptxGenerators.addShapeDefinition(gObjPptxShapes.LINE, object[key], target);\r\n          else if ( MASTER_OBJECTS[key] && key == 'rect'  ) gObjPptxGenerators.addShapeDefinition(gObjPptxShapes.RECTANGLE, object[key], target);\r\n          else if ( MASTER_OBJECTS[key] && key == 'text'  ) gObjPptxGenerators.addTextDefinition(object[key].text, object[key].options, target);\r\n        });\r\n      }\r\n\r\n      // STEP 3: Add Slide Numbers (NOTE: Do this last so numbers are not covered by objects!)\r\n      if ( slideDef.slideNumber && typeof slideDef.slideNumber === 'object' ) {\r\n        target.slideNumberObj = slideDef.slideNumber;\r\n      };\r\n    },\r\n\r\n    /**\r\n     * Transforms a slide object to resulting XML string.\r\n     * @param {Object} slideObject slide object created within gObjPptxGenerators.createSlideObject\r\n     * @return {String} XML string with <p:cSld> as the root\r\n     */\r\n    slideObjectToXml: function slideObjectToXml(slideObject) {\r\n      var strSlideXml = slideObject.name ? '<p:cSld name=\"'+ slideObject.name +'\">' : '<p:cSld>';\r\n      var intTableNum = 1;\r\n\r\n      // Background color\r\n      if ( slideObject.slide.back ) {\r\n        strSlideXml += genXmlColorSelection(false, slideObject.slide.back);\r\n      }\r\n      // B: Add background image (using Strech) (if any)\r\n      if ( slideObject.slide.bkgdImgRid ) {\r\n        // FIXME: We should be doing this in the slideLayout...\r\n        strSlideXml += '<p:bg>'\r\n            + '<p:bgPr><a:blipFill dpi=\"0\" rotWithShape=\"1\">'\r\n            + '<a:blip r:embed=\"rId'+ slideObject.slide.bkgdImgRid +'\"><a:lum/></a:blip>'\r\n            + '<a:srcRect/><a:stretch><a:fillRect/></a:stretch></a:blipFill>'\r\n            + '<a:effectLst/></p:bgPr>'\r\n          + '</p:bg>';\r\n      }\r\n\r\n      // STEP 3: Continue slide by starting spTree node\r\n      strSlideXml += '<p:spTree>';\r\n      strSlideXml += '<p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/><p:nvPr/></p:nvGrpSpPr>';\r\n      strSlideXml += '<p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"0\" cy=\"0\"/>';\r\n      strSlideXml += '<a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/></a:xfrm></p:grpSpPr>';\r\n\r\n      // STEP 4: Loop over all Slide.data objects and add them to this slide ===============================\r\n      slideObject.data.forEach(function(slideItemObj, idx) {\r\n        var x = 0, y = 0, cx = getSmartParseNumber('75%','X'), cy = 0;\r\n        var locationAttr = \"\", shapeType = null;\r\n\r\n        // A: Set option vars\r\n        slideItemObj.options = slideItemObj.options || {};\r\n\r\n        if ( slideItemObj.options.w  || slideItemObj.options.w  == 0 ) slideItemObj.options.cx = slideItemObj.options.w;\r\n        if ( slideItemObj.options.h  || slideItemObj.options.h  == 0 ) slideItemObj.options.cy = slideItemObj.options.h;\r\n        //\r\n        if ( slideItemObj.options.x  || slideItemObj.options.x  == 0 )  x = getSmartParseNumber( slideItemObj.options.x , 'X' );\r\n        if ( slideItemObj.options.y  || slideItemObj.options.y  == 0 )  y = getSmartParseNumber( slideItemObj.options.y , 'Y' );\r\n        if ( slideItemObj.options.cx || slideItemObj.options.cx == 0 ) cx = getSmartParseNumber( slideItemObj.options.cx, 'X' );\r\n        if ( slideItemObj.options.cy || slideItemObj.options.cy == 0 ) cy = getSmartParseNumber( slideItemObj.options.cy, 'Y' );\r\n        //\r\n        if ( slideItemObj.options.shape  ) shapeType = getShapeInfo( slideItemObj.options.shape );\r\n        //\r\n        if ( slideItemObj.options.flipH  ) locationAttr += ' flipH=\"1\"';\r\n        if ( slideItemObj.options.flipV  ) locationAttr += ' flipV=\"1\"';\r\n        if ( slideItemObj.options.rotate ) locationAttr += ' rot=\"' + convertRotationDegrees(slideItemObj.options.rotate)+ '\"';\r\n\r\n        // B: Add OBJECT to current Slide ----------------------------\r\n        switch ( slideItemObj.type ) {\r\n          case 'table':\r\n            // FIRST: Ensure we have rows - otherwise, bail!\r\n            if ( !slideItemObj.arrTabRows || (Array.isArray(slideItemObj.arrTabRows) && slideItemObj.arrTabRows.length == 0) ) break;\r\n\r\n            // Set table vars\r\n            var objTableGrid = {};\r\n            var arrTabRows = slideItemObj.arrTabRows;\r\n            var objTabOpts = slideItemObj.options;\r\n            var intColCnt = 0, intColW = 0;\r\n\r\n            // Calc number of columns\r\n            // NOTE: Cells may have a colspan, so merely taking the length of the [0] (or any other) row is not\r\n            // ....: sufficient to determine column count. Therefore, check each cell for a colspan and total cols as reqd\r\n            arrTabRows[0].forEach(function(cell,idx){\r\n              var cellOpts = cell.options || cell.opts || null; // DEPRECATED (`opts`)\r\n              intColCnt += ( cellOpts && cellOpts.colspan ? cellOpts.colspan : 1 );\r\n            });\r\n\r\n            // STEP 1: Start Table XML =============================\r\n            // NOTE: Non-numeric cNvPr id values will trigger \"presentation needs repair\" type warning in MS-PPT-2013\r\n            var strXml = '<p:graphicFrame>'\r\n                + '  <p:nvGraphicFramePr>'\r\n                + '    <p:cNvPr id=\"'+ (intTableNum*slideObject.numb + 1) +'\" name=\"Table '+ (intTableNum*slideObject.numb) +'\"/>'\r\n                + '    <p:cNvGraphicFramePr><a:graphicFrameLocks noGrp=\"1\"/></p:cNvGraphicFramePr>'\r\n                + '    <p:nvPr><p:extLst><p:ext uri=\"{D42A27DB-BD31-4B8C-83A1-F6EECF244321}\"><p14:modId xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"1579011935\"/></p:ext></p:extLst></p:nvPr>'\r\n                + '  </p:nvGraphicFramePr>'\r\n                + '  <p:xfrm>'\r\n                + '    <a:off  x=\"'+ (x  || EMU) +'\"  y=\"'+ (y  || EMU) +'\"/>'\r\n                + '    <a:ext cx=\"'+ (cx || EMU) +'\" cy=\"'+ (cy || EMU) +'\"/>'\r\n                + '  </p:xfrm>'\r\n                + '  <a:graphic>'\r\n                + '    <a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/table\">'\r\n                + '      <a:tbl>'\r\n                + '        <a:tblPr/>';\r\n                // + '        <a:tblPr bandRow=\"1\"/>';\r\n\r\n            // FIXME: Support banded rows, first/last row, etc.\r\n            // NOTE: Banding, etc. only shows when using a table style! (or set alt row color if banding)\r\n            // <a:tblPr firstCol=\"0\" firstRow=\"0\" lastCol=\"0\" lastRow=\"0\" bandCol=\"0\" bandRow=\"1\">\r\n\r\n            // STEP 2: Set column widths\r\n            // Evenly distribute cols/rows across size provided when applicable (calc them if only overall dimensions were provided)\r\n            // A: Col widths provided?\r\n            if ( Array.isArray(objTabOpts.colW) ) {\r\n              strXml += '<a:tblGrid>';\r\n              for ( var col=0; col<intColCnt; col++ ) {\r\n                strXml += '  <a:gridCol w=\"'+ Math.round(inch2Emu(objTabOpts.colW[col]) || (slideItemObj.options.cx/intColCnt)) +'\"/>';\r\n              }\r\n              strXml += '</a:tblGrid>';\r\n            }\r\n            // B: Table Width provided without colW? Then distribute cols\r\n            else {\r\n              intColW = ( objTabOpts.colW ? objTabOpts.colW : EMU );\r\n              if ( slideItemObj.options.cx && !objTabOpts.colW ) intColW = Math.round( slideItemObj.options.cx / intColCnt ); // FIX: Issue#12\r\n              strXml += '<a:tblGrid>';\r\n              for ( var col=0; col<intColCnt; col++ ) { strXml += '<a:gridCol w=\"'+ intColW +'\"/>'; }\r\n              strXml += '</a:tblGrid>';\r\n            }\r\n\r\n            // STEP 3: Build our row arrays into an actual grid to match the XML we will be building next (ISSUE #36)\r\n            // Note row arrays can arrive \"lopsided\" as in row1:[1,2,3] row2:[3] when first two cols rowspan!,\r\n            // so a simple loop below in XML building wont suffice to build table right.\r\n            // We have to build an actual grid now\r\n            /*\r\n              EX: (A0:rowspan=3, B1:rowspan=2, C1:colspan=2)\r\n\r\n              /------|------|------|------\\\r\n              |  A0  |  B0  |  C0  |  D0  |\r\n              |      |  B1  |  C1  |      |\r\n              |      |      |  C2  |  D2  |\r\n              \\------|------|------|------/\r\n            */\r\n            $.each(arrTabRows, function(rIdx,row){\r\n              // A: Create row if needed (recall one may be created in loop below for rowspans, so dont assume we need to create one each iteration)\r\n              if ( !objTableGrid[rIdx] ) objTableGrid[rIdx] = {};\r\n\r\n              // B: Loop over all cells\r\n              $(row).each(function(cIdx,cell){\r\n                // DESIGN: NOTE: Row cell arrays can be \"uneven\" (diff cell count in each) due to rowspan/colspan\r\n                // Therefore, for each cell we run 0->colCount to determien the correct slot for it to reside\r\n                // as the uneven/mixed nature of the data means we cannot use the cIdx value alone.\r\n                // E.g.: the 2nd element in the row array may actually go into the 5th table grid row cell b/c of colspans!\r\n                for (var idx=0; (cIdx+idx)<intColCnt; idx++) {\r\n                  var currColIdx = (cIdx + idx);\r\n\r\n                  if ( !objTableGrid[rIdx][currColIdx] ) {\r\n                    // A: Set this cell\r\n                    objTableGrid[rIdx][currColIdx] = cell;\r\n\r\n                    // B: Handle `colspan` or `rowspan` (a {cell} cant have both! FIXME: FUTURE: ROWSPAN & COLSPAN in same cell)\r\n                    if ( cell && cell.opts && cell.opts.colspan && !isNaN(Number(cell.opts.colspan)) ) {\r\n                      for (var idy=1; idy<Number(cell.opts.colspan); idy++) {\r\n                        objTableGrid[rIdx][currColIdx+idy] = {\"hmerge\":true, text:\"hmerge\"};\r\n                      }\r\n                    }\r\n                    else if ( cell && cell.opts && cell.opts.rowspan && !isNaN(Number(cell.opts.rowspan)) ) {\r\n                      for (var idz=1; idz<Number(cell.opts.rowspan); idz++) {\r\n                        if ( !objTableGrid[rIdx+idz] ) objTableGrid[rIdx+idz] = {};\r\n                        objTableGrid[rIdx+idz][currColIdx] = {\"vmerge\":true, text:\"vmerge\"};\r\n                      }\r\n                    }\r\n\r\n                    // C: Break out of colCnt loop now that slot has been filled\r\n                    break;\r\n                  }\r\n                }\r\n              });\r\n            });\r\n            /* Only useful for rowspan/colspan testing\r\n            if ( objTabOpts.debug ) {\r\n              console.table(objTableGrid);\r\n              var arrText = [];\r\n              $.each(objTableGrid, function(i,row){ var arrRow = []; $.each(row,function(i,cell){ arrRow.push(cell.text); }); arrText.push(arrRow); });\r\n              console.table( arrText );\r\n            }\r\n            */\r\n\r\n            // STEP 4: Build table rows/cells ============================\r\n            $.each(objTableGrid, function(rIdx,rowObj){\r\n              // A: Table Height provided without rowH? Then distribute rows\r\n              var intRowH = 0; // IMPORTANT: Default must be zero for auto-sizing to work\r\n              if ( Array.isArray(objTabOpts.rowH) && objTabOpts.rowH[rIdx] ) intRowH = inch2Emu(Number(objTabOpts.rowH[rIdx]));\r\n              else if ( objTabOpts.rowH && !isNaN(Number(objTabOpts.rowH)) ) intRowH = inch2Emu(Number(objTabOpts.rowH));\r\n              else if ( slideItemObj.options.cy || slideItemObj.options.h ) intRowH = ( slideItemObj.options.h ? inch2Emu(slideItemObj.options.h) : slideItemObj.options.cy) / arrTabRows.length;\r\n\r\n              // B: Start row\r\n              strXml += '<a:tr h=\"'+ intRowH +'\">';\r\n\r\n              // C: Loop over each CELL\r\n              $.each(rowObj, function(cIdx,cell){\r\n                // 1: \"hmerge\" cells are just place-holders in the table grid - skip those and go to next cell\r\n                if ( cell.hmerge ) return;\r\n\r\n                // 2: OPTIONS: Build/set cell options ===========================\r\n                {\r\n                  var cellOpts = cell.options || cell.opts || {};\r\n                  if ( typeof cell === 'number' || typeof cell === 'string' ) cell = { text:cell.toString() };\r\n                  cellOpts.isTableCell = true; // Used to create textBody XML\r\n                  cell.options = cellOpts;\r\n\r\n                  // B: Apply default values (tabOpts being used when cellOpts dont exist):\r\n                  // SEE: http://officeopenxml.com/drwTableCellProperties-alignment.php\r\n                  ['align','bold','border','color','fill','font_face','font_size','margin','marginPt','underline','valign']\r\n                  .forEach(function(name,idx){\r\n                    if ( objTabOpts[name] && !cellOpts[name] && cellOpts[name] != 0 ) cellOpts[name] = objTabOpts[name];\r\n                  });\r\n\r\n                  var cellValign  = (cellOpts.valign)     ? ' anchor=\"'+ cellOpts.valign.replace(/^c$/i,'ctr').replace(/^m$/i,'ctr').replace('center','ctr').replace('middle','ctr').replace('top','t').replace('btm','b').replace('bottom','b') +'\"' : '';\r\n                  var cellColspan = (cellOpts.colspan)    ? ' gridSpan=\"'+ cellOpts.colspan +'\"' : '';\r\n                  var cellRowspan = (cellOpts.rowspan)    ? ' rowSpan=\"'+ cellOpts.rowspan +'\"' : '';\r\n                  var cellFill    = ((cell.optImp && cell.optImp.fill)  || cellOpts.fill ) ? ' <a:solidFill><a:srgbClr val=\"'+ ((cell.optImp && cell.optImp.fill) || cellOpts.fill.replace('#','')) +'\"/></a:solidFill>' : '';\r\n                  var cellMargin  = ( cellOpts.margin == 0 || cellOpts.margin ? cellOpts.margin : (cellOpts.marginPt || DEF_CELL_MARGIN_PT) );\r\n                  if ( !Array.isArray(cellMargin) && typeof cellMargin === 'number' ) cellMargin = [cellMargin,cellMargin,cellMargin,cellMargin];\r\n                  cellMargin = ' marL=\"'+ cellMargin[3]*ONEPT +'\" marR=\"'+ cellMargin[1]*ONEPT +'\" marT=\"'+ cellMargin[0]*ONEPT +'\" marB=\"'+ cellMargin[2]*ONEPT +'\"';\r\n                }\r\n\r\n                // FIXME: Cell NOWRAP property (text wrap: add to a:tcPr (horzOverflow=\"overflow\" or whatev opts exist)\r\n\r\n                // 3: ROWSPAN: Add dummy cells for any active rowspan\r\n                if ( cell.vmerge ) {\r\n                  strXml += '<a:tc vMerge=\"1\"><a:tcPr/></a:tc>';\r\n                  return;\r\n                }\r\n\r\n                // 4: Set CELL content and properties ==================================\r\n                strXml += '<a:tc'+ cellColspan + cellRowspan +'>' + genXmlTextBody(cell) + '<a:tcPr'+ cellMargin + cellValign +'>';\r\n\r\n                // 5: Borders: Add any borders\r\n                if ( cellOpts.border && typeof cellOpts.border === 'string' && cellOpts.border.toLowerCase() == 'none' ) {\r\n                  strXml += '  <a:lnL w=\"0\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:noFill/></a:lnL>';\r\n                  strXml += '  <a:lnR w=\"0\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:noFill/></a:lnR>';\r\n                  strXml += '  <a:lnT w=\"0\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:noFill/></a:lnT>';\r\n                  strXml += '  <a:lnB w=\"0\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:noFill/></a:lnB>';\r\n                }\r\n                else if ( cellOpts.border && typeof cellOpts.border === 'string' ) {\r\n                  strXml += '  <a:lnL w=\"'+ ONEPT +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:srgbClr val=\"'+ cellOpts.border +'\"/></a:solidFill></a:lnL>';\r\n                  strXml += '  <a:lnR w=\"'+ ONEPT +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:srgbClr val=\"'+ cellOpts.border +'\"/></a:solidFill></a:lnR>';\r\n                  strXml += '  <a:lnT w=\"'+ ONEPT +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:srgbClr val=\"'+ cellOpts.border +'\"/></a:solidFill></a:lnT>';\r\n                  strXml += '  <a:lnB w=\"'+ ONEPT +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:srgbClr val=\"'+ cellOpts.border +'\"/></a:solidFill></a:lnB>';\r\n                }\r\n                else if ( cellOpts.border && Array.isArray(cellOpts.border) ) {\r\n                  $.each([ {idx:3,name:'lnL'}, {idx:1,name:'lnR'}, {idx:0,name:'lnT'}, {idx:2,name:'lnB'} ], function(i,obj){\r\n                    if ( cellOpts.border[obj.idx] ) {\r\n                      var strC = '<a:solidFill><a:srgbClr val=\"'+ ((cellOpts.border[obj.idx].color) ? cellOpts.border[obj.idx].color : DEF_CELL_BORDER.color) +'\"/></a:solidFill>';\r\n                      var intW = (cellOpts.border[obj.idx] && (cellOpts.border[obj.idx].pt || cellOpts.border[obj.idx].pt == 0)) ? (ONEPT * Number(cellOpts.border[obj.idx].pt)) : ONEPT;\r\n                      strXml += '<a:'+ obj.name +' w=\"'+ intW +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">'+ strC +'</a:'+ obj.name +'>';\r\n                    }\r\n                    else strXml += '<a:'+ obj.name +' w=\"0\"><a:miter lim=\"400000\" /></a:'+ obj.name +'>';\r\n                  });\r\n                }\r\n                else if ( cellOpts.border && typeof cellOpts.border === 'object' ) {\r\n                  var intW = (cellOpts.border && (cellOpts.border.pt || cellOpts.border.pt == 0) ) ? (ONEPT * Number(cellOpts.border.pt)) : ONEPT;\r\n                  var strClr = '<a:solidFill><a:srgbClr val=\"'+ ((cellOpts.border.color) ? cellOpts.border.color.replace('#','') : DEF_CELL_BORDER.color) +'\"/></a:solidFill>';\r\n                  var strAttr = '<a:prstDash val=\"';\r\n                  strAttr += ((cellOpts.border.type && cellOpts.border.type.toLowerCase().indexOf('dash') > -1) ? \"sysDash\" : \"solid\" );\r\n                  strAttr += '\"/><a:round/><a:headEnd type=\"none\" w=\"med\" len=\"med\"/><a:tailEnd type=\"none\" w=\"med\" len=\"med\"/>';\r\n                  // *** IMPORTANT! *** LRTB order matters! (Reorder a line below to watch the borders go wonky in MS-PPT-2013!!)\r\n                  strXml += '<a:lnL w=\"'+ intW +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">'+ strClr + strAttr +'</a:lnL>';\r\n                  strXml += '<a:lnR w=\"'+ intW +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">'+ strClr + strAttr +'</a:lnR>';\r\n                  strXml += '<a:lnT w=\"'+ intW +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">'+ strClr + strAttr +'</a:lnT>';\r\n                  strXml += '<a:lnB w=\"'+ intW +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">'+ strClr + strAttr +'</a:lnB>';\r\n                  // *** IMPORTANT! *** LRTB order matters!\r\n                }\r\n\r\n                // 6: Close cell Properties & Cell\r\n                strXml += cellFill;\r\n                strXml += '  </a:tcPr>';\r\n                strXml += ' </a:tc>';\r\n\r\n                // LAST: COLSPAN: Add a 'merged' col for each column being merged (SEE: http://officeopenxml.com/drwTableGrid.php)\r\n                if ( cellOpts.colspan ) {\r\n                  for (var tmp=1; tmp<Number(cellOpts.colspan); tmp++) { strXml += '<a:tc hMerge=\"1\"><a:tcPr/></a:tc>'; }\r\n                }\r\n              });\r\n\r\n              // D: Complete row\r\n              strXml += '</a:tr>';\r\n            });\r\n\r\n            // STEP 5: Complete table\r\n            strXml += '      </a:tbl>';\r\n            strXml += '    </a:graphicData>';\r\n            strXml += '  </a:graphic>';\r\n            strXml += '</p:graphicFrame>';\r\n\r\n            // STEP 6: Set table XML\r\n            strSlideXml += strXml;\r\n\r\n            // LAST: Increment counter\r\n            intTableNum++;\r\n            break;\r\n\r\n          case 'text':\r\n            // Lines can have zero cy, but text should not\r\n            if ( !slideItemObj.options.line && cy == 0 ) cy = (EMU * 0.3);\r\n\r\n            // Margin/Padding/Inset for textboxes\r\n            if ( slideItemObj.options.margin && Array.isArray(slideItemObj.options.margin) ) {\r\n              slideItemObj.options.bodyProp.lIns = (slideItemObj.options.margin[0] * ONEPT || 0);\r\n              slideItemObj.options.bodyProp.rIns = (slideItemObj.options.margin[1] * ONEPT || 0);\r\n              slideItemObj.options.bodyProp.bIns = (slideItemObj.options.margin[2] * ONEPT || 0);\r\n              slideItemObj.options.bodyProp.tIns = (slideItemObj.options.margin[3] * ONEPT || 0);\r\n            }\r\n            else if ( (slideItemObj.options.margin || slideItemObj.options.margin == 0) && Number.isInteger(slideItemObj.options.margin) ) {\r\n              slideItemObj.options.bodyProp.lIns = (slideItemObj.options.margin * ONEPT);\r\n              slideItemObj.options.bodyProp.rIns = (slideItemObj.options.margin * ONEPT);\r\n              slideItemObj.options.bodyProp.bIns = (slideItemObj.options.margin * ONEPT);\r\n              slideItemObj.options.bodyProp.tIns = (slideItemObj.options.margin * ONEPT);\r\n            }\r\n\r\n            var effectsList = '';\r\n            if ( shapeType == null ) shapeType = getShapeInfo(null);\r\n\r\n            // A: Start SHAPE =======================================================\r\n            strSlideXml += '<p:sp>';\r\n\r\n            // B: The addition of the \"txBox\" attribute is the sole determiner of if an object is a Shape or Textbox\r\n            strSlideXml += '<p:nvSpPr><p:cNvPr id=\"'+ (idx+2) +'\" name=\"Object '+ (idx+1) +'\"/>';\r\n            strSlideXml += '<p:cNvSpPr' + ((slideItemObj.options && slideItemObj.options.isTextBox) ? ' txBox=\"1\"/><p:nvPr/>' : '/><p:nvPr/>');\r\n            strSlideXml += '</p:nvSpPr>';\r\n            strSlideXml += '<p:spPr><a:xfrm' + locationAttr + '>';\r\n            strSlideXml += '<a:off x=\"'  + x  + '\" y=\"'  + y  + '\"/>';\r\n            strSlideXml += '<a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/></a:xfrm>';\r\n            strSlideXml += '<a:prstGeom prst=\"' + shapeType.name + '\"><a:avLst>'\r\n              + (slideItemObj.options.rectRadius ? '<a:gd name=\"adj\" fmla=\"val '+ Math.round(slideItemObj.options.rectRadius * EMU * 100000 / Math.min(cx, cy)) +'\" />' : '')\r\n              + '</a:avLst></a:prstGeom>';\r\n\r\n            // Option: FILL\r\n            strSlideXml += ( slideItemObj.options.fill ? genXmlColorSelection(slideItemObj.options.fill) : '<a:noFill/>' );\r\n\r\n            // Shape Type: LINE: line color\r\n            if ( slideItemObj.options.line ) {\r\n              strSlideXml += '<a:ln'+ ( slideItemObj.options.line_size ? ' w=\"'+ (slideItemObj.options.line_size*ONEPT) +'\"' : '') +'>';\r\n              strSlideXml += genXmlColorSelection( slideItemObj.options.line );\r\n              if ( slideItemObj.options.line_dash ) strSlideXml += '<a:prstDash val=\"' + slideItemObj.options.line_dash + '\"/>';\r\n              if ( slideItemObj.options.line_head ) strSlideXml += '<a:headEnd type=\"' + slideItemObj.options.line_head + '\"/>';\r\n              if ( slideItemObj.options.line_tail ) strSlideXml += '<a:tailEnd type=\"' + slideItemObj.options.line_tail + '\"/>';\r\n              strSlideXml += '</a:ln>';\r\n            }\r\n\r\n            // EFFECTS > SHADOW: REF: @see http://officeopenxml.com/drwSp-effects.php\r\n            if ( slideItemObj.options.shadow ) {\r\n              slideItemObj.options.shadow.type    = ( slideItemObj.options.shadow.type    || 'outer' );\r\n              slideItemObj.options.shadow.blur    = ( slideItemObj.options.shadow.blur    || 8 ) * ONEPT;\r\n              slideItemObj.options.shadow.offset  = ( slideItemObj.options.shadow.offset  || 4 ) * ONEPT;\r\n              slideItemObj.options.shadow.angle   = ( slideItemObj.options.shadow.angle   || 270 ) * 60000;\r\n              slideItemObj.options.shadow.color   = ( slideItemObj.options.shadow.color   || '000000' );\r\n              slideItemObj.options.shadow.opacity = ( slideItemObj.options.shadow.opacity || 0.75 ) * 100000;\r\n\r\n              strSlideXml += '<a:effectLst>';\r\n              strSlideXml += '<a:'+ slideItemObj.options.shadow.type +'Shdw sx=\"100000\" sy=\"100000\" kx=\"0\" ky=\"0\" ';\r\n              strSlideXml += ' algn=\"bl\" rotWithShape=\"0\" blurRad=\"'+ slideItemObj.options.shadow.blur +'\" ';\r\n              strSlideXml += ' dist=\"'+ slideItemObj.options.shadow.offset +'\" dir=\"'+ slideItemObj.options.shadow.angle +'\">';\r\n              strSlideXml += '<a:srgbClr val=\"'+ slideItemObj.options.shadow.color +'\">';\r\n              strSlideXml += '<a:alpha val=\"'+ slideItemObj.options.shadow.opacity +'\"/></a:srgbClr>'\r\n              strSlideXml += '</a:outerShdw>';\r\n              strSlideXml += '</a:effectLst>';\r\n            }\r\n\r\n            /* FIXME: FUTURE: Text wrapping (copied from MS-PPTX export)\r\n            // Commented out b/c i'm not even sure this works - current code produces text that wraps in shapes and textboxes, so...\r\n            if ( slideItemObj.options.textWrap ) {\r\n              strSlideXml += '<a:extLst>'\r\n                    + '<a:ext uri=\"{C572A759-6A51-4108-AA02-DFA0A04FC94B}\">'\r\n                    + '<ma14:wrappingTextBoxFlag xmlns:ma14=\"http://schemas.microsoft.com/office/mac/drawingml/2011/main\" val=\"1\" />'\r\n                    + '</a:ext>'\r\n                    + '</a:extLst>';\r\n            }\r\n            */\r\n\r\n            // B: Close Shape Properties\r\n            strSlideXml += '</p:spPr>';\r\n\r\n            // Add formatted text\r\n            strSlideXml += genXmlTextBody(slideItemObj);\r\n\r\n            // LAST: Close SHAPE =======================================================\r\n            strSlideXml += '</p:sp>';\r\n            break;\r\n\r\n          case 'image':\r\n            var sizing = slideItemObj.options.sizing,\r\n              width = cx,\r\n              height = cy;\r\n\r\n            strSlideXml += '<p:pic>';\r\n            strSlideXml += '  <p:nvPicPr>'\r\n            strSlideXml += '    <p:cNvPr id=\"'+ (idx + 2) +'\" name=\"Object '+ (idx + 1) +'\" descr=\"'+ slideItemObj.image +'\">';\r\n            if ( slideItemObj.hyperlink ) strSlideXml += '<a:hlinkClick r:id=\"rId'+ slideItemObj.hyperlink.rId +'\" tooltip=\"'+ (slideItemObj.hyperlink.tooltip ? decodeXmlEntities(slideItemObj.hyperlink.tooltip) : '') +'\"/>';\r\n            strSlideXml += '    </p:cNvPr>';\r\n            strSlideXml += '    <p:cNvPicPr><a:picLocks noChangeAspect=\"1\"/></p:cNvPicPr><p:nvPr/>';\r\n            strSlideXml += '  </p:nvPicPr>';\r\n            strSlideXml += '<p:blipFill>';\r\n            strSlideXml += '  <a:blip r:embed=\"rId' + slideItemObj.imageRid + '\" cstate=\"print\"/>';\r\n            if (sizing && sizing.type) {\r\n              var boxW = sizing.w ? getSmartParseNumber(sizing.w, 'X') : cx,\r\n                boxH = sizing.h ? getSmartParseNumber(sizing.h, 'Y') : cy,\r\n                boxX = getSmartParseNumber(sizing.x || 0, 'X'),\r\n                boxY = getSmartParseNumber(sizing.y || 0, 'Y');\r\n\r\n                strSlideXml += gObjPptxGenerators.imageSizingXml[sizing.type]({w: width, h: height}, {w: boxW, h: boxH, x: boxX, y: boxY});\r\n              width = boxW;\r\n              height = boxH;\r\n            }\r\n            else {\r\n              strSlideXml += '  <a:stretch><a:fillRect/></a:stretch>';\r\n            }\r\n            strSlideXml += '</p:blipFill>';\r\n            strSlideXml += '<p:spPr>'\r\n            strSlideXml += ' <a:xfrm' + locationAttr + '>'\r\n            strSlideXml += '  <a:off  x=\"' + x  + '\"  y=\"' + y  + '\"/>'\r\n            strSlideXml += '  <a:ext cx=\"' + width + '\" cy=\"' + height + '\"/>'\r\n            strSlideXml += ' </a:xfrm>'\r\n            strSlideXml += ' <a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom>'\r\n            strSlideXml += '</p:spPr>';\r\n            strSlideXml += '</p:pic>';\r\n            break;\r\n\r\n          case 'media':\r\n            if ( slideItemObj.mtype == 'online' ) {\r\n              strSlideXml += '<p:pic>';\r\n              strSlideXml += ' <p:nvPicPr>';\r\n              // IMPORTANT: <p:cNvPr id=\"\" value is critical - if not the same number as preiew image rId, PowerPoint throws error!\r\n              strSlideXml += ' <p:cNvPr id=\"'+ (slideItemObj.mediaRid+2) +'\" name=\"Picture'+ (idx + 1) +'\"/>';\r\n              strSlideXml += ' <p:cNvPicPr/>';\r\n              strSlideXml += ' <p:nvPr>';\r\n              strSlideXml += '  <a:videoFile r:link=\"rId'+ slideItemObj.mediaRid +'\"/>';\r\n              strSlideXml += ' </p:nvPr>';\r\n              strSlideXml += ' </p:nvPicPr>';\r\n              strSlideXml += ' <p:blipFill><a:blip r:embed=\"rId'+ (slideItemObj.mediaRid+2) +'\"/><a:stretch><a:fillRect/></a:stretch></p:blipFill>'; // NOTE: Preview image is required!\r\n              strSlideXml += ' <p:spPr>';\r\n              strSlideXml += '  <a:xfrm' + locationAttr + '>';\r\n              strSlideXml += '   <a:off x=\"'  + x  + '\" y=\"'  + y  + '\"/>';\r\n              strSlideXml += '   <a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/>';\r\n              strSlideXml += '  </a:xfrm>';\r\n              strSlideXml += '  <a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom>';\r\n              strSlideXml += ' </p:spPr>';\r\n              strSlideXml += '</p:pic>';\r\n            }\r\n            else {\r\n              strSlideXml += '<p:pic>';\r\n              strSlideXml += ' <p:nvPicPr>';\r\n              // IMPORTANT: <p:cNvPr id=\"\" value is critical - if not the same number as preiew image rId, PowerPoint throws error!\r\n              strSlideXml += ' <p:cNvPr id=\"'+ (slideItemObj.mediaRid+2) +'\" name=\"'+ slideItemObj.media.split('/').pop().split('.').shift() +'\"><a:hlinkClick r:id=\"\" action=\"ppaction://media\"/></p:cNvPr>';\r\n              strSlideXml += ' <p:cNvPicPr><a:picLocks noChangeAspect=\"1\"/></p:cNvPicPr>';\r\n              strSlideXml += ' <p:nvPr>';\r\n              strSlideXml += '  <a:videoFile r:link=\"rId'+ slideItemObj.mediaRid +'\"/>';\r\n              strSlideXml += '  <p:extLst>';\r\n              strSlideXml += '   <p:ext uri=\"{DAA4B4D4-6D71-4841-9C94-3DE7FCFB9230}\">';\r\n              strSlideXml += '    <p14:media xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" r:embed=\"rId' + (slideItemObj.mediaRid+1) + '\"/>';\r\n              strSlideXml += '   </p:ext>';\r\n              strSlideXml += '  </p:extLst>';\r\n              strSlideXml += ' </p:nvPr>';\r\n              strSlideXml += ' </p:nvPicPr>';\r\n              strSlideXml += ' <p:blipFill><a:blip r:embed=\"rId'+ (slideItemObj.mediaRid+2) +'\"/><a:stretch><a:fillRect/></a:stretch></p:blipFill>'; // NOTE: Preview image is required!\r\n              strSlideXml += ' <p:spPr>';\r\n              strSlideXml += '  <a:xfrm' + locationAttr + '>';\r\n              strSlideXml += '   <a:off x=\"'  + x  + '\" y=\"'  + y  + '\"/>';\r\n              strSlideXml += '   <a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/>';\r\n              strSlideXml += '  </a:xfrm>';\r\n              strSlideXml += '  <a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom>';\r\n              strSlideXml += ' </p:spPr>';\r\n              strSlideXml += '</p:pic>';\r\n            }\r\n            break;\r\n\r\n          case 'chart':\r\n            strSlideXml += '<p:graphicFrame>';\r\n            strSlideXml += ' <p:nvGraphicFramePr>';\r\n            strSlideXml += '   <p:cNvPr id=\"'+ (idx + 2) +'\" name=\"Chart '+ (idx + 1) +'\"/>';\r\n            strSlideXml += '   <p:cNvGraphicFramePr/>';\r\n            strSlideXml += '   <p:nvPr/>';\r\n            strSlideXml += ' </p:nvGraphicFramePr>';\r\n            strSlideXml += ' <p:xfrm>'\r\n            strSlideXml += '  <a:off  x=\"' + x  + '\"  y=\"' + y  + '\"/>'\r\n            strSlideXml += '  <a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/>'\r\n            strSlideXml += ' </p:xfrm>'\r\n            strSlideXml += ' <a:graphic xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\">';\r\n            strSlideXml += '  <a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/chart\">';\r\n            strSlideXml += '   <c:chart r:id=\"rId'+ (slideItemObj.chartRid) +'\" xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\"/>';\r\n            strSlideXml += '  </a:graphicData>';\r\n            strSlideXml += ' </a:graphic>';\r\n            strSlideXml += '</p:graphicFrame>';\r\n            break;\r\n        }\r\n      });\r\n\r\n      // STEP 5: Add slide numbers last (if any)\r\n      if ( slideObject.slideNumberObj ) {\r\n        if ( !slideObject.slideNumberObj ) slideObject.slideNumberObj = { x:0.3, y:'90%' }\r\n\r\n        strSlideXml += '<p:sp>'\r\n          + '  <p:nvSpPr>'\r\n          + '    <p:cNvPr id=\"25\" name=\"Slide Number Placeholder 24\"/>'\r\n          + '    <p:cNvSpPr><a:spLocks noGrp=\"1\" /></p:cNvSpPr>'\r\n          + '    <p:nvPr><p:ph type=\"sldNum\" sz=\"quarter\" idx=\"4294967295\"/></p:nvPr>'\r\n          + '  </p:nvSpPr>'\r\n          + '  <p:spPr>'\r\n          + '    <a:xfrm><a:off x=\"'+ getSmartParseNumber(slideObject.slideNumberObj.x, 'X') +'\" y=\"'+ getSmartParseNumber(slideObject.slideNumberObj.y, 'Y') +'\"/><a:ext cx=\"800000\" cy=\"300000\"/></a:xfrm>'\r\n          + '    <a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom>'\r\n          + '    <a:extLst><a:ext uri=\"{C572A759-6A51-4108-AA02-DFA0A04FC94B}\"><ma14:wrappingTextBoxFlag val=\"0\" xmlns:ma14=\"http://schemas.microsoft.com/office/mac/drawingml/2011/main\"/></a:ext></a:extLst>'\r\n          + '  </p:spPr>';\r\n        // ISSUE #68: \"Page number styling\"\r\n        strSlideXml += '<p:txBody>';\r\n        strSlideXml += '  <a:bodyPr/>';\r\n        strSlideXml += '  <a:lstStyle><a:lvl1pPr>';\r\n        if ( slideObject.slideNumberObj.fontFace || slideObject.slideNumberObj.fontSize || slideObject.slideNumberObj.color ) {\r\n          strSlideXml += '<a:defRPr sz=\"'+ (slideObject.slideNumberObj.fontSize || '12') +'00\">';\r\n          if ( slideObject.slideNumberObj.color ) strSlideXml += genXmlColorSelection(slideObject.slideNumberObj.color);\r\n          if ( slideObject.slideNumberObj.fontFace ) strSlideXml += '<a:latin typeface=\"'+ slideObject.slideNumberObj.fontFace +'\"/><a:cs typeface=\"'+ slideObject.slideNumberObj.fontFace +'\"/>';\r\n          strSlideXml += '</a:defRPr>';\r\n        }\r\n        strSlideXml += '</a:lvl1pPr></a:lstStyle>';\r\n\r\n        // FIXME:\r\n        // TODO: slide numbers not showing by default\r\n        //strSlideXml += '<a:p><a:pPr/><a:fld id=\"'+SLDNUMFLDID+'\" type=\"slidenum\"/></a:p>'\r\n        strSlideXml += '<a:p><a:fld id=\"'+SLDNUMFLDID+'\" type=\"slidenum\">'\r\n          + '<a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t></a:t></a:fld>'\r\n          + '<a:endParaRPr lang=\"en-US\" /></a:p>';\r\n\r\n        strSlideXml += '</p:txBody></p:sp>';\r\n      }\r\n\r\n      // STEP 6: Close spTree and finalize slide XML\r\n      strSlideXml += '</p:spTree>';\r\n      /* FIXME: Remove this in 2.0.0 (commented for 1.6.0)\r\n      strSlideXml += '<p:extLst>';\r\n      strSlideXml += ' <p:ext uri=\"{BB962C8B-B14F-4D97-AF65-F5344CB8AC3E}\">';\r\n      strSlideXml += '  <p14:creationId xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"1544976994\"/>';\r\n      strSlideXml += ' </p:ext>';\r\n      strSlideXml += '</p:extLst>';\r\n      */\r\n      strSlideXml += '</p:cSld>';\r\n\r\n      // LAST: Return\r\n      return strSlideXml;\r\n    },\r\n\r\n    /**\r\n     * Transforms slide relations to XML string.\r\n     * Extra relations that are not dynamic can be passed using the 2nd arg (e.g. theme relation in master file).\r\n     * These relations use rId series that starts with 1-increased maximum of rIds used for dynamic relations.\r\n     * @param {Object} slideObject slide object whose relations are being transformed\r\n     * @param {Object[]} defaultRels array of default relations (such objects expected: { target: <filepath>, type: <schemepath> })\r\n     * @return {String} complete XML string ready to be saved as a file\r\n     */\r\n    slideObjectRelationsToXml: function slideObjectRelationsToXml(slideObject, defaultRels) {\r\n      var lastRid = 0; // stores maximum rId used for dynamic relations\r\n      var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + CRLF;\r\n      strXml += '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">';\r\n      // Add any rels for this Slide (image/audio/video/youtube/chart)\r\n      slideObject.rels.forEach(function(rel, idx){\r\n        lastRid = Math.max(lastRid, rel.rId);\r\n        if      ( rel.type.toLowerCase().indexOf('image')  > -1 ) {\r\n          strXml += '<Relationship Id=\"rId'+ rel.rId +'\" Target=\"'+ rel.Target +'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\"/>';\r\n        }\r\n        else if ( rel.type.toLowerCase().indexOf('chart')  > -1 ) {\r\n          strXml += '<Relationship Id=\"rId'+ rel.rId +'\" Target=\"'+ rel.Target +'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart\"/>';\r\n        }\r\n        else if ( rel.type.toLowerCase().indexOf('audio')  > -1 ) {\r\n          // As media has *TWO* rel entries per item, check for first one, if found add second rel with alt style\r\n          if ( strXml.indexOf(' Target=\"'+ rel.Target +'\"') > -1 )\r\n            strXml += '<Relationship Id=\"rId'+ rel.rId +'\" Target=\"'+ rel.Target +'\" Type=\"http://schemas.microsoft.com/office/2007/relationships/media\"/>';\r\n          else\r\n            strXml += '<Relationship Id=\"rId'+ rel.rId +'\" Target=\"'+ rel.Target +'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/audio\"/>';\r\n        }\r\n        else if ( rel.type.toLowerCase().indexOf('video')  > -1 ) {\r\n          // As media has *TWO* rel entries per item, check for first one, if found add second rel with alt style\r\n          if ( strXml.indexOf(' Target=\"'+ rel.Target +'\"') > -1 )\r\n            strXml += '<Relationship Id=\"rId'+ rel.rId +'\" Target=\"'+ rel.Target +'\" Type=\"http://schemas.microsoft.com/office/2007/relationships/media\"/>';\r\n          else\r\n            strXml += '<Relationship Id=\"rId'+ rel.rId +'\" Target=\"'+ rel.Target +'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/video\"/>';\r\n        }\r\n        else if ( rel.type.toLowerCase().indexOf('online') > -1 ) {\r\n          // As media has *TWO* rel entries per item, check for first one, if found add second rel with alt style\r\n          if ( strXml.indexOf(' Target=\"'+ rel.Target +'\"') > -1 )\r\n            strXml += '<Relationship Id=\"rId'+ rel.rId +'\" Target=\"'+ rel.Target +'\" Type=\"http://schemas.microsoft.com/office/2007/relationships/image\"/>';\r\n          else\r\n            strXml += '<Relationship Id=\"rId'+ rel.rId +'\" Target=\"'+ rel.Target +'\" TargetMode=\"External\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/video\"/>';\r\n        }\r\n        else if ( rel.type.toLowerCase().indexOf('hyperlink') > -1 ) {\r\n          strXml += '<Relationship Id=\"rId'+ rel.rId +'\" Target=\"'+ rel.Target +'\" TargetMode=\"External\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\"/>';\r\n        }\r\n      });\r\n\r\n      defaultRels.forEach(function(rel, idx) {\r\n        strXml += '<Relationship Id=\"rId' + (lastRid + idx + 1) + '\" Target=\"' + rel.target + '\" Type=\"' + rel.type + '\"/>';\r\n      });\r\n\r\n      strXml += '</Relationships>';\r\n      return strXml;\r\n    },\r\n\r\n    imageSizingXml: {\r\n      cover: function(imgSize, boxDim) {\r\n        var imgRatio = imgSize.h / imgSize.w,\r\n          boxRatio = boxDim.h / boxDim.w,\r\n          isBoxBased = boxRatio > imgRatio,\r\n          width = isBoxBased ? (boxDim.h / imgRatio) : boxDim.w,\r\n          height = isBoxBased ? boxDim.h : (boxDim.w * imgRatio),\r\n          hzPerc = Math.round(1e5 * 0.5 * (1 - boxDim.w / width)),\r\n          vzPerc = Math.round(1e5 * 0.5 * (1 - boxDim.h / height));\r\n        return '<a:srcRect l=\"' + hzPerc + '\" r=\"' + hzPerc + '\" t=\"' + vzPerc + '\" b=\"' + vzPerc + '\" /><a:stretch/>';\r\n      },\r\n      contain: function(imgSize, boxDim) {\r\n        var imgRatio = imgSize.h / imgSize.w,\r\n          boxRatio = boxDim.h / boxDim.w,\r\n          widthBased = boxRatio > imgRatio;\r\n          width =  widthBased ? boxDim.w : (boxDim.h / imgRatio),\r\n          height = widthBased ? (boxDim.w * imgRatio) : boxDim.h,\r\n          hzPerc = Math.round(1e5 * 0.5 * (1 - boxDim.w / width)),\r\n          vzPerc = Math.round(1e5 * 0.5 * (1 - boxDim.h / height));\r\n        return '<a:srcRect l=\"' + hzPerc + '\" r=\"' + hzPerc + '\" t=\"' + vzPerc + '\" b=\"' + vzPerc + '\" /><a:stretch/>';\r\n\r\n      },\r\n      crop: function(imageSize, boxDim) {\r\n        var l = boxDim.x,\r\n          r = imageSize.w - (boxDim.x + boxDim.w),\r\n          t = boxDim.y,\r\n          b = imageSize.h - (boxDim.y + boxDim.h),\r\n          lPerc = Math.round(1e5 * (l / imageSize.w)),\r\n          rPerc = Math.round(1e5 * (r / imageSize.w)),\r\n          tPerc = Math.round(1e5 * (t / imageSize.h)),\r\n          bPerc = Math.round(1e5 * (b / imageSize.h));\r\n        return '<a:srcRect l=\"' + lPerc + '\" r=\"' + rPerc + '\" t=\"' + tPerc + '\" b=\"' + bPerc + '\" /><a:stretch/>';\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Based on passed data, creates Excel Worksheet that is used as a data source for a chart.\r\n     * @param {Object} chartObject chart object\r\n     * @param {ZipObject} zip zip file that the resulting XLSX should be added to\r\n     * @return {Promise} promise of generating the XLSX file\r\n     */\r\n    createExcelWorksheet: function createExcelWorksheet(chartObject, zip) {\r\n      var data = chartObject.data;\r\n      return new Promise(function(resolve, reject) {\r\n        var zipExcel = new JSZip();\r\n\r\n        zipExcel.folder(\"_rels\");\r\n        zipExcel.folder(\"docProps\");\r\n        zipExcel.folder(\"xl/_rels\");\r\n        zipExcel.folder(\"xl/tables\");\r\n        zipExcel.folder(\"xl/theme\");\r\n        zipExcel.folder(\"xl/worksheets\");\r\n        zipExcel.folder(\"xl/worksheets/_rels\");\r\n\r\n        {\r\n          zipExcel.file(\"[Content_Types].xml\",\r\n            '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">'\r\n            + '  <Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\"/>'\r\n            + '  <Default Extension=\"xml\" ContentType=\"application/xml\"/>'\r\n            //+ '  <Default Extension=\"jpeg\" ContentType=\"image/jpg\"/><Default Extension=\"png\" ContentType=\"image/png\"/>'\r\n            //+ '  <Default Extension=\"bmp\" ContentType=\"image/bmp\"/><Default Extension=\"gif\" ContentType=\"image/gif\"/><Default Extension=\"tif\" ContentType=\"image/tif\"/><Default Extension=\"pdf\" ContentType=\"application/pdf\"/><Default Extension=\"mov\" ContentType=\"application/movie\"/><Default Extension=\"vml\" ContentType=\"application/vnd.openxmlformats-officedocument.vmlDrawing\"/>'\r\n            //+ '  <Default Extension=\"xlsx\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"/>'\r\n            + '  <Override PartName=\"/xl/workbook.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\"/>'\r\n            + '  <Override PartName=\"/xl/worksheets/sheet1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\"/>'\r\n            + '  <Override PartName=\"/xl/theme/theme1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.theme+xml\"/>'\r\n            + '  <Override PartName=\"/xl/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\"/>'\r\n            + '  <Override PartName=\"/xl/sharedStrings.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\"/>'\r\n            + '  <Override PartName=\"/xl/tables/table1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\"/>'\r\n            + '  <Override PartName=\"/docProps/core.xml\" ContentType=\"application/vnd.openxmlformats-package.core-properties+xml\"/>'\r\n            + '  <Override PartName=\"/docProps/app.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.extended-properties+xml\"/>'\r\n            + '</Types>\\n'\r\n          );\r\n          zipExcel.file(\"_rels/.rels\", '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'\r\n            + '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\" Target=\"docProps/core.xml\"/>'\r\n            + '<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\" Target=\"docProps/app.xml\"/>'\r\n            + '<Relationship Id=\"rId3\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/>'\r\n            + '</Relationships>\\n');\r\n          zipExcel.file(\"docProps/app.xml\",\r\n            '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\" xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\">'\r\n            + '<Application>Microsoft Excel</Application>'\r\n            + '<DocSecurity>0</DocSecurity>'\r\n            + '<HeadingPairs><vt:vector size=\"2\" baseType=\"variant\"><vt:variant><vt:lpstr>Worksheets</vt:lpstr></vt:variant><vt:variant><vt:i4>1</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size=\"1\" baseType=\"lpstr\"><vt:lpstr>Sheet1</vt:lpstr></vt:vector></TitlesOfParts>'\r\n            + '</Properties>\\n'\r\n          );\r\n          zipExcel.file(\"docProps/core.xml\",\r\n            '<?xml version=\"1.0\" encoding=\"UTF-8\"?><cp:coreProperties xmlns:cp=\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:dcterms=\"http://purl.org/dc/terms/\" xmlns:dcmitype=\"http://purl.org/dc/dcmitype/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">'\r\n            + '<dc:creator>PptxGenJS</dc:creator>'\r\n            + '<cp:lastModifiedBy>Ely, Brent</cp:lastModifiedBy>'\r\n            + '<dcterms:created xsi:type=\"dcterms:W3CDTF\">'+ new Date().toISOString() +'</dcterms:created>'\r\n            + '<dcterms:modified xsi:type=\"dcterms:W3CDTF\">'+ new Date().toISOString() +'</dcterms:modified>'\r\n            + '</cp:coreProperties>\\n');\r\n          zipExcel.file(\"xl/_rels/workbook.xml.rels\",\r\n            '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'\r\n            + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'\r\n            + '<Relationship Id=\"rId3\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>'\r\n            + '<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\" Target=\"theme/theme1.xml\"/>'\r\n            + '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Target=\"worksheets/sheet1.xml\"/>'\r\n            + '<Relationship Id=\"rId4\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\" Target=\"sharedStrings.xml\"/>'\r\n            + '</Relationships>\\n'\r\n          );\r\n          zipExcel.file(\"xl/styles.xml\",\r\n            '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\"><numFmts count=\"1\"><numFmt numFmtId=\"0\" formatCode=\"General\"/></numFmts><fonts count=\"4\"><font><sz val=\"9\"/><color indexed=\"8\"/><name val=\"Geneva\"/></font><font><sz val=\"9\"/><color indexed=\"8\"/><name val=\"Geneva\"/></font><font><sz val=\"10\"/><color indexed=\"8\"/><name val=\"Geneva\"/></font><font><sz val=\"18\"/><color indexed=\"8\"/>'\r\n            + '<name val=\"Arial\"/></font></fonts><fills count=\"2\"><fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill></fills><borders count=\"1\"><border><left/><right/><top/><bottom/><diagonal/></border></borders><dxfs count=\"0\"/><tableStyles count=\"0\"/><colors><indexedColors><rgbColor rgb=\"ff000000\"/><rgbColor rgb=\"ffffffff\"/><rgbColor rgb=\"ffff0000\"/><rgbColor rgb=\"ff00ff00\"/><rgbColor rgb=\"ff0000ff\"/>'\r\n            + '<rgbColor rgb=\"ffffff00\"/><rgbColor rgb=\"ffff00ff\"/><rgbColor rgb=\"ff00ffff\"/><rgbColor rgb=\"ff000000\"/><rgbColor rgb=\"ffffffff\"/><rgbColor rgb=\"ff878787\"/><rgbColor rgb=\"fff9f9f9\"/></indexedColors></colors></styleSheet>\\n'\r\n          );\r\n          zipExcel.file(\"xl/theme/theme1.xml\",\r\n            '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" name=\"Office Theme\"><a:themeElements><a:clrScheme name=\"Office Theme\"><a:dk1><a:srgbClr val=\"000000\"/></a:dk1><a:lt1><a:srgbClr val=\"FFFFFF\"/></a:lt1><a:dk2><a:srgbClr val=\"A7A7A7\"/></a:dk2><a:lt2><a:srgbClr val=\"535353\"/></a:lt2><a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1><a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2><a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3><a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4><a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5><a:accent6><a:srgbClr val=\"F79646\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"FF00FF\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office Theme\"><a:majorFont><a:latin typeface=\"Helvetica\"/><a:ea typeface=\"Helvetica\"/><a:cs typeface=\"Helvetica\"/></a:majorFont><a:minorFont><a:latin typeface=\"Arial\"/><a:ea typeface=\"Arial\"/><a:cs typeface=\"Arial\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\"Office Theme\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"1\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"100000\"/><a:shade val=\"100000\"/><a:satMod val=\"129999\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:shade val=\"100000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"104999\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw sx=\"100000\" sy=\"100000\" kx=\"0\" ky=\"0\" algn=\"b\" rotWithShape=\"0\" blurRad=\"38100\" dist=\"23000\" dir=\"5400000\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw sx=\"100000\" sy=\"100000\" kx=\"0\" ky=\"0\" algn=\"b\" rotWithShape=\"0\" blurRad=\"38100\" dist=\"23000\" dir=\"5400000\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw sx=\"100000\" sy=\"100000\" kx=\"0\" ky=\"0\" algn=\"b\" rotWithShape=\"0\" blurRad=\"38100\" dist=\"20000\" dir=\"5400000\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults><a:spDef><a:spPr><a:solidFill><a:srgbClr val=\"FFFFFF\"/></a:solidFill><a:ln w=\"25400\" cap=\"flat\"><a:solidFill><a:schemeClr val=\"accent1\"/></a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln><a:effectLst><a:outerShdw sx=\"100000\" sy=\"100000\" kx=\"0\" ky=\"0\" algn=\"b\" rotWithShape=\"0\" blurRad=\"38100\" dist=\"23000\" dir=\"5400000\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:sp3d/></a:spPr><a:bodyPr rot=\"0\" spcFirstLastPara=\"1\" vertOverflow=\"overflow\" horzOverflow=\"overflow\" vert=\"horz\" wrap=\"square\" lIns=\"45719\" tIns=\"45719\" rIns=\"45719\" bIns=\"45719\" numCol=\"1\" spcCol=\"38100\" rtlCol=\"0\" anchor=\"ctr\" upright=\"0\"><a:spAutoFit/></a:bodyPr><a:lstStyle><a:defPPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"0\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/><a:sym typeface=\"Arial\"/></a:defRPr></a:defPPr><a:lvl1pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl1pPr><a:lvl2pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl2pPr><a:lvl3pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl3pPr><a:lvl4pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl4pPr><a:lvl5pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl5pPr><a:lvl6pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl6pPr><a:lvl7pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl7pPr><a:lvl8pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl8pPr><a:lvl9pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl9pPr></a:lstStyle><a:style><a:lnRef idx=\"0\"/><a:fillRef idx=\"0\"/><a:effectRef idx=\"0\"/><a:fontRef idx=\"none\"/></a:style></a:spDef><a:lnDef><a:spPr><a:noFill/><a:ln w=\"25400\" cap=\"flat\"><a:solidFill><a:schemeClr val=\"accent1\"/></a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln><a:effectLst><a:outerShdw sx=\"100000\" sy=\"100000\" kx=\"0\" ky=\"0\" algn=\"b\" rotWithShape=\"0\" blurRad=\"38100\" dist=\"20000\" dir=\"5400000\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:sp3d/></a:spPr><a:bodyPr rot=\"0\" spcFirstLastPara=\"1\" vertOverflow=\"overflow\" horzOverflow=\"overflow\" vert=\"horz\" wrap=\"square\" lIns=\"91439\" tIns=\"45719\" rIns=\"91439\" bIns=\"45719\" numCol=\"1\" spcCol=\"38100\" rtlCol=\"0\" anchor=\"t\" upright=\"0\"><a:noAutofit/></a:bodyPr><a:lstStyle><a:defPPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:defPPr><a:lvl1pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl1pPr><a:lvl2pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl2pPr><a:lvl3pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl3pPr><a:lvl4pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl4pPr><a:lvl5pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl5pPr><a:lvl6pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl6pPr><a:lvl7pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl7pPr><a:lvl8pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl8pPr><a:lvl9pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl9pPr></a:lstStyle><a:style><a:lnRef idx=\"0\"/><a:fillRef idx=\"0\"/><a:effectRef idx=\"0\"/><a:fontRef idx=\"none\"/></a:style></a:lnDef><a:txDef><a:spPr><a:noFill/><a:ln w=\"12700\" cap=\"flat\"><a:noFill/><a:miter lim=\"400000\"/></a:ln><a:effectLst/><a:sp3d/></a:spPr><a:bodyPr rot=\"0\" spcFirstLastPara=\"1\" vertOverflow=\"overflow\" horzOverflow=\"overflow\" vert=\"horz\" wrap=\"square\" lIns=\"45719\" tIns=\"45719\" rIns=\"45719\" bIns=\"45719\" numCol=\"1\" spcCol=\"38100\" rtlCol=\"0\" anchor=\"t\" upright=\"0\"><a:spAutoFit/></a:bodyPr><a:lstStyle><a:defPPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"0\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/><a:sym typeface=\"Arial\"/></a:defRPr></a:defPPr><a:lvl1pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl1pPr><a:lvl2pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl2pPr><a:lvl3pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl3pPr><a:lvl4pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl4pPr><a:lvl5pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl5pPr><a:lvl6pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl6pPr><a:lvl7pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl7pPr><a:lvl8pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl8pPr><a:lvl9pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl9pPr></a:lstStyle><a:style><a:lnRef idx=\"0\"/><a:fillRef idx=\"0\"/><a:effectRef idx=\"0\"/><a:fontRef idx=\"none\"/></a:style></a:txDef></a:objectDefaults></a:theme>\\n'\r\n          );\r\n          zipExcel.file(\"xl/workbook.xml\",\r\n            '<?xml version=\"1.0\" encoding=\"UTF-8\"?>'\r\n            + '<workbook xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x15\" xmlns:x15=\"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main\">'\r\n            + '<fileVersion appName=\"xl\" lastEdited=\"6\" lowestEdited=\"6\" rupBuild=\"14420\"/>'\r\n            + '<workbookPr defaultThemeVersion=\"153222\"/>'\r\n            + '<bookViews><workbookView xWindow=\"0\" yWindow=\"0\" windowWidth=\"15960\" windowHeight=\"18080\"/></bookViews>'\r\n            + '<sheets><sheet name=\"Sheet1\" sheetId=\"1\" r:id=\"rId1\"/></sheets>'\r\n            + '<calcPr calcId=\"0\"/><oleSize ref=\"A1\"/>'\r\n            + '</workbook>\\n'\r\n          );\r\n          zipExcel.file(\"xl/worksheets/_rels/sheet1.xml.rels\",\r\n            '<?xml version=\"1.0\" encoding=\"UTF-8\"?>'\r\n            + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'\r\n            + '  <Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table\" Target=\"../tables/table1.xml\"/>'\r\n            + '</Relationships>\\n'\r\n          );\r\n        }\r\n\r\n        // `sharedStrings.xml`\r\n        {\r\n          var strSharedStrings = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>';\r\n          strSharedStrings += '<sst xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" count=\"'+ (data[0].labels.length + data.length + 1) +'\" uniqueCount=\"'+ (data[0].labels.length + data.length +1) +'\">'\r\n\r\n          // A: Add Labels\r\n          data[0].labels.forEach(function(label,idx){ strSharedStrings += '<si><t>'+ decodeXmlEntities(label) +'</t></si>'; });\r\n\r\n          // B: Add Series\r\n          data.forEach(function(objData,idx){ strSharedStrings += '<si><t>'+ (objData.name || ' ') +'</t></si>'; });\r\n\r\n          // C: Add 'blank' for A1\r\n          strSharedStrings += '<si><t xml:space=\"preserve\"></t></si>';\r\n\r\n          strSharedStrings += '</sst>\\n';\r\n          zipExcel.file(\"xl/sharedStrings.xml\", strSharedStrings);\r\n        }\r\n\r\n        // tables/table1.xml\r\n        {\r\n          var strTableXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>';\r\n          strTableXml += '<table xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" id=\"1\" name=\"Table1\" displayName=\"Table1\" ref=\"A1:'+ LETTERS[data.length] + (data[0].labels.length+1) +'\" totalsRowShown=\"0\">';\r\n          strTableXml += '<tableColumns count=\"' + (data[0].labels.length+1) +'\">';\r\n          strTableXml += '<tableColumn id=\"1\" name=\" \"/>';\r\n          data[0].labels.forEach(function(label,idx){ strTableXml += '<tableColumn id=\"'+ (idx+2) +'\" name=\"'+ decodeXmlEntities(label) +'\"/>' });\r\n          strTableXml += '</tableColumns>';\r\n          strTableXml += '<tableStyleInfo showFirstColumn=\"0\" showLastColumn=\"0\" showRowStripes=\"1\" showColumnStripes=\"0\"/>';\r\n          strTableXml += '</table>';\r\n          zipExcel.file(\"xl/tables/table1.xml\", strTableXml);\r\n        }\r\n\r\n        // worksheets/sheet1.xml\r\n        var strSheetXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>';\r\n        strSheetXml += '<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">'\r\n        strSheetXml += '<dimension ref=\"A1:'+ LETTERS[data.length] + (data[0].labels.length+1) +'\"/>';\r\n        strSheetXml += '<sheetViews><sheetView tabSelected=\"1\" workbookViewId=\"0\"><selection activeCell=\"B1\" sqref=\"B1\"/></sheetView></sheetViews>';\r\n        strSheetXml += '<sheetFormatPr defaultRowHeight=\"15\"/>';\r\n        strSheetXml += '<cols>';\r\n        strSheetXml += '<col min=\"10\" max=\"100\" width=\"20\" customWidth=\"1\"/>';\r\n        data[0].labels.forEach(function(){ strSheetXml += '<col min=\"10\" max=\"100\" width=\"10\" customWidth=\"1\"/>' });\r\n        strSheetXml += '</cols>';\r\n        strSheetXml += '<sheetData>';\r\n\r\n        /* EX: INPUT: `data`\r\n        [\r\n          { name:'Red', labels:['Jan..May-17'], values:[11,13,14,15,16] },\r\n          { name:'Amb', labels:['Jan..May-17'], values:[22, 6, 7, 8, 9] },\r\n          { name:'Grn', labels:['Jan..May-17'], values:[33,32,42,53,63] }\r\n        ];\r\n        */\r\n        /* EX: OUTPUT: lineChart Worksheet:\r\n          -|---A---|--B--|--C--|--D--|\r\n          1|       | Red | Amb | Grn |\r\n          2|Jan-17 |   11|   22|   33|\r\n          3|Feb-17 |   55|   43|   70|\r\n          4|Mar-17 |   56|  143|   99|\r\n          5|Apr-17 |   65|    3|  120|\r\n          6|May-17 |   75|   93|  170|\r\n          -|-------|-----|-----|-----|\r\n        */\r\n\r\n        // A: Create header row first (NOTE: Start at index=1 as headers cols start with 'B')\r\n        strSheetXml += '<row r=\"1\">';\r\n        strSheetXml += '<c r=\"A1\" t=\"s\"><v>'+ (data.length + data[0].labels.length) +'</v></c>';\r\n        for (var idx=1; idx<=data[0].labels.length; idx++) {\r\n          // FIXME: Max cols is 52\r\n          strSheetXml += '<c r=\"'+ ( idx < 26 ? LETTERS[idx] : 'A'+LETTERS[idx%LETTERS.length] ) +'1\" t=\"s\">'; // NOTE: use `t=\"s\"` for label cols!\r\n          strSheetXml += '<v>'+ (idx-1) +'</v>';\r\n          strSheetXml += '</c>';\r\n        }\r\n        strSheetXml += '</row>';\r\n\r\n        // B: Add data row(s)\r\n        data.forEach(function(row,idx){\r\n          // Leading col is reserved for the label, so hard-code it, then loop over col values\r\n          strSheetXml += '<row r=\"'+ (idx+2) +'\">';\r\n          strSheetXml += '<c r=\"A'+ (idx+2) +'\" t=\"s\">';\r\n          strSheetXml += '<v>'+ (data[0].values.length + idx + 1) +'</v>';\r\n          strSheetXml += '</c>';\r\n          row.values.forEach(function(val,idy){\r\n            strSheetXml += '<c r=\"'+ ( (idy+1) < 26 ? LETTERS[(idy+1)] : 'A'+LETTERS[(idy+1)%LETTERS.length] ) +''+ (idx+2) +'\">';\r\n            strSheetXml += '<v>'+ (val || '') +'</v>';\r\n            strSheetXml += '</c>';\r\n          });\r\n          strSheetXml += '</row>';\r\n        });\r\n\r\n        strSheetXml += '</sheetData>';\r\n        strSheetXml += '<pageMargins left=\"0.7\" right=\"0.7\" top=\"0.75\" bottom=\"0.75\" header=\"0.3\" footer=\"0.3\"/>';\r\n        //strSheetXml += '<tableParts count=\"1\"><tablePart r:id=\"rId1\"/></tableParts>'; // Causes unreadable error in O365\r\n        strSheetXml += '</worksheet>\\n';\r\n        zipExcel.file(\"xl/worksheets/sheet1.xml\", strSheetXml);\r\n\r\n        // C: Add XLSX to PPTX export\r\n        zipExcel.generateAsync({type:'base64'})\r\n        .then(function(content){\r\n          // 1: Create the embedded Excel worksheet with labels and data\r\n          zip.file( \"ppt/embeddings/Microsoft_Excel_Worksheet\"+ chartObject.globalId +\".xlsx\", content, {base64:true} );\r\n\r\n          // 2: Create the chart.xml and rels files\r\n          zip.file(\"ppt/charts/_rels/\"+ chartObject.fileName +\".rels\",\r\n            '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'\r\n            + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'\r\n            + '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/package\" Target=\"../embeddings/Microsoft_Excel_Worksheet'+ chartObject.globalId +'.xlsx\"/>'\r\n            + '</Relationships>'\r\n          );\r\n          zip.file(\"ppt/charts/\"+chartObject.fileName, makeXmlCharts(chartObject));\r\n\r\n          // 3: Done\r\n          resolve();\r\n        })\r\n        .catch(function(strErr){\r\n          reject(strErr);\r\n        });\r\n      });\r\n    }\r\n  };\r\n\r\n  /* ===============================================================================================\r\n  |\r\n  #     #\r\n  #     #  ######  #       #####   ######  #####    ####\r\n  #     #  #       #       #    #  #       #    #  #\r\n  #######  #####   #       #    #  #####   #    #   ####\r\n  #     #  #       #       #####   #       #####        #\r\n  #     #  #       #       #       #       #   #   #    #\r\n  #     #  ######  ######  #       ######  #    #   ####\r\n  |\r\n  ==================================================================================================\r\n  */\r\n\r\n  /**\r\n   * DESC: Export the .pptx file\r\n   */\r\n  function doExportPresentation(outputType) {\r\n    var arrChartPromises = [];\r\n    var intSlideNum = 0, intRels = 0;\r\n\r\n    // STEP 1: Create new JSZip file\r\n    var zip = new JSZip();\r\n\r\n    // STEP 2: Add all required folders and files\r\n    zip.folder(\"_rels\");\r\n    zip.folder(\"docProps\");\r\n    zip.folder(\"ppt\").folder(\"_rels\");\r\n    zip.folder(\"ppt/charts\").folder(\"_rels\");\r\n    zip.folder(\"ppt/embeddings\");\r\n    zip.folder(\"ppt/media\");\r\n    zip.folder(\"ppt/slideLayouts\").folder(\"_rels\");\r\n    zip.folder(\"ppt/slideMasters\").folder(\"_rels\");\r\n    zip.folder(\"ppt/slides\").folder(\"_rels\");\r\n    zip.folder(\"ppt/theme\");\r\n    //\r\n    zip.file(\"[Content_Types].xml\", makeXmlContTypes());\r\n    zip.file(\"_rels/.rels\", makeXmlRootRels());\r\n    zip.file(\"docProps/app.xml\", makeXmlApp());\r\n    zip.file(\"docProps/core.xml\", makeXmlCore());\r\n    zip.file(\"ppt/_rels/presentation.xml.rels\", makeXmlPresentationRels());\r\n    //\r\n    zip.file(\"ppt/theme/theme1.xml\", makeXmlTheme());\r\n    zip.file(\"ppt/presentation.xml\", makeXmlPresentation());\r\n    zip.file(\"ppt/presProps.xml\",    makeXmlPresProps());\r\n    zip.file(\"ppt/tableStyles.xml\",  makeXmlTableStyles());\r\n    zip.file(\"ppt/viewProps.xml\",    makeXmlViewProps());\r\n\r\n    for ( var idx=1; idx<=gObjPptx.slideLayouts.length; idx++ ) {\r\n        zip.file(\"ppt/slideLayouts/slideLayout\"+ idx +\".xml\", makeXmlLayout(gObjPptx.slideLayouts[idx - 1]));\r\n        zip.file(\"ppt/slideLayouts/_rels/slideLayout\"+ idx +\".xml.rels\", makeXmlSlideLayoutRel( idx ));\r\n      }\r\n\r\n    // Create a Layout/Master/Rel/Slide file for each SLIDE\r\n    for ( var idx=0; idx<gObjPptx.slides.length; idx++ ) {\r\n      intSlideNum++;\r\n      zip.file(\"ppt/slides/slide\"+ intSlideNum +\".xml\", makeXmlSlide(gObjPptx.slides[idx]));\r\n      zip.file(\"ppt/slides/_rels/slide\"+ intSlideNum +\".xml.rels\", makeXmlSlideRel( intSlideNum ));\r\n    }\r\n\r\n    zip.file(\"ppt/slideMasters/slideMaster1.xml\", makeXmlMaster(gObjPptx.masterSlide));\r\n    zip.file(\"ppt/slideMasters/_rels/slideMaster1.xml.rels\", makeXmlMasterRel(gObjPptx.masterSlide));\r\n\r\n    // Create all Rels (images, media, chart data)\r\n    gObjPptx.slideLayouts.forEach(function(layout,idx){\r\n      createMediaFiles(layout, zip, arrChartPromises);\r\n    });\r\n    gObjPptx.slides.forEach(function(slide,idx){\r\n      createMediaFiles(slide, zip, arrChartPromises);\r\n    });\r\n    createMediaFiles(gObjPptx.masterSlide, zip, arrChartPromises);\r\n\r\n    // STEP 3: Wait for Promises (if any) then generate the PPTX file\r\n    Promise.all( arrChartPromises )\r\n    .then(function(arrResults){\r\n      var strExportName = ((gObjPptx.fileName.toLowerCase().indexOf('.ppt') > -1) ? gObjPptx.fileName : gObjPptx.fileName+gObjPptx.fileExtn);\r\n      if ( outputType && JSZIP_OUTPUT_TYPES.indexOf(outputType) >= 0) {\r\n        zip.generateAsync({ type:outputType }).then(gObjPptx.saveCallback);\r\n      }\r\n      else {\r\n        zip.generateAsync({type:'blob'}).then(function(content){ writeFileToBrowser(strExportName, content); });\r\n      }\r\n    })\r\n    .catch(function(strErr){\r\n      console.error(strErr);\r\n    });\r\n  }\r\n\r\n  function writeFileToBrowser(strExportName, content) {\r\n    // STEP 1: Create element\r\n    var a = document.createElement(\"a\");\r\n    document.body.appendChild(a);\r\n    a.style = \"display: none\";\r\n\r\n    // STEP 2: Download file to browser\r\n    // DESIGN: Use `createObjectURL()` (or MS-specific func for IE11) to D/L files in client browsers (FYI: synchronously executed)\r\n    if ( window.navigator.msSaveOrOpenBlob ) {\r\n      // REF: https://docs.microsoft.com/en-us/microsoft-edge/dev-guide/html5/file-api/blob\r\n      blobObject = new Blob([content]);\r\n      $(a).click(function(){\r\n        window.navigator.msSaveOrOpenBlob(blobObject, strExportName);\r\n      });\r\n      a.click();\r\n\r\n      // Clean-up\r\n      document.body.removeChild(a);\r\n\r\n      // LAST: Callback (if any)\r\n      if ( gObjPptx.saveCallback ) gObjPptx.saveCallback(strExportName);\r\n    }\r\n    else if ( window.URL.createObjectURL ) {\r\n      var blob = new Blob([content], {type: \"octet/stream\"});\r\n      var url = window.URL.createObjectURL(blob);\r\n      a.href = url;\r\n      a.download = strExportName;\r\n      a.click();\r\n\r\n      // Clean-up (NOTE: Add a slight delay before removing to avoid 'blob:null' error in Firefox Issue#81)\r\n      setTimeout(function(){\r\n        window.URL.revokeObjectURL(url);\r\n        document.body.removeChild(a);\r\n      }, 100);\r\n\r\n      // LAST: Callback (if any)\r\n      if ( gObjPptx.saveCallback ) gObjPptx.saveCallback(strExportName);\r\n    }\r\n\r\n    // STEP 3: Clear callback func post-save\r\n    gObjPptx.saveCallback = null;\r\n  }\r\n\r\n  /**\r\n   * DESC: Calc and return excel column name (eg: 'A2')\r\n   */\r\n  function getExcelColName(length) {\r\n    var strName = '';\r\n\r\n    if ( length <= 26 ) {\r\n      strName = LETTERS[length];\r\n    }\r\n    else {\r\n      strName += LETTERS[ Math.floor(length/LETTERS.length)-1 ];\r\n      strName += LETTERS[ (length % LETTERS.length) ];\r\n    }\r\n\r\n    return strName;\r\n  }\r\n\r\n  /**\r\n   * DESC: Convert component value to hex value\r\n   */\r\n  function componentToHex(c) {\r\n    var hex = c.toString(16);\r\n    return hex.length == 1 ? \"0\" + hex : hex;\r\n  }\r\n\r\n  /**\r\n   * DESC: Depending on the passed color string, creates either `a:schemeClr` (when scheme color) or `a:srgbClr` (when hexa representation).\r\n   * color (string): hexa representation (eg. \"FFFF00\") or a scheme color constant (eg. colors.ACCENT1)\r\n   * innerElements (optional string): Additional elements that adjust the color and are enclosed by the color element.\r\n   */\r\n  function createColorElement(colorStr, innerElements) {\r\n    var isHexaRgb = REGEX_HEX_COLOR.test(colorStr);\r\n    if ( !isHexaRgb && SCHEME_COLOR_NAMES.indexOf(colorStr) === -1 ) {\r\n      console.warn('\"' + colorStr + '\" is not a valid scheme color or hexa RGB! \"'+DEF_FONT_COLOR+'\" is used as a fallback. Pass 6-digit RGB or these `pptx.colors` values:\\n' + SCHEME_COLOR_NAMES.join(', '));\r\n      colorStr = DEF_FONT_COLOR;\r\n    }\r\n    var tagName = isHexaRgb ? 'srgbClr' : 'schemeClr';\r\n    var colorAttr = ' val=\"'+ colorStr +'\"';\r\n    return innerElements ? '<a:'+ tagName + colorAttr +'>'+ innerElements +'</a:'+ tagName +'>' : '<a:'+ tagName + colorAttr +' />';\r\n  }\r\n\r\n  /**\r\n   * DESC: Used by `addSlidesForTable()` to convert RGB colors from jQuery selectors to Hex for Presentation colors\r\n   */\r\n  function rgbToHex(r, g, b) {\r\n    if (! Number.isInteger(r)) { try { console.warn('Integer expected!'); } catch(ex){} }\r\n    return (componentToHex(r) + componentToHex(g) + componentToHex(b)).toUpperCase();\r\n  }\r\n\r\n  function inch2Emu(inches) {\r\n    // FIRST: Provide Caller Safety: Numbers may get conv<->conv during flight, so be kind and do some simple checks to ensure inches were passed\r\n    // Any value over 100 damn sure isnt inches, must be EMU already, so just return it\r\n    if (inches > 100) return inches;\r\n    if ( typeof inches == 'string' ) inches = Number( inches.replace(/in*/gi,'') );\r\n    return Math.round(EMU * inches);\r\n  }\r\n\r\n  function getSizeFromImage(inImgUrl) {\r\n    // A: Create\r\n    var image = new Image();\r\n\r\n    // B: Set onload event\r\n    image.onload = function(){\r\n      // FIRST: Check for any errors: This is the best method (try/catch wont work, etc.)\r\n      if (this.width + this.height == 0) { return { width:0, height:0 }; }\r\n      var obj = { width:this.width, height:this.height };\r\n      return obj;\r\n    };\r\n    image.onerror = function(){\r\n      try { console.error( '[Error] Unable to load image: ' + inImgUrl ); } catch(ex){}\r\n    };\r\n\r\n    // C: Load image\r\n    image.src = inImgUrl;\r\n  }\r\n\r\n  function convertImgToDataURLviaCanvas(slideRel) {\r\n    // A: Create\r\n    var image = new Image();\r\n\r\n    // B: Set onload event\r\n    image.onload = function(){\r\n      // First: Check for any errors: This is the best method (try/catch wont work, etc.)\r\n      if (this.width + this.height == 0) { this.onerror(); return; }\r\n      var canvas = document.createElement('CANVAS');\r\n      var ctx = canvas.getContext('2d');\r\n      canvas.height = this.height;\r\n      canvas.width  = this.width;\r\n      ctx.drawImage(this, 0, 0);\r\n      // Users running on local machine will get the following error:\r\n      // \"SecurityError: Failed to execute 'toDataURL' on 'HTMLCanvasElement': Tainted canvases may not be exported.\"\r\n      // when the canvas.toDataURL call executes below.\r\n      try { callbackImgToDataURLDone( canvas.toDataURL(slideRel.type), slideRel ); }\r\n      catch(ex) {\r\n        this.onerror();\r\n        return;\r\n      }\r\n      canvas = null;\r\n    };\r\n    image.onerror = function(){\r\n      try {\r\n        if ( typeof window !== 'undefined' && window.location.href.indexOf('file:') == 0 ) {\r\n          console.warn(\"WARNING: You are running this in a local web browser, which means you cant read local files!\\n(use '--allow-file-access-from-files' flag with Chrome, etc.)\");\r\n        }\r\n        console.error('Unable to load image: \"'+ slideRel.path +'\"\\nPlease check the image URL:\\n'+ ( slideRel.path.indexOf('/') == 0 ? slideRel.path : window.location.href.substring(0,window.location.href.lastIndexOf('/')+1) + slideRel.path ) );\r\n      } catch(ex){}\r\n      // Return a predefined \"Broken image\" graphic so the user will see something on the slide\r\n      callbackImgToDataURLDone(IMG_BROKEN, slideRel);\r\n    };\r\n\r\n    // C: Load image\r\n    image.src = slideRel.path;\r\n  }\r\n\r\n  function callbackImgToDataURLDone(inStr, slideRel) {\r\n    var intEmpty = 0;\r\n    var clbk = function(rel, i){\r\n      if ( rel.path == slideRel.path ) rel.data = inStr;\r\n      if ( !rel.data ) intEmpty++;\r\n    }\r\n\r\n    // STEP 1: Set data for this rel, count outstanding\r\n    gObjPptx.slides.forEach(function(slide,i) {\r\n      slide.rels.forEach(clbk);\r\n    });\r\n    gObjPptx.slideLayouts.forEach(function(layout,i) {\r\n      layout.rels.forEach(clbk);\r\n    });\r\n    gObjPptx.masterSlide.rels.forEach(clbk);\r\n\r\n    // STEP 2: Continue export process if all rels have base64 `data` now\r\n    if ( intEmpty == 0 ) doExportPresentation();\r\n  }\r\n\r\n  function getShapeInfo(shapeName) {\r\n    if ( !shapeName ) return gObjPptxShapes.RECTANGLE;\r\n\r\n    if ( typeof shapeName == 'object' && shapeName.name && shapeName.displayName && shapeName.avLst ) return shapeName;\r\n\r\n    if ( gObjPptxShapes[shapeName] ) return gObjPptxShapes[shapeName];\r\n\r\n    var objShape = gObjPptxShapes.filter(function(obj){ return obj.name == shapeName || obj.displayName; })[0];\r\n    if ( typeof objShape !== 'undefined' && objShape != null ) return objShape;\r\n\r\n    return gObjPptxShapes.RECTANGLE;\r\n  }\r\n\r\n  function getSmartParseNumber(inVal, inDir) {\r\n    // FIRST: Convert string numeric value if reqd\r\n    if ( typeof inVal == 'string' && !isNaN(Number(inVal)) ) inVal = Number(inVal);\r\n\r\n    // CASE 1: Number in inches\r\n    // Figure any number less than 100 is inches\r\n    if ( typeof inVal == 'number' && inVal < 100 ) return inch2Emu(inVal);\r\n\r\n    // CASE 2: Number is already converted to something other than inches\r\n    // Figure any number greater than 100 is not inches! :)  Just return it (its EMU already i guess??)\r\n    if ( typeof inVal == 'number' && inVal >= 100 ) return inVal;\r\n\r\n    // CASE 3: Percentage (ex: '50%')\r\n    if ( typeof inVal == 'string' && inVal.indexOf('%') > -1 ) {\r\n      if ( inDir && inDir == 'X') return Math.round( (parseInt(inVal,10) / 100) * gObjPptx.pptLayout.width  );\r\n      if ( inDir && inDir == 'Y') return Math.round( (parseInt(inVal,10) / 100) * gObjPptx.pptLayout.height );\r\n      // Default: Assume width (x/cx)\r\n      return Math.round( (parseInt(inVal,10) / 100) * gObjPptx.pptLayout.width );\r\n    }\r\n\r\n    // LAST: Default value\r\n    return 0;\r\n  }\r\n\r\n  /**\r\n   * DESC: Replace special XML characters with HTML-encoded strings\r\n   */\r\n  function decodeXmlEntities(inStr) {\r\n    // NOTE: Dont use short-circuit eval here as value c/b \"0\" (zero) etc.!\r\n    if ( typeof inStr === 'undefined' || inStr == null ) return \"\";\r\n    return inStr.toString().replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\"/g,'&quot;').replace(/\\'/g,'&apos;');\r\n  }\r\n\r\n  function createHyperlinkRels(inText, slideRels) {\r\n    var arrTextObjects = [];\r\n\r\n    // Only text objects can have hyperlinks, so return if this is plain text/number\r\n    if ( typeof inText === 'string' || typeof inText === 'number' ) return;\r\n    // IMPORTANT: Check for isArray before typeof=object, or we'll exhaust recursion!\r\n    else if ( Array.isArray(inText) ) arrTextObjects = inText;\r\n    else if ( typeof inText === 'object' ) arrTextObjects = [inText];\r\n\r\n    arrTextObjects.forEach(function(text,idx){\r\n      // `text` can be an array of other `text` objects (table cell word-level formatting), so use recursion\r\n      if ( Array.isArray(text) ) createHyperlinkRels(text, slideRels);\r\n      else if ( text && typeof text === 'object' && text.options && text.options.hyperlink && !text.options.hyperlink.rId ) {\r\n        if ( typeof text.options.hyperlink !== 'object' ) console.log(\"ERROR: text `hyperlink` option should be an object. Ex: `hyperlink: {url:'https://github.com'}` \");\r\n        else if ( !text.options.hyperlink.url || typeof text.options.hyperlink.url !== 'string' ) console.log(\"ERROR: 'hyperlink.url is required and/or should be a string'\");\r\n        else {\r\n          var intRels = 1;\r\n          gObjPptx.slides.forEach(function(slide,idx){ intRels += slide.rels.length; });\r\n          var intRelId = intRels+1;\r\n\r\n          slideRels.push({\r\n            type: 'hyperlink',\r\n            data: 'dummy',\r\n            rId:  intRelId,\r\n            Target: text.options.hyperlink.url\r\n          });\r\n\r\n          text.options.hyperlink.rId = intRelId;\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n  * Magic happens here\r\n  */\r\n  function parseTextToLines(cell, inWidth) {\r\n    var CHAR = 2.2 + (cell.opts && cell.opts.lineWeight ? cell.opts.lineWeight : 0); // Character Constant (An approximation of the Golden Ratio)\r\n    var CPL = (inWidth*EMU / ( (cell.opts.font_size || DEF_FONT_SIZE)/CHAR )); // Chars-Per-Line\r\n    var arrLines = [];\r\n    var strCurrLine = '';\r\n\r\n    // Allow a single space/whitespace as cell text\r\n    if ( cell.text && cell.text.trim() == '' ) return [' '];\r\n\r\n    // A: Remove leading/trailing space\r\n    var inStr = (cell.text || '').toString().trim();\r\n\r\n    // B: Build line array\r\n    $.each(inStr.split('\\n'), function(i,line){\r\n      $.each(line.split(' '), function(i,word){\r\n        if ( strCurrLine.length + word.length + 1 < CPL ) {\r\n          strCurrLine += (word + \" \");\r\n        }\r\n        else {\r\n          if ( strCurrLine ) arrLines.push( strCurrLine );\r\n          strCurrLine = (word + \" \");\r\n        }\r\n      });\r\n      // All words for this line have been exhausted, flush buffer to new line, clear line var\r\n      if ( strCurrLine ) arrLines.push( $.trim(strCurrLine) + CRLF );\r\n      strCurrLine = '';\r\n    });\r\n\r\n    // C: Remove trailing linebreak\r\n    arrLines[(arrLines.length-1)] = $.trim(arrLines[(arrLines.length-1)]);\r\n\r\n    // D: Return lines\r\n    return arrLines;\r\n  }\r\n\r\n  /**\r\n  * Magic happens here\r\n  */\r\n  function getSlidesForTableRows(inArrRows, opts) {\r\n    var LINEH_MODIFIER = 1.9;\r\n    var opts = opts || {};\r\n    var arrInchMargins = DEF_SLIDE_MARGIN_IN; // (0.5\" on all sides)\r\n    var arrObjTabHeadRows = [], arrObjTabBodyRows = [], arrObjTabFootRows = [];\r\n    var arrObjSlides = [], arrRows = [], currRow = [];\r\n    var intTabW = 0, emuTabCurrH = 0;\r\n    var emuSlideTabW = EMU*1, emuSlideTabH = EMU*1;\r\n    var arrObjTabHeadRows = opts.arrObjTabHeadRows || '';\r\n    var numCols = 0;\r\n\r\n    if (opts.debug) console.log('------------------------------------');\r\n    if (opts.debug) console.log('opts.w ............. = '+ (opts.w||'').toString());\r\n    if (opts.debug) console.log('opts.colW .......... = '+ (opts.colW||'').toString());\r\n    if (opts.debug) console.log('opts.slideMargin ... = '+ (opts.slideMargin||'').toString());\r\n\r\n    // NOTE: Use default size as zero cell margin is causing our tables to be too large and touch bottom of slide!\r\n    if ( !opts.slideMargin && opts.slideMargin != 0 ) opts.slideMargin = DEF_SLIDE_MARGIN_IN[0];\r\n\r\n    // STEP 1: Calc margins/usable space\r\n    if ( opts.slideMargin || opts.slideMargin == 0 ) {\r\n      if ( Array.isArray(opts.slideMargin) ) arrInchMargins = opts.slideMargin;\r\n      else if ( !isNaN(opts.slideMargin) ) arrInchMargins = [opts.slideMargin, opts.slideMargin, opts.slideMargin, opts.slideMargin];\r\n    }\r\n    else if ( opts && opts.master && opts.master.margin ) {\r\n      if ( Array.isArray(opts.master.margin) ) arrInchMargins = opts.master.margin;\r\n      else if ( !isNaN(opts.master.margin) ) arrInchMargins = [opts.master.margin, opts.master.margin, opts.master.margin, opts.master.margin];\r\n    }\r\n\r\n    // STEP 2: Calc number of columns\r\n    // NOTE: Cells may have a colspan, so merely taking the length of the [0] (or any other) row is not\r\n    // ....: sufficient to determine column count. Therefore, check each cell for a colspan and total cols as reqd\r\n    inArrRows[0].forEach(function(cell,idx){\r\n      if (!cell) cell = {};\r\n      var cellOpts = cell.options || cell.opts || null; // DEPRECATED (`opts`)\r\n      numCols += ( cellOpts && cellOpts.colspan ? cellOpts.colspan : 1 );\r\n    });\r\n\r\n    if (opts.debug) console.log('arrInchMargins ..... = '+ arrInchMargins.toString());\r\n    if (opts.debug) console.log('numCols ............ = '+ numCols );\r\n\r\n    // Calc opts.w if we can\r\n    if ( !opts.w && opts.colW ) {\r\n      if ( Array.isArray(opts.colW) ) opts.colW.forEach(function(val,idx){ opts.w += val });\r\n      else { opts.w = opts.colW * numCols }\r\n    }\r\n\r\n    // STEP 2: Calc usable space/table size now that we have usable space calc'd\r\n    emuSlideTabW = ( opts.w ? inch2Emu(opts.w) : (gObjPptx.pptLayout.width - inch2Emu((opts.x || arrInchMargins[1]) + arrInchMargins[3])) );\r\n    if (opts.debug) console.log('emuSlideTabW (in) ........ = '+ (emuSlideTabW/EMU).toFixed(1) );\r\n    if (opts.debug) console.log('gObjPptx.pptLayout.h ..... = '+ (gObjPptx.pptLayout.height/EMU));\r\n\r\n    // STEP 3: Calc column widths if needed so we can subsequently calc lines (we need `emuSlideTabW`!)\r\n    if ( !opts.colW || !Array.isArray(opts.colW) ) {\r\n      if ( opts.colW && !isNaN(Number(opts.colW)) ) {\r\n        var arrColW = [];\r\n        inArrRows[0].forEach(function(cell,idx){ arrColW.push( opts.colW ) });\r\n        opts.colW = [];\r\n        arrColW.forEach(function(val,idx){ opts.colW.push(val) });\r\n      }\r\n      // No column widths provided? Then distribute cols.\r\n      else {\r\n        opts.colW = [];\r\n        for (var iCol=0; iCol<numCols; iCol++) { opts.colW.push( (emuSlideTabW/EMU/numCols) ); }\r\n      }\r\n    }\r\n\r\n    // STEP 4: Iterate over each line and perform magic =========================\r\n    // NOTE: inArrRows will be an array of {text:'', opts{}} whether from `addSlidesForTable()` or `.addTable()`\r\n    inArrRows.forEach(function(row,iRow){\r\n      // A: Reset ROW variables\r\n      var arrCellsLines = [], arrCellsLineHeights = [], emuRowH = 0, intMaxLineCnt = 0, intMaxColIdx = 0;\r\n\r\n      // B: Calc usable vertical space/table height\r\n      // NOTE: Use margins after the first Slide (dont re-use opt.y - it could've been halfway down the page!) (ISSUE#43,ISSUE#47,ISSUE#48)\r\n      if ( arrObjSlides.length > 0 ) {\r\n        emuSlideTabH = ( gObjPptx.pptLayout.height - inch2Emu( (opts.y/EMU < arrInchMargins[0] ? opts.y/EMU : arrInchMargins[0]) + arrInchMargins[2]) );\r\n        // Use whichever is greater: area between margins or the table H provided (dont shrink usable area - the whole point of over-riding X on paging is to *increarse* usable space)\r\n        if ( emuSlideTabH < opts.h ) emuSlideTabH = opts.h;\r\n      }\r\n      else emuSlideTabH = ( opts.h ? opts.h : (gObjPptx.pptLayout.height - inch2Emu((opts.y/EMU || arrInchMargins[0]) + arrInchMargins[2])) );\r\n      if (opts.debug) console.log('* Slide '+arrObjSlides.length+': emuSlideTabH (in) ........ = '+ (emuSlideTabH/EMU).toFixed(1));\r\n\r\n      // C: Parse and store each cell's text into line array (**MAGIC HAPPENS HERE**)\r\n      row.forEach(function(cell,iCell){\r\n        // FIRST: REALITY-CHECK:\r\n        if (!cell) cell = {};\r\n\r\n        // DESIGN: Cells are henceforth {objects} with `text` and `opts`\r\n        var lines = [];\r\n\r\n        // 1: Cleanse data\r\n        if ( !isNaN(cell) || typeof cell === 'string' ) {\r\n          // Grab table formatting `opts` to use here so text style/format inherits as it should\r\n          cell = { text:cell.toString(), opts:opts };\r\n        }\r\n        else if ( typeof cell === 'object' ) {\r\n          // ARG0: `text`\r\n          if ( typeof cell.text === 'number' ) cell.text = cell.text.toString();\r\n          else if ( typeof cell.text === 'undefined' || cell.text == null ) cell.text = \"\";\r\n\r\n          // ARG1: `options`\r\n          var opt = cell.options || cell.opts || {}; // Legacy support for `opts` (<= v1.2.0)\r\n          cell.opts = opt; // This odd soln is needed until `opts` can be safely discarded (DEPRECATED)\r\n        }\r\n        // Capture some table options for use in other functions\r\n        cell.opts.lineWeight = opts.lineWeight;\r\n\r\n        // 2: Create a cell object for each table column\r\n        currRow.push({ text:'', opts:cell.opts });\r\n\r\n        // 3: Parse cell contents into lines (**MAGIC HAPPENSS HERE**)\r\n        var lines = parseTextToLines(cell, (opts.colW[iCell]/ONEPT));\r\n        arrCellsLines.push( lines );\r\n        //if (opts.debug) console.log('Cell:'+iCell+' - lines:'+lines.length);\r\n\r\n        // 4: Keep track of max line count within all row cells\r\n        if ( lines.length > intMaxLineCnt ) { intMaxLineCnt = lines.length; intMaxColIdx = iCell; }\r\n        var lineHeight = inch2Emu((cell.opts.font_size || opts.font_size || DEF_FONT_SIZE) * LINEH_MODIFIER / 100);\r\n        // NOTE: Exempt cells with `rowspan` from increasing lineHeight (or we could create a new slide when unecessary!)\r\n        if ( cell.opts && cell.opts.rowspan ) lineHeight = 0;\r\n\r\n        // 5: Add cell margins to lineHeight (if any)\r\n        if ( cell.opts.margin ) {\r\n          if ( cell.opts.margin[0] ) lineHeight += (cell.opts.margin[0]*ONEPT) / intMaxLineCnt;\r\n          if ( cell.opts.margin[2] ) lineHeight += (cell.opts.margin[2]*ONEPT) / intMaxLineCnt;\r\n        }\r\n\r\n        // Add to array\r\n        arrCellsLineHeights.push( Math.round(lineHeight) );\r\n      });\r\n\r\n      // D: AUTO-PAGING: Add text one-line-a-time to this row's cells until: lines are exhausted OR table H limit is hit\r\n      for (var idx=0; idx<intMaxLineCnt; idx++) {\r\n        // 1: Add the current line to cell\r\n        for (var col=0; col<arrCellsLines.length; col++) {\r\n          // A: Commit this slide to Presenation if table Height limit is hit\r\n          if ( emuTabCurrH + arrCellsLineHeights[intMaxColIdx] > emuSlideTabH ) {\r\n            if (opts.debug) console.log('--------------- New Slide Created ---------------');\r\n            if (opts.debug) console.log(' (calc) '+ (emuTabCurrH/EMU).toFixed(1) +'+'+ (arrCellsLineHeights[intMaxColIdx]/EMU).toFixed(1) +' > '+ emuSlideTabH/EMU.toFixed(1));\r\n            if (opts.debug) console.log('--------------- New Slide Created ---------------');\r\n            // 1: Add the current row to table\r\n            // NOTE: Edge cases can occur where we create a new slide only to have no more lines\r\n            // ....: and then a blank row sits at the bottom of a table!\r\n            // ....: Hence, we verify all cells have text before adding this final row.\r\n            $.each(currRow, function(i,cell){\r\n              if (cell.text.length > 0 ) {\r\n                // IMPORTANT: use jQuery extend (deep copy) or cell will mutate!!\r\n                arrRows.push( $.extend(true, [], currRow) );\r\n                return false; // break out of .each loop\r\n              }\r\n            });\r\n            // 2: Add new Slide with current array of table rows\r\n            arrObjSlides.push( $.extend(true, [], arrRows) );\r\n            // 3: Empty rows for new Slide\r\n            arrRows.length = 0;\r\n            // 4: Reset current table height for new Slide\r\n            emuTabCurrH = 0; // This row's emuRowH w/b added below\r\n            // 5: Empty current row's text (continue adding lines where we left off below)\r\n            $.each(currRow,function(i,cell){ cell.text = ''; });\r\n            // 6: Auto-Paging Options: addHeaderToEach\r\n            if ( opts.addHeaderToEach && arrObjTabHeadRows ) {\r\n              var headRow = [];\r\n              $.each(arrObjTabHeadRows[0], function(iCell,cell){\r\n                headRow.push({ text:cell.text, opts:cell.opts });\r\n                var lines = parseTextToLines(cell,(opts.colW[iCell]/ONEPT));\r\n                if ( lines.length > intMaxLineCnt ) { intMaxLineCnt = lines.length; intMaxColIdx = iCell; }\r\n              });\r\n              arrRows.push( $.extend(true, [], headRow) );\r\n            }\r\n          }\r\n\r\n          // B: Add next line of text to this cell\r\n          if ( arrCellsLines[col][idx] ) currRow[col].text += arrCellsLines[col][idx];\r\n        }\r\n\r\n        // 2: Add this new rows H to overall (use cell with the most lines as the determiner for overall row Height)\r\n        emuTabCurrH += arrCellsLineHeights[intMaxColIdx];\r\n      }\r\n\r\n      if (opts.debug) console.log('-> '+iRow+ ' row done!');\r\n      if (opts.debug) console.log('-> emuTabCurrH (in) . = '+ (emuTabCurrH/EMU).toFixed(1));\r\n\r\n      // E: Flush row buffer - Add the current row to table, then truncate row cell array\r\n      // IMPORTANT: use jQuery extend (deep copy) or cell will mutate!!\r\n      if (currRow.length) arrRows.push( $.extend(true,[],currRow) );\r\n      currRow.length = 0;\r\n    });\r\n\r\n    // STEP 4-2: Flush final row buffer to slide\r\n    arrObjSlides.push( $.extend(true,[],arrRows) );\r\n\r\n    // LAST:\r\n    if (opts.debug) { console.log('arrObjSlides count = '+arrObjSlides.length); console.log(arrObjSlides); }\r\n    return arrObjSlides;\r\n  }\r\n\r\n  /**\r\n   * NOTE: Used by both: text and lineChart\r\n   * Creates `a:innerShdw` or `a:outerShdw` depending on pass options `opts`.\r\n   * @param {Object} opts optional shadow properties\r\n   * @param {Object} defaults defaults for unspecified properties in `opts`\r\n   * @see http://officeopenxml.com/drwSp-effects.php\r\n   *  { type: 'outer', blur: 3, offset: (23000 / 12700), angle: 90, color: '000000', opacity: 0.35, rotateWithShape: true };\r\n   */\r\n  function createShadowElement(options, defaults, isShape) {\r\n    if ( options === 'none' ) {\r\n      return '<a:effectLst/>';\r\n    }\r\n    var\r\n      strXml = '<a:effectLst>',\r\n      opts   = mix(defaults, options),\r\n      type            = opts.type || 'outer',\r\n      blur            = opts.blur * ONEPT,\r\n      offset          = opts.offset * ONEPT,\r\n      angle           = opts.angle * 60000,\r\n      color           = opts.color,\r\n      opacity         = opts.opacity * 100000,\r\n      rotateWithShape = opts.rotateWithShape ?  1 : 0;\r\n\r\n    strXml += '<a:'+ type +'Shdw sx=\"100000\" sy=\"100000\" kx=\"0\" ky=\"0\"  algn=\"bl\" blurRad=\"'+ blur +'\" ';\r\n    strXml += 'rotWithShape=\"'+ (+rotateWithShape) +'\"';\r\n    strXml += ' dist=\"'+ offset +'\" dir=\"'+ angle +'\">';\r\n    strXml += '<a:srgbClr val=\"'+ color +'\">'; // TODO: should accept scheme colors implemented in Issue #135\r\n    strXml += '<a:alpha val=\"'+ opacity +'\"/></a:srgbClr>';\r\n    strXml += '</a:'+ type +'Shdw>';\r\n    strXml += '</a:effectLst>';\r\n\r\n    return strXml;\r\n  }\r\n\r\n  /**\r\n   * Checks shadow options passed by user and performs corrections if needed.\r\n   * @param {Object} shadowOpts\r\n   */\r\n  function correctShadowOptions(shadowOpts) {\r\n    if ( !shadowOpts || shadowOpts === 'none' ) return;\r\n\r\n    // OPT: `type`\r\n    if ( shadowOpts.type != 'outer' && shadowOpts.type != 'inner' ) {\r\n      console.warn('Warning: shadow.type options are `outer` or `inner`.');\r\n      shadowOpts.type = 'outer';\r\n    }\r\n\r\n    // OPT: `angle`\r\n    if ( shadowOpts.angle ) {\r\n      // A: REALITY-CHECK\r\n      if ( isNaN(Number(shadowOpts.angle)) || shadowOpts.angle < 0 || shadowOpts.angle > 359 ) {\r\n        console.warn('Warning: shadow.angle can only be 0-359');\r\n        shadowOpts.angle = 270;\r\n      }\r\n\r\n      // B: ROBUST: Cast any type of valid arg to int: '12', 12.3, etc. -> 12\r\n      shadowOpts.angle = Math.round(Number(shadowOpts.angle));\r\n    }\r\n\r\n    // OPT: `opacity`\r\n    if ( shadowOpts.opacity ) {\r\n      // A: REALITY-CHECK\r\n      if ( isNaN(Number(shadowOpts.opacity)) || shadowOpts.opacity < 0 || shadowOpts.opacity > 1 ) {\r\n        console.warn('Warning: shadow.opacity can only be 0-1');\r\n        shadowOpts.opacity = 0.75;\r\n      }\r\n\r\n      // B: ROBUST: Cast any type of valid arg to int: '12', 12.3, etc. -> 12\r\n      shadowOpts.opacity = Number(shadowOpts.opacity)\r\n    }\r\n  }\r\n\r\n  function correctGridLineOptions(glOpts) {\r\n    if ( !glOpts || glOpts === 'none' ) return;\r\n    if ( glOpts.size !== undefined && (isNaN(Number(glOpts.size)) || glOpts.size <= 0) ) {\r\n      console.warn('Warning: chart.gridLine.size must be greater than 0.');\r\n      delete glOpts.size; // delete prop to used defaults\r\n    }\r\n    if ( glOpts.style && ['solid', 'dash', 'dot'].indexOf(glOpts.style) < 0 ) {\r\n      console.warn('Warning: chart.gridLine.style options: `solid`, `dash`, `dot`.');\r\n      delete glOpts.style;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {Object} glOpts {size, color, style}\r\n   * @param {Object} defaults {size, color, style}\r\n   * @param {String} type \"major\"(default) | \"minor\"\r\n   */\r\n  function createGridLineElement(glOpts, defaults, type) {\r\n    type = type || 'major';\r\n    var tagName = 'c:'+ type + 'Gridlines';\r\n    strXml =  '<'+ tagName + '>';\r\n    strXml += ' <c:spPr>';\r\n    strXml += '  <a:ln w=\"' + Math.round((glOpts.size || defaults.size) * ONEPT) +'\" cap=\"flat\">';\r\n    strXml += '  <a:solidFill><a:srgbClr val=\"' + (glOpts.color || defaults.color) + '\"/></a:solidFill>'; // should accept scheme colors as implemented in PR 135\r\n    strXml += '   <a:prstDash val=\"' + (glOpts.style || defaults.style) + '\"/><a:round/>';\r\n    strXml += '  </a:ln>';\r\n    strXml += ' </c:spPr>';\r\n    strXml += '</'+ tagName + '>';\r\n    return strXml;\r\n  }\r\n\r\n  function encodeImageRelations(layout, arrRelsDone) {\r\n    var intRels = 0;\r\n\r\n    layout.rels.forEach(function(rel,idy){\r\n      // Read and Encode each image into base64 for use in export\r\n      if ( rel.type != 'online' && rel.type != 'chart' && !rel.data && $.inArray(rel.path, arrRelsDone) == -1 ) {\r\n        intRels++;\r\n        convertImgToDataURLviaCanvas(rel);\r\n        arrRelsDone.push(rel.path);\r\n      }\r\n    });\r\n\r\n    return intRels;\r\n  }\r\n\r\n  function createMediaFiles(layout, zip, chartPromises) {\r\n    layout.rels.forEach(function(rel, idy) {\r\n      if ( rel.type == 'chart' ) {\r\n        chartPromises.push(gObjPptxGenerators.createExcelWorksheet(rel, zip));\r\n      }\r\n      else if ( rel.type != 'online' && rel.type != 'hyperlink' ) {\r\n        // A: Loop vars\r\n        var data = rel.data;\r\n\r\n        // B: Users will undoubtedly pass various string formats, so modify as needed\r\n        if      ( data.indexOf(',') == -1 && data.indexOf(';') == -1 ) data = 'image/png;base64,' + data;\r\n        else if ( data.indexOf(',') == -1                            ) data = 'image/png;base64,' + data;\r\n        else if ( data.indexOf(';') == -1                            ) data = 'image/png;' + data;\r\n\r\n        // C: Add media\r\n        zip.file( rel.Target.replace('..','ppt'), data.split(',').pop(), {base64:true} );\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * shallow mix, returns new object\r\n   */\r\n  function mix (o1, o2, etc) {\r\n    var o = {};\r\n    for (var i = 0; i <= arguments.length; i++){\r\n      var oN = arguments[i];\r\n      if(oN){\r\n        Object.keys(oN).forEach(function (key) {\r\n          o[key] = oN[key];\r\n        });\r\n      }\r\n    }\r\n    return o;\r\n  }\r\n\r\n  /* =======================================================================================================\r\n  |\r\n  #     #  #     #  #             #####\r\n   #   #   ##   ##  #            #     #  ######  #    #  ######  #####     ##    #####  #   ####   #    #\r\n    # #    # # # #  #            #        #       ##   #  #       #    #   #  #     #    #  #    #  ##   #\r\n     #     #  #  #  #            #  ####  #####   # #  #  #####   #    #  #    #    #    #  #    #  # #  #\r\n    # #    #     #  #            #     #  #       #  # #  #       #####   ######    #    #  #    #  #  # #\r\n   #   #   #     #  #            #     #  #       #   ##  #       #   #   #    #    #    #  #    #  #   ##\r\n  #     #  #     #  #######       #####   ######  #    #  ######  #    #  #    #    #    #   ####   #    #\r\n  |\r\n  =========================================================================================================\r\n  */\r\n\r\n  /**\r\n  * @see: http://www.datypic.com/sc/ooxml/s-dml-chart.xsd.html\r\n  */\r\n  function makeXmlCharts(rel) {\r\n    // HELPER FUNCS:\r\n    function hasArea (chartType) {\r\n      function has (type) {\r\n        return chartType.some(function (item) {\r\n          return item.type.name === type;\r\n        });\r\n      }\r\n      if (Array.isArray(chartType)) {\r\n        return has('area');\r\n      }\r\n      return chartType.name === 'area';\r\n    }\r\n\r\n    /* ----------------------------------------------------------------------- */\r\n\r\n    // STEP 1: Create chart\r\n    {\r\n      var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>';\r\n      // CHARTSPACE: BEGIN vvv\r\n      strXml += '<c:chartSpace xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">';\r\n      strXml += '<c:date1904 val=\"0\"/>';  // ppt defaults to 1904 dates, excel to 1900\r\n      strXml += '<c:chart>';\r\n\r\n      // OPTION: Title\r\n      if ( rel.opts.showTitle ) {\r\n        strXml += genXmlTitle({\r\n          title: rel.opts.title || 'Chart Title',\r\n          fontSize: rel.opts.titleFontSize || DEF_FONT_TITLE_SIZE,\r\n          color: rel.opts.titleColor,\r\n          fontFace: rel.opts.titleFontFace,\r\n          rotate: rel.opts.titleRotate,\r\n          titleAlign: rel.opts.titleAlign,\r\n          titlePos: rel.opts.titlePos\r\n        });\r\n        strXml += '<c:autoTitleDeleted val=\"0\"/>';\r\n      }\r\n\r\n      strXml += '<c:plotArea>';\r\n      // IMPORTANT: Dont specify layout to enable auto-fit: PPT does a great job maximizing space with all 4 TRBL locations\r\n      if ( rel.opts.layout ) {\r\n        strXml += '<c:layout>';\r\n        strXml += ' <c:manualLayout>';\r\n        strXml += '  <c:layoutTarget val=\"inner\" />';\r\n        strXml += '  <c:xMode val=\"edge\" />';\r\n        strXml += '  <c:yMode val=\"edge\" />';\r\n        strXml += '  <c:x val=\"' + (rel.opts.layout.x || 0) + '\" />';\r\n        strXml += '  <c:y val=\"' + (rel.opts.layout.y || 0) + '\" />';\r\n        strXml += '  <c:w val=\"' + (rel.opts.layout.w || 1) + '\" />';\r\n        strXml += '  <c:h val=\"' + (rel.opts.layout.h || 1) + '\" />';\r\n        strXml += ' </c:manualLayout>';\r\n        strXml += '</c:layout>';\r\n      }\r\n      else {\r\n        strXml += '<c:layout/>';\r\n      }\r\n    }\r\n\r\n    var usesSecondaryValAxis = false;\r\n\r\n    // A: CHART TYPES -----------------------------------------------------------\r\n    if ( Array.isArray(rel.opts.type) ) {\r\n      rel.opts.type.forEach(function (type) {\r\n        var chartType = type.type.name;\r\n        var data = type.data;\r\n        var options = mix(rel.opts, type.options);\r\n        var valAxisId = options.secondaryValAxis ? AXIS_ID_VALUE_SECONDARY : AXIS_ID_VALUE_PRIMARY;\r\n        var catAxisId = options.secondaryCatAxis ? AXIS_ID_CATEGORY_SECONDARY : AXIS_ID_CATEGORY_PRIMARY;\r\n        usesSecondaryValAxis = usesSecondaryValAxis || options.secondaryValAxis;\r\n        strXml += makeChartType(chartType, data, options, valAxisId, catAxisId);\r\n      });\r\n    }\r\n    else {\r\n      var chartType = rel.opts.type.name;\r\n      strXml += makeChartType(chartType, rel.data, rel.opts, AXIS_ID_VALUE_PRIMARY, AXIS_ID_CATEGORY_PRIMARY);\r\n    }\r\n\r\n    // B: AXES -----------------------------------------------------------\r\n    if ( rel.opts.type.name !== 'pie' && rel.opts.type.name !== 'doughnut' ) {\r\n      if ( rel.opts.valAxes && !usesSecondaryValAxis ) {\r\n        throw new Error('Secondary axis must be used by one of the multiple charts');\r\n      }\r\n\r\n      if ( rel.opts.catAxes ) {\r\n        if ( !rel.opts.valAxes || rel.opts.valAxes.length !== rel.opts.catAxes.length ) {\r\n          throw new Error('There must be the same number of value and category axes.');\r\n        }\r\n        strXml += makeCatAxis(mix(rel.opts, rel.opts.catAxes[0]), AXIS_ID_CATEGORY_PRIMARY);\r\n        if ( rel.opts.catAxes[1] ) {\r\n          strXml += makeCatAxis(mix(rel.opts, rel.opts.catAxes[1]), AXIS_ID_CATEGORY_SECONDARY);\r\n        }\r\n      }\r\n      else {\r\n        strXml += makeCatAxis(rel.opts, AXIS_ID_CATEGORY_PRIMARY);\r\n      }\r\n\r\n      rel.opts.hasArea = hasArea(rel.opts.type);\r\n\r\n      if ( rel.opts.valAxes ) {\r\n        strXml += makeValueAxis(mix(rel.opts, rel.opts.valAxes[0]), AXIS_ID_VALUE_PRIMARY, AXIS_ID_CATEGORY_PRIMARY);\r\n        if ( rel.opts.valAxes[1] ) {\r\n          strXml += makeValueAxis(mix(rel.opts, rel.opts.valAxes[1]), AXIS_ID_VALUE_SECONDARY, AXIS_ID_CATEGORY_SECONDARY);\r\n        }\r\n      }\r\n      else {\r\n        strXml += makeValueAxis(rel.opts, AXIS_ID_VALUE_PRIMARY, AXIS_ID_CATEGORY_PRIMARY, AXIS_ID_CATEGORY_SECONDARY);\r\n      }\r\n    }\r\n\r\n    // C: Chart Properties and plotArea Options: Border, Data Table, Fill, Legend\r\n    {\r\n      // NOTE: DataTable goes between '</c:valAx>' and '<c:spPr>'\r\n      if ( rel.opts.showDataTable ) {\r\n        strXml += '<c:dTable>';\r\n        strXml += '  <c:showHorzBorder val=\"'+ (rel.opts.showDataTableHorzBorder == false ? 0 : 1) +'\"/>';\r\n        strXml += '  <c:showVertBorder val=\"'+ (rel.opts.showDataTableVertBorder == false ? 0 : 1) +'\"/>';\r\n        strXml += '  <c:showOutline    val=\"'+ (rel.opts.showDataTableOutline    == false ? 0 : 1) +'\"/>';\r\n        strXml += '  <c:showKeys       val=\"'+ (rel.opts.showDataTableKeys       == false ? 0 : 1) +'\"/>';\r\n        strXml += '  <c:spPr>';\r\n        strXml += '    <a:noFill/>';\r\n        strXml += '    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"tx1\"><a:lumMod val=\"15000\"/><a:lumOff val=\"85000\"/></a:schemeClr></a:solidFill><a:round/></a:ln>';\r\n        strXml += '    <a:effectLst/>';\r\n        strXml += '  </c:spPr>';\r\n        strXml += '  <c:txPr>\\\r\n                    <a:bodyPr rot=\"0\" spcFirstLastPara=\"1\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"1\"/>\\\r\n                    <a:lstStyle/>\\\r\n                    <a:p>\\\r\n                      <a:pPr rtl=\"0\">\\\r\n                        <a:defRPr sz=\"1197\" b=\"0\" i=\"0\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\\\r\n                          <a:solidFill><a:schemeClr val=\"tx1\"><a:lumMod val=\"65000\"/><a:lumOff val=\"35000\"/></a:schemeClr></a:solidFill>\\\r\n                          <a:latin typeface=\"+mn-lt\"/>\\\r\n                          <a:ea typeface=\"+mn-ea\"/>\\\r\n                          <a:cs typeface=\"+mn-cs\"/>\\\r\n                        </a:defRPr>\\\r\n                      </a:pPr>\\\r\n                      <a:endParaRPr lang=\"en-US\"/>\\\r\n                    </a:p>\\\r\n                  </c:txPr>\\\r\n                </c:dTable>';\r\n      }\r\n\r\n      strXml += '  <c:spPr>';\r\n\r\n      // OPTION: Fill\r\n      strXml += ( rel.opts.fill ? genXmlColorSelection(rel.opts.fill) : '<a:noFill/>' );\r\n\r\n      // OPTION: Border\r\n      strXml += ( rel.opts.border ? '<a:ln w=\"'+ (rel.opts.border.pt * ONEPT) +'\"'+' cap=\"flat\">'+ genXmlColorSelection( rel.opts.border.color ) +'</a:ln>' : '<a:ln><a:noFill/></a:ln>' );\r\n\r\n      // Close shapeProp/plotArea before Legend\r\n      strXml += '    <a:effectLst/>';\r\n      strXml += '  </c:spPr>';\r\n      strXml += '</c:plotArea>';\r\n\r\n      // OPTION: Legend\r\n      // IMPORTANT: Dont specify layout to enable auto-fit: PPT does a great job maximizing space with all 4 TRBL locations\r\n      if ( rel.opts.showLegend ) {\r\n        strXml += '<c:legend>';\r\n        strXml += '<c:legendPos val=\"'+ rel.opts.legendPos +'\"/>';\r\n        strXml += '<c:layout/>';\r\n        strXml += '<c:overlay val=\"0\"/>';\r\n        if ( rel.opts.legendFontSize ) {\r\n          strXml += '<c:txPr>';\r\n          strXml += '  <a:bodyPr/>';\r\n          strXml += '  <a:lstStyle/>';\r\n          strXml += '  <a:p>';\r\n          strXml += '  <a:pPr>';\r\n          strXml += '    <a:defRPr sz=\"'+ (Number(rel.opts.legendFontSize) * 100) +'\"/>';\r\n          strXml += '    </a:pPr>';\r\n          strXml += '    <a:endParaRPr lang=\"en-US\"/>';\r\n          strXml += '  </a:p>';\r\n          strXml += '</c:txPr>';\r\n        }\r\n        strXml += '</c:legend>';\r\n      }\r\n    }\r\n\r\n    strXml += '  <c:plotVisOnly val=\"1\"/>';\r\n    strXml += '  <c:dispBlanksAs val=\"gap\"/>';\r\n    strXml += '</c:chart>';\r\n\r\n    // D: CHARTSPACE SHAPE PROPS\r\n    strXml += '<c:spPr>';\r\n    strXml += '  <a:noFill/>';\r\n    strXml += '  <a:ln w=\"12700\" cap=\"flat\"><a:noFill/><a:miter lim=\"400000\"/></a:ln>';\r\n    strXml += '  <a:effectLst/>';\r\n    strXml += '</c:spPr>';\r\n\r\n    // E: DATA (Add relID)\r\n    strXml += '<c:externalData r:id=\"rId1\"><c:autoUpdate val=\"0\"/></c:externalData>';\r\n\r\n    // LAST: chartSpace end\r\n    strXml += '</c:chartSpace>';\r\n\r\n    return strXml;\r\n  }\r\n\r\n  function createGridLineElement(glOpts, defaults, type) {\r\n    type = type || 'major';\r\n    var tagName = 'c:'+ type + 'Gridlines';\r\n    strXml =  '<'+ tagName + '>';\r\n    strXml += ' <c:spPr>';\r\n    strXml += '  <a:ln w=\"' + Math.round((glOpts.size || defaults.size) * ONEPT) +'\" cap=\"flat\">';\r\n    strXml += '  <a:solidFill><a:srgbClr val=\"' + (glOpts.color || defaults.color) + '\"/></a:solidFill>'; // should accept scheme colors as implemented in PR 135\r\n    strXml += '   <a:prstDash val=\"' + (glOpts.style || defaults.style) + '\"/><a:round/>';\r\n    strXml += '  </a:ln>';\r\n    strXml += ' </c:spPr>';\r\n    strXml += '</'+ tagName + '>';\r\n    return strXml;\r\n  }\r\n\r\n  function makeChartType(chartType, data, opts, valAxisId, catAxisId) {\r\n    var strXml = '';\r\n\r\n    switch ( chartType ) {\r\n      case 'area':\r\n      case 'bar':\r\n      case 'line':\r\n        strXml += '<c:'+ chartType +'Chart>';\r\n        if ( chartType == 'bar' ) strXml += '  <c:barDir val=\"'+ opts.barDir +'\"/>';\r\n        strXml += '  <c:grouping val=\"'+ opts.barGrouping + '\"/>';\r\n        strXml += '  <c:varyColors val=\"0\"/>';\r\n\r\n        // A: \"Series\" block for every data row\r\n        /* EX:\r\n          data: [\r\n             {\r\n               name: 'Region 1',\r\n               labels: ['April', 'May', 'June', 'July'],\r\n               values: [17, 26, 53, 96]\r\n             },\r\n             {\r\n               name: 'Region 2',\r\n               labels: ['April', 'May', 'June', 'July'],\r\n               values: [55, 43, 70, 58]\r\n             }\r\n            ]\r\n        */\r\n\r\n        // NOTE: Maintain the color index by region\r\n        var colorIndex = -1;\r\n        data.forEach(function(obj){\r\n          colorIndex++;\r\n          var idx = obj.index;\r\n          strXml += '<c:ser>';\r\n          strXml += '  <c:idx val=\"'+ idx +'\"/>';\r\n          strXml += '  <c:order val=\"'+ idx +'\"/>';\r\n          strXml += '  <c:tx>';\r\n          strXml += '    <c:strRef>';\r\n          strXml += '      <c:f>Sheet1!$A$'+ (idx+2) +'</c:f>';\r\n          strXml += '      <c:strCache><c:ptCount val=\"1\"/><c:pt idx=\"0\"><c:v>'+ obj.name +'</c:v></c:pt></c:strCache>';\r\n          strXml += '    </c:strRef>';\r\n          strXml += '  </c:tx>';\r\n\r\n          // Fill and Border\r\n          var strSerColor = opts.chartColors[colorIndex % opts.chartColors.length];\r\n\r\n          strXml += '  <c:spPr>';\r\n          if ( strSerColor == 'transparent' ) {\r\n            strXml += '<a:noFill/>';\r\n          }\r\n          else if ( opts.chartColorsOpacity ) {\r\n            strXml += '<a:solidFill>'+ createColorElement(strSerColor, '<a:alpha val=\"50000\"/>') +'</a:solidFill>';\r\n          }\r\n          else {\r\n            strXml += '<a:solidFill>'+ createColorElement(strSerColor) +'</a:solidFill>';\r\n          }\r\n\r\n          if ( chartType == 'line' ) {\r\n            if ( opts.lineSize == 0) {\r\n              strXml += '<a:ln><a:noFill/></a:ln>';\r\n            }\r\n            else {\r\n              strXml += '<a:ln w=\"' + (opts.lineSize * ONEPT) + '\" cap=\"flat\"><a:solidFill>' + createColorElement(strSerColor) + '</a:solidFill>';\r\n              strXml += '<a:prstDash val=\"' + (opts.line_dash || \"solid\") + '\"/><a:round/></a:ln>';\r\n            }\r\n          }\r\n          else if ( opts.dataBorder ) {\r\n            strXml += '<a:ln w=\"'+ (opts.dataBorder.pt * ONEPT) +'\" cap=\"flat\"><a:solidFill>'+ createColorElement(opts.dataBorder.color) +'</a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>';\r\n          }\r\n\r\n          strXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW);\r\n\r\n          strXml += '  </c:spPr>';\r\n\r\n          // LINE CHART ONLY: `marker`\r\n          if ( chartType == 'line' ) {\r\n            strXml += '<c:marker>';\r\n            strXml += '  <c:symbol val=\"'+ opts.lineDataSymbol +'\"/>';\r\n            if ( opts.lineDataSymbolSize ) {\r\n              // Defaults to \"auto\" otherwise (but this is usually too small, so there is a default)\r\n              strXml += '  <c:size val=\"'+ opts.lineDataSymbolSize +'\"/>';\r\n            }\r\n            strXml += '  <c:spPr>';\r\n            strXml += '    <a:solidFill>' + createColorElement(opts.chartColors[(idx+1 > opts.chartColors.length ? (Math.floor(Math.random() * opts.chartColors.length)) : idx)]) +'</a:solidFill>';\r\n\r\n            var symbolLineColor = opts.lineDataSymbolLineColor || strSerColor;\r\n            strXml += '    <a:ln w=\"' + opts.lineDataSymbolLineSize + '\" cap=\"flat\"><a:solidFill>'+ createColorElement(symbolLineColor) +'</a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>';\r\n            strXml += '    <a:effectLst/>';\r\n            strXml += '  </c:spPr>';\r\n            strXml += '</c:marker>';\r\n          }\r\n\r\n          // Color bar chart bars various colors\r\n          // Allow users with a single data set to pass their own array of colors (check for this using != ours)\r\n          if (( data.length === 1 || opts.valueBarColors ) && opts.chartColors != BARCHART_COLORS ) {\r\n            // Series Data Point colors\r\n            obj.values.forEach(function(value,index){\r\n              var arrColors = (value < 0 ? (opts.invertedColors || BARCHART_COLORS) : opts.chartColors);\r\n\r\n              strXml += '  <c:dPt>';\r\n              strXml += '    <c:idx val=\"'+ index +'\"/>';\r\n              strXml += '      <c:invertIfNegative val=\"'+ (opts.invertedColors ? 0 : 1) +'\"/>';\r\n              strXml += '    <c:bubble3D val=\"0\"/>';\r\n              strXml += '    <c:spPr>';\r\n              if ( opts.lineSize === 0 ){\r\n                strXml += '<a:ln><a:noFill/></a:ln>';\r\n              }\r\n              else {\r\n                strXml += '<a:solidFill>';\r\n                strXml += ' <a:srgbClr val=\"'+ arrColors[index % arrColors.length] +'\"/>';\r\n                strXml += '</a:solidFill>';\r\n              }\r\n              strXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW);\r\n              strXml += '    </c:spPr>';\r\n              strXml += '  </c:dPt>';\r\n            });\r\n          }\r\n\r\n          // 2: \"Categories\"\r\n          {\r\n            strXml += '<c:cat>';\r\n            if ( opts.catLabelFormatCode ) {\r\n              // Use 'numRef' as catLabelFormatCode implies that we are expecting numbers here\r\n              strXml += '  <c:numRef>';\r\n              strXml += '    <c:f>Sheet1!'+ '$B$1:$'+ getExcelColName(obj.labels.length) +'$1' +'</c:f>';\r\n              strXml += '    <c:numCache>';\r\n              strXml += '      <c:formatCode>'+ opts.catLabelFormatCode +'</c:formatCode>';\r\n              strXml += '      <c:ptCount val=\"'+ obj.labels.length +'\"/>';\r\n              obj.labels.forEach(function(label,idx){ strXml += '<c:pt idx=\"'+ idx +'\"><c:v>'+ decodeXmlEntities(label) +'</c:v></c:pt>'; });\r\n              strXml += '    </c:numCache>';\r\n              strXml += '  </c:numRef>';\r\n            }\r\n            else {\r\n              strXml += '  <c:strRef>';\r\n              strXml += '    <c:f>Sheet1!'+ '$B$1:$'+ getExcelColName(obj.labels.length) +'$1' +'</c:f>';\r\n              strXml += '    <c:strCache>';\r\n              strXml += '      <c:ptCount val=\"'+ obj.labels.length +'\"/>';\r\n              obj.labels.forEach(function(label,idx){ strXml += '<c:pt idx=\"'+ idx +'\"><c:v>'+ decodeXmlEntities(label) +'</c:v></c:pt>'; });\r\n              strXml += '    </c:strCache>';\r\n              strXml += '  </c:strRef>';\r\n            }\r\n            strXml += '</c:cat>';\r\n          }\r\n\r\n          // 3: \"Values\"\r\n          {\r\n            strXml += '  <c:val>';\r\n            strXml += '    <c:numRef>';\r\n            strXml += '      <c:f>Sheet1!'+ '$B$'+ (idx+2) +':$'+ getExcelColName(obj.labels.length) +'$'+ (idx+2) +'</c:f>';\r\n            strXml += '      <c:numCache>';\r\n            strXml += '        <c:ptCount val=\"'+ obj.labels.length +'\"/>';\r\n            obj.values.forEach(function(value,idx){ strXml += '<c:pt idx=\"'+ idx +'\"><c:v>'+ (value || '') +'</c:v></c:pt>'; });\r\n            strXml += '      </c:numCache>';\r\n            strXml += '    </c:numRef>';\r\n            strXml += '  </c:val>';\r\n          }\r\n\r\n          // LINE CHART ONLY: `smooth`\r\n          if ( chartType == 'line' ) strXml += '<c:smooth val=\"'+ (opts.lineSmooth ? \"1\" : \"0\" ) +'\"/>';\r\n\r\n          // 4: Close \"SERIES\"\r\n          strXml += '</c:ser>';\r\n\r\n        }); // end forEach\r\n\r\n        // 1: \"Data Labels\"\r\n        strXml += '  <c:dLbls>';\r\n        strXml += '    <c:numFmt formatCode=\"'+ opts.dataLabelFormatCode +'\" sourceLinked=\"0\"/>';\r\n        strXml += '    <c:txPr>';\r\n        strXml += '      <a:bodyPr/>';\r\n        strXml += '      <a:lstStyle/>';\r\n        strXml += '      <a:p><a:pPr>';\r\n        strXml += '        <a:defRPr b=\"0\" i=\"0\" strike=\"noStrike\" sz=\"'+ (opts.dataLabelFontSize || DEF_FONT_SIZE) +'00\" u=\"none\">';\r\n        strXml += '          <a:solidFill>'+ createColorElement(opts.dataLabelColor || DEF_FONT_COLOR) +'</a:solidFill>';\r\n        strXml += '          <a:latin typeface=\"'+ (opts.dataLabelFontFace || 'Arial') +'\"/>';\r\n        strXml += '        </a:defRPr>';\r\n        strXml += '      </a:pPr></a:p>';\r\n        strXml += '    </c:txPr>';\r\n        if ( opts.type != 'area' ) strXml += '    <c:dLblPos val=\"'+ (opts.dataLabelPosition || 'outEnd') +'\"/>';\r\n        strXml += '    <c:showLegendKey val=\"0\"/>';\r\n        strXml += '    <c:showVal val=\"'+ (opts.showValue ? '1' : '0') +'\"/>';\r\n        strXml += '    <c:showCatName val=\"0\"/>';\r\n        strXml += '    <c:showSerName val=\"0\"/>';\r\n        strXml += '    <c:showPercent val=\"0\"/>';\r\n        strXml += '    <c:showBubbleSize val=\"0\"/>';\r\n        strXml += '    <c:showLeaderLines val=\"0\"/>';\r\n        strXml += '  </c:dLbls>';\r\n\r\n        if ( chartType == 'bar' ) {\r\n          strXml += '  <c:gapWidth val=\"'+ opts.barGapWidthPct +'\"/>';\r\n          strXml += '  <c:overlap val=\"'+ (opts.barGrouping.indexOf('tacked') > -1 ? 100 : 0) +'\"/>';\r\n        }\r\n        else if ( chartType == 'line' ) {\r\n          strXml += '  <c:marker val=\"1\"/>';\r\n        }\r\n\r\n        // order matters - category first\r\n        strXml += '  <c:axId val=\"'+ catAxisId +'\"/>';\r\n        strXml += '  <c:axId val=\"'+ valAxisId +'\"/>';\r\n\r\n        strXml += '</c:'+ chartType +'Chart>';\r\n\r\n        // Done with CHART.BAR/LINE\r\n        break;\r\n\r\n      case 'pie':\r\n      case 'doughnut':\r\n        // Use the same var name so code blocks from barChart are interchangeable\r\n        var obj = data[0];\r\n\r\n        /* EX:\r\n          data: [\r\n           {\r\n             name: 'Project Status',\r\n             labels: ['Red', 'Amber', 'Green', 'Unknown'],\r\n             values: [10, 20, 38, 2]\r\n           }\r\n          ]\r\n        */\r\n\r\n        // 1: Start Chart\r\n        strXml += '<c:'+ chartType +'Chart>';\r\n        strXml += '  <c:varyColors val=\"0\"/>';\r\n        strXml += '<c:ser>';\r\n        strXml += '  <c:idx val=\"0\"/>';\r\n        strXml += '  <c:order val=\"0\"/>';\r\n        strXml += '  <c:tx>';\r\n        strXml += '    <c:strRef>';\r\n        strXml += '      <c:f>Sheet1!$A$2</c:f>';\r\n        strXml += '      <c:strCache>';\r\n        strXml += '        <c:ptCount val=\"1\"/>';\r\n        strXml += '        <c:pt idx=\"0\"><c:v>'+ decodeXmlEntities(obj.name) +'</c:v></c:pt>';\r\n        strXml += '      </c:strCache>';\r\n        strXml += '    </c:strRef>';\r\n        strXml += '  </c:tx>';\r\n        strXml += '  <c:spPr>';\r\n        strXml += '    <a:solidFill><a:schemeClr val=\"accent1\"/></a:solidFill>';\r\n        strXml += '    <a:ln w=\"9525\" cap=\"flat\"><a:solidFill><a:srgbClr val=\"F9F9F9\"/></a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>';\r\n        if ( opts.dataNoEffects ) {\r\n          strXml += '<a:effectLst/>';\r\n        }\r\n        else {\r\n          strXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW);\r\n        }\r\n        strXml += '  </c:spPr>';\r\n        strXml += '<c:explosion val=\"0\"/>';\r\n\r\n        // 2: \"Data Point\" block for every data row\r\n        obj.labels.forEach(function(label,idx){\r\n          strXml += '<c:dPt>';\r\n          strXml += '  <c:idx val=\"'+ idx +'\"/>';\r\n          strXml += '  <c:explosion val=\"0\"/>';\r\n          strXml += '  <c:spPr>';\r\n          strXml += '    <a:solidFill>'+ createColorElement(opts.chartColors[(idx+1 > opts.chartColors.length ? (Math.floor(Math.random() * opts.chartColors.length)) : idx)]) +'</a:solidFill>';\r\n          if ( opts.dataBorder ) {\r\n            strXml += '<a:ln w=\"'+ (opts.dataBorder.pt * ONEPT) +'\" cap=\"flat\"><a:solidFill>'+ createColorElement(opts.dataBorder.color) +'</a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>';\r\n          }\r\n          strXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW);\r\n          strXml += '  </c:spPr>';\r\n          strXml += '</c:dPt>';\r\n        });\r\n\r\n        // 3: \"Data Label\" block for every data Label\r\n        strXml += '<c:dLbls>';\r\n        obj.labels.forEach(function(label,idx){\r\n          strXml += '<c:dLbl>';\r\n          strXml += '  <c:idx val=\"'+ idx +'\"/>';\r\n          strXml += '    <c:numFmt formatCode=\"'+ opts.dataLabelFormatCode +'\" sourceLinked=\"0\"/>';\r\n          strXml += '    <c:txPr>';\r\n          strXml += '      <a:bodyPr/><a:lstStyle/>';\r\n          strXml += '      <a:p><a:pPr>';\r\n          strXml += '        <a:defRPr b=\"0\" i=\"0\" strike=\"noStrike\" sz=\"'+ (opts.dataLabelFontSize || DEF_FONT_SIZE) +'00\" u=\"none\">';\r\n          strXml += '          <a:solidFill>'+ createColorElement(opts.dataLabelColor || DEF_FONT_COLOR) +'</a:solidFill>';\r\n          strXml += '          <a:latin typeface=\"'+ (opts.dataLabelFontFace || 'Arial') +'\"/>';\r\n          strXml += '        </a:defRPr>';\r\n          strXml += '      </a:pPr></a:p>';\r\n          strXml += '    </c:txPr>';\r\n          if (chartType == 'pie') {\r\n            strXml += '    <c:dLblPos val=\"'+ (opts.dataLabelPosition || 'inEnd') +'\"/>';\r\n          }\r\n          strXml += '    <c:showLegendKey val=\"0\"/>';\r\n          strXml += '    <c:showVal val=\"'+ (opts.showValue ? \"1\" : \"0\") +'\"/>';\r\n          strXml += '    <c:showCatName val=\"'+ (opts.showLabel ? \"1\" : \"0\") +'\"/>';\r\n          strXml += '    <c:showSerName val=\"0\"/>';\r\n          strXml += '    <c:showPercent val=\"'+ (opts.showPercent ? \"1\" : \"0\") +'\"/>';\r\n          strXml += '    <c:showBubbleSize val=\"0\"/>';\r\n          strXml += '  </c:dLbl>';\r\n        });\r\n        strXml += '<c:numFmt formatCode=\"'+ opts.dataLabelFormatCode +'\" sourceLinked=\"0\"/>\\\r\n                <c:txPr>\\\r\n                  <a:bodyPr/>\\\r\n                  <a:lstStyle/>\\\r\n                  <a:p>\\\r\n                    <a:pPr>\\\r\n                      <a:defRPr b=\"0\" i=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\">\\\r\n                        <a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:latin typeface=\"Arial\"/>\\\r\n                      </a:defRPr>\\\r\n                    </a:pPr>\\\r\n                  </a:p>\\\r\n                </c:txPr>\\\r\n                ' + (chartType == 'pie' ? '<c:dLblPos val=\"ctr\"/>' : '') + '\\\r\n                <c:showLegendKey val=\"0\"/>\\\r\n                <c:showVal val=\"0\"/>\\\r\n                <c:showCatName val=\"1\"/>\\\r\n                <c:showSerName val=\"0\"/>\\\r\n                <c:showPercent val=\"1\"/>\\\r\n                <c:showBubbleSize val=\"0\"/>\\\r\n                <c:showLeaderLines val=\"0\"/>';\r\n        strXml += '</c:dLbls>';\r\n\r\n        // 2: \"Categories\"\r\n        strXml += '<c:cat>';\r\n        strXml += '  <c:strRef>';\r\n        strXml += '    <c:f>Sheet1!'+ '$B$1:$'+ getExcelColName(obj.labels.length) +'$1' +'</c:f>';\r\n        strXml += '    <c:strCache>';\r\n        strXml += '      <c:ptCount val=\"'+ obj.labels.length +'\"/>';\r\n        obj.labels.forEach(function(label,idx){ strXml += '<c:pt idx=\"'+ idx +'\"><c:v>'+ decodeXmlEntities(label) +'</c:v></c:pt>'; });\r\n        strXml += '    </c:strCache>';\r\n        strXml += '  </c:strRef>';\r\n        strXml += '</c:cat>';\r\n\r\n        // 3: Create vals\r\n        strXml += '  <c:val>';\r\n        strXml += '    <c:numRef>';\r\n        strXml += '      <c:f>Sheet1!'+ '$B$2:$'+ getExcelColName(obj.labels.length) +'$'+ 2 +'</c:f>';\r\n        strXml += '      <c:numCache>';\r\n        strXml += '        <c:ptCount val=\"'+ obj.labels.length +'\"/>';\r\n        obj.values.forEach(function(value,idx){ strXml += '<c:pt idx=\"'+ idx +'\"><c:v>'+ (value || '') +'</c:v></c:pt>'; });\r\n        strXml += '      </c:numCache>';\r\n        strXml += '    </c:numRef>';\r\n        strXml += '  </c:val>';\r\n\r\n        // 4: Close \"SERIES\"\r\n        strXml += '  </c:ser>';\r\n        strXml += '  <c:firstSliceAng val=\"0\"/>';\r\n        if ( chartType == 'doughnut' ) strXml += '  <c:holeSize val=\"' + (opts.holeSize || 50) + '\"/>';\r\n        strXml += '</c:'+ chartType +'Chart>';\r\n\r\n        // Done with CHART.PIE\r\n        break;\r\n    }\r\n\r\n    return strXml;\r\n  }\r\n\r\n  function makeCatAxis(opts, axisId) {\r\n    var strXml = '';\r\n\r\n    // Start cat axis tag\r\n    strXml += '<c:'+ (opts.catLabelFormatCode ? 'dateAx' : 'catAx') +'>';\r\n\r\n    if ( opts.showCatAxisTitle ) {\r\n      strXml += genXmlTitle({\r\n        title:    opts.catAxisTitle || 'Axis Title',\r\n        fontSize: opts.catAxisTitleFontSize,\r\n        color:    opts.catAxisTitleColor,\r\n        fontFace: opts.catAxisTitleFontFace,\r\n        rotate:   opts.catAxisTitleRotate\r\n      });\r\n    }\r\n\r\n    strXml += '  <c:axId val=\"'+ axisId +'\"/>';\r\n    strXml += '  <c:scaling><c:orientation val=\"'+ (opts.catAxisOrientation || (opts.barDir == 'col' ? 'minMax' : 'minMax')) +'\"/></c:scaling>';\r\n    strXml += '  <c:delete val=\"'+ (opts.catAxisHidden ? 1 : 0) +'\"/>';\r\n    strXml += '  <c:axPos val=\"'+ (opts.barDir == 'col' ? 'b' : 'l') +'\"/>';\r\n    strXml += ( opts.catGridLine !== 'none' ? createGridLineElement(opts.catGridLine, DEF_CHART_GRIDLINE) : '' );\r\n    strXml += '  <c:numFmt formatCode=\"'+ (opts.catLabelFormatCode || \"General\") +'\" sourceLinked=\"0\"/>';\r\n    strXml += '  <c:majorTickMark val=\"out\"/>';\r\n    strXml += '  <c:minorTickMark val=\"none\"/>';\r\n    strXml += '  <c:tickLblPos val=\"'+ (opts.barDir == 'col' ? 'low' : 'nextTo') +'\"/>';\r\n    strXml += '  <c:spPr>';\r\n    strXml += '    <a:ln w=\"12700\" cap=\"flat\"><a:solidFill><a:srgbClr val=\"888888\"/></a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>';\r\n    strXml += '  </c:spPr>';\r\n    strXml += '  <c:txPr>';\r\n    strXml += '    <a:bodyPr/>';  // don't specify rot 0 so we get the auto behavior\r\n    strXml += '    <a:lstStyle/>';\r\n    strXml += '    <a:p>';\r\n    strXml += '    <a:pPr>';\r\n    strXml += '<a:defRPr b=\"0\" i=\"0\" strike=\"noStrike\" sz=\"'+ (opts.catAxisLabelFontSize || DEF_FONT_SIZE) +'00\" u=\"none\">';\r\n    strXml += '<a:solidFill><a:srgbClr val=\"'+ (opts.catAxisLabelColor || DEF_FONT_COLOR) +'\"/></a:solidFill>';\r\n    strXml += '<a:latin typeface=\"'+ (opts.catAxisLabelFontFace || 'Arial') +'\"/>';\r\n    strXml += '   </a:defRPr>';\r\n    strXml += '  </a:pPr>';\r\n    strXml += '  </a:p>';\r\n    strXml += ' </c:txPr>';\r\n    strXml += ' <c:crossAx val=\"'+ axisId +'\"/>';\r\n    strXml += ' <c:crosses val=\"autoZero\"/>';\r\n    strXml += ' <c:auto val=\"1\"/>';\r\n    strXml += ' <c:lblAlgn val=\"ctr\"/>';\r\n    strXml += ' <c:noMultiLvlLbl val=\"1\"/>';\r\n        if ( opts.catAxisLabelFrequency ) strXml += ' <c:tickLblSkip val=\"' +  opts.catAxisLabelFrequency + '\"/>';\r\n\r\n    // Issue#149: PPT will auto-adjust these as needed after calcing the date bounds, so we only include them when specified by user\r\n    if ( opts.catLabelFormatCode ) {\r\n      ['catAxisBaseTimeUnit','catAxisMajorTimeUnit','catAxisMinorTimeUnit'].forEach(function(opt,idx){\r\n        // Validate input as poorly chosen/garbage options will cause chart corruption and it wont render at all!\r\n        if ( opts[opt] && (typeof opts[opt] !== 'string' || ['days','months','years'].indexOf(opt.toLowerCase()) == -1) ) {\r\n          console.warn(\"`\"+opt+\"` must be one of: 'days','months','years' !\");\r\n          opts[opt] = null;\r\n        }\r\n      });\r\n      if ( opts.catAxisBaseTimeUnit )  strXml += ' <c:baseTimeUnit  val=\"'+ opts.catAxisBaseTimeUnit.toLowerCase()  +'\"/>';\r\n      if ( opts.catAxisMajorTimeUnit ) strXml += ' <c:majorTimeUnit val=\"'+ opts.catAxisMajorTimeUnit.toLowerCase() +'\"/>';\r\n      if ( opts.catAxisMinorTimeUnit ) strXml += ' <c:minorTimeUnit val=\"'+ opts.catAxisMinorTimeUnit.toLowerCase() +'\"/>';\r\n      if ( opts.catAxisMajorUnit )     strXml += ' <c:majorUnit     val=\"'+ opts.catAxisMajorUnit +'\"/>';\r\n      if ( opts.catAxisMinorUnit )     strXml += ' <c:minorUnit     val=\"'+ opts.catAxisMinorUnit +'\"/>';\r\n    }\r\n\r\n    // Close cat axis tag\r\n    strXml += '</c:'+ (opts.catLabelFormatCode ? 'dateAx' : 'catAx') +'>';\r\n\r\n    return strXml;\r\n  }\r\n\r\n  function makeValueAxis(opts, valAxisId) {\r\n    var axisPos = valAxisId === AXIS_ID_VALUE_PRIMARY ? (opts.barDir == 'col' ? 'l' : 'b') : (opts.barDir == 'col' ? 'r' : 't');\r\n    var strXml = '';\r\n    var isRight = axisPos === 'r' || axisPos === 't';\r\n    var crosses = isRight ? 'max' : 'autoZero';\r\n    var crossAxId = valAxisId === AXIS_ID_VALUE_PRIMARY ? AXIS_ID_CATEGORY_PRIMARY : AXIS_ID_CATEGORY_SECONDARY;\r\n\r\n    strXml += '<c:valAx>';\r\n    if (opts.showValAxisTitle) {\r\n      strXml += genXmlTitle({\r\n        title: opts.valAxisTitle || 'Axis Title',\r\n        fontSize: opts.valAxisTitleFontSize,\r\n        color: opts.valAxisTitleColor,\r\n        fontFace: opts.valAxisTitleFontFace,\r\n        rotate: opts.valAxisTitleRotate\r\n      });\r\n    }\r\n    strXml += '  <c:axId val=\"'+ valAxisId +'\"/>';\r\n    strXml += '  <c:scaling>';\r\n    strXml += '    <c:orientation val=\"'+ (opts.valAxisOrientation || (opts.barDir == 'col' ? 'minMax' : 'minMax')) +'\"/>';\r\n    if (opts.valAxisMaxVal) strXml += '<c:max val=\"'+ opts.valAxisMaxVal +'\"/>';\r\n    if (opts.valAxisMinVal) strXml += '<c:min val=\"'+ opts.valAxisMinVal +'\"/>';\r\n    strXml += '  </c:scaling>';\r\n    strXml += '  <c:delete val=\"'+ (opts.valAxisHidden ? 1 : 0) +'\"/>';\r\n    strXml += '  <c:axPos val=\"'+ axisPos +'\"/>';\r\n    if (opts.valGridLine != 'none') strXml += createGridLineElement(opts.valGridLine, DEF_CHART_GRIDLINE);\r\n    strXml += ' <c:numFmt formatCode=\"'+ (opts.valAxisLabelFormatCode ? opts.valAxisLabelFormatCode : 'General') +'\" sourceLinked=\"0\"/>';\r\n    strXml += ' <c:majorTickMark val=\"out\"/>';\r\n    strXml += ' <c:minorTickMark val=\"none\"/>';\r\n    strXml += ' <c:tickLblPos val=\"'+ (opts.barDir == 'col' ? 'nextTo' : 'low') +'\"/>';\r\n    strXml += '<c:spPr>';\r\n    strXml += '  <a:ln w=\"12700\" cap=\"flat\"><a:solidFill><a:srgbClr val=\"888888\"/></a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>';\r\n    strXml += '</c:spPr>';\r\n    strXml += ' <c:txPr>';\r\n    strXml += '  <a:bodyPr/>'; // don't specify rot=0 so we can get the PPT default\r\n    strXml += '  <a:lstStyle/>';\r\n    strXml += '  <a:p>';\r\n    strXml += '    <a:pPr>';\r\n    strXml += '      <a:defRPr b=\"0\" i=\"0\" strike=\"noStrike\" sz=\"'+ (opts.valAxisLabelFontSize || DEF_FONT_SIZE) +'00\" u=\"none\">';\r\n    strXml += '        <a:solidFill><a:srgbClr val=\"'+ (opts.valAxisLabelColor || DEF_FONT_COLOR) +'\"/></a:solidFill>';\r\n    strXml += '        <a:latin typeface=\"'+ (opts.valAxisLabelFontFace || 'Arial') +'\"/>';\r\n    strXml += '      </a:defRPr>';\r\n    strXml += '    </a:pPr>';\r\n    strXml += '  </a:p>';\r\n    strXml += ' </c:txPr>';\r\n    strXml += ' <c:crossAx val=\"'+ crossAxId +'\"/>';\r\n    strXml += ' <c:crosses val=\"'+ crosses +'\"/>';\r\n    strXml += ' <c:crossBetween val=\"'+ ( opts.hasArea ? 'midCat' : 'between' ) +'\"/>';\r\n    if ( opts.valAxisMajorUnit ) strXml += ' <c:majorUnit val=\"'+ opts.valAxisMajorUnit +'\"/>';\r\n    strXml += '</c:valAx>';\r\n\r\n    return strXml;\r\n  }\r\n\r\n  /**\r\n  * DESC: Convert degrees (0..360) to Powerpoint rot value\r\n  */\r\n  function convertRotationDegrees(d) {\r\n    d = d || 0;\r\n    return (d > 360 ? (d - 360) : d) * 60000;\r\n  }\r\n\r\n  /**\r\n  * DESC: Generate the XML for title elements used for the char and axis titles\r\n  */\r\n  function genXmlTitle(opts) {\r\n    var align = ( opts.titleAlign == 'left' ? 'l' : (opts.titleAlign == 'right' ? 'r' : false) );\r\n    var strXml = '';\r\n    strXml += '<c:title>';\r\n    strXml += ' <c:tx>';\r\n    strXml += '  <c:rich>';\r\n    if ( opts.rotate ) {\r\n      strXml += '  <a:bodyPr rot=\"' + convertRotationDegrees(opts.rotate) + '\"/>';\r\n    }\r\n    else {\r\n      strXml += '  <a:bodyPr/>';  // don't specify rotation to get default (ex. vertical for cat axis)\r\n    }\r\n    strXml += '  <a:lstStyle/>';\r\n    strXml += '  <a:p>';\r\n    strXml += ( align ? '<a:pPr algn=\"'+ align +'\">' : '<a:pPr>' );\r\n    var sizeAttr = '';\r\n    if ( opts.fontSize ) {\r\n      // only set the font size if specified.  Powerpoint will handle the default size\r\n      sizeAttr = 'sz=\"'+ opts.fontSize +'00\"';\r\n    }\r\n    strXml += '      <a:defRPr b=\"0\" i=\"0\" strike=\"noStrike\" '+ sizeAttr +' u=\"none\">';\r\n    strXml += '        <a:solidFill><a:srgbClr val=\"'+ (opts.color || DEF_FONT_COLOR) +'\"/></a:solidFill>';\r\n    strXml += '        <a:latin typeface=\"'+ (opts.fontFace || 'Arial') +'\"/>';\r\n    strXml += '      </a:defRPr>';\r\n    strXml += '    </a:pPr>';\r\n    strXml += '    <a:r>';\r\n    strXml += '      <a:rPr b=\"0\" i=\"0\" strike=\"noStrike\" '+ sizeAttr +' u=\"none\">';\r\n    strXml += '        <a:solidFill><a:srgbClr val=\"'+ (opts.color || DEF_FONT_COLOR) +'\"/></a:solidFill>';\r\n    strXml += '        <a:latin typeface=\"'+ (opts.fontFace || 'Arial') +'\"/>';\r\n    strXml += '      </a:rPr>';\r\n    strXml += '      <a:t>'+ (decodeXmlEntities(opts.title) || '') +'</a:t>';\r\n    strXml += '    </a:r>';\r\n    strXml += '  </a:p>';\r\n    strXml += '  </c:rich>';\r\n    strXml += ' </c:tx>';\r\n    if ( opts.titlePos && opts.titlePos.x && opts.titlePos.y ) {\r\n      strXml += '<c:layout>';\r\n      strXml += '  <c:manualLayout>';\r\n      strXml += '    <c:xMode val=\"edge\"/>';\r\n      strXml += '    <c:yMode val=\"edge\"/>';\r\n      strXml += '    <c:x val=\"'+ opts.titlePos.x +'\"/>';\r\n      strXml += '    <c:y val=\"'+ opts.titlePos.y +'\"/>';\r\n      strXml += '  </c:manualLayout>';\r\n      strXml += '</c:layout>';\r\n    }\r\n    else {\r\n      strXml += ' <c:layout/>';\r\n    }\r\n    strXml += ' <c:overlay val=\"0\"/>';\r\n    strXml += '</c:title>';\r\n    return strXml;\r\n  }\r\n\r\n  /**\r\n  * DESC: Generate the XML for text and its options (bold, bullet, etc) including text runs (word-level formatting)\r\n  * EX:\r\n    <p:txBody>\r\n      <a:bodyPr wrap=\"none\" lIns=\"50800\" tIns=\"50800\" rIns=\"50800\" bIns=\"50800\" anchor=\"ctr\">\r\n      </a:bodyPr>\r\n      <a:lstStyle/>\r\n      <a:p>\r\n        <a:pPr marL=\"228600\" indent=\"-228600\"><a:buSzPct val=\"100000\"/><a:buChar char=\"&#x2022;\"/></a:pPr>\r\n        <a:r>\r\n        <a:t>bullet 1 </a:t>\r\n        </a:r>\r\n        <a:r>\r\n        <a:rPr>\r\n          <a:solidFill><a:srgbClr val=\"7B2CD6\"/></a:solidFill>\r\n        </a:rPr>\r\n        <a:t>colored text</a:t>\r\n        </a:r>\r\n      </a:p>\r\n      </p:txBody>\r\n  * NOTES:\r\n  * - PPT text lines [lines followed by line-breaks] are createing using <p>-aragraph's\r\n  * - Bullets are a paragprah-level formatting device\r\n  *\r\n  * @param slideObj (object) - slideObj -OR- table `cell` object\r\n  * @returns XML string containing the param object's text and formatting\r\n  */\r\n  function genXmlTextBody(slideObj) {\r\n    // FIRST: Shapes without text, etc. may be sent here during build, but have no text to render so return an empty string\r\n    if ( !slideObj.options.isTableCell && (typeof slideObj.text === 'undefined' || slideObj.text == null) ) return '';\r\n\r\n    // Create options if needed\r\n    if ( !slideObj.options ) slideObj.options = {};\r\n\r\n    // Vars\r\n    var arrTextObjects = [];\r\n    var tagStart = ( slideObj.options.isTableCell ? '<a:txBody>'  : '<p:txBody>' );\r\n    var tagClose = ( slideObj.options.isTableCell ? '</a:txBody>' : '</p:txBody>' );\r\n    var strSlideXml = tagStart;\r\n    var strXmlBullet = '', strXmlLnSpc = '';\r\n    var bulletLvl0Margin = 342900;\r\n    var paragraphPropXml = '<a:pPr ';\r\n\r\n    // STEP 1: Modify slideObj to be consistent array of `{ text:'', options:{} }`\r\n    /* CASES:\r\n      addText( 'string' )\r\n      addText( 'line1\\n line2' )\r\n      addText( ['barry','allen'] )\r\n      addText( [{text'word1'}, {text:'word2'}] )\r\n      addText( [{text'line1\\n line2'}, {text:'end word'}] )\r\n    */\r\n    // A: Handle string/number\r\n    if ( typeof slideObj.text === 'string' || typeof slideObj.text === 'number' ) {\r\n      slideObj.text = [ {text:slideObj.text.toString(), options:(slideObj.options || {})} ];\r\n    }\r\n\r\n    // STEP 2: Grab options, format line-breaks, etc.\r\n    if ( Array.isArray(slideObj.text) ) {\r\n      slideObj.text.forEach(function(obj,idx){\r\n        // A: Set options\r\n        obj.options = obj.options || slideObj.options || {};\r\n        if ( idx == 0 && !obj.options.bullet && slideObj.options.bullet ) obj.options.bullet = slideObj.options.bullet;\r\n\r\n        // B: Cast to text-object and fix line-breaks (if needed)\r\n        if ( typeof obj.text === 'string' || typeof obj.text === 'number' ) {\r\n          obj.text = obj.text.toString().replace(/\\r*\\n/g, CRLF);\r\n          // Plain strings like \"hello \\n world\" need to have lineBreaks set to break as intended\r\n          if ( obj.text.indexOf(CRLF) > -1 ) obj.options.breakLine = true;\r\n        }\r\n\r\n        // C: If text string has line-breaks, then create a separate text-object for each (much easier than dealing with split inside a loop below)\r\n        if ( obj.text.split(CRLF).length > 0 ) {\r\n          obj.text.toString().split(CRLF).forEach(function(line,idx){\r\n            // Add line-breaks if not bullets/aligned (we add CRLF for those below in STEP 2)\r\n            line += ( obj.options.breakLine && !obj.options.bullet && !obj.options.align ? CRLF : '' );\r\n            arrTextObjects.push( {text:line, options:obj.options} );\r\n          });\r\n        }\r\n        else {\r\n          // NOTE: The replace used here is for non-textObjects (plain strings) eg:'hello\\nworld'\r\n          arrTextObjects.push( obj );\r\n        }\r\n      });\r\n    }\r\n\r\n    // STEP 3: Add bodyProperties\r\n    {\r\n      // A: 'bodyPr'\r\n      strSlideXml += genXmlBodyProperties(slideObj.options);\r\n\r\n      // B: 'lstStyle'\r\n      // NOTE: Shape type 'LINE' has different text align needs (a lstStyle.lvl1pPr between bodyPr and p)\r\n      // FIXME: LINE horiz-align doesnt work (text is always to the left inside line) (FYI: the PPT code diff is substantial!)\r\n      if ( slideObj.options.h == 0 && slideObj.options.line && slideObj.options.align ) {\r\n        strSlideXml += '<a:lstStyle><a:lvl1pPr algn=\"l\"/></a:lstStyle>';\r\n      }\r\n      else {\r\n        strSlideXml += '<a:lstStyle/>';\r\n      }\r\n    }\r\n\r\n    // STEP 4: Loop over each text object and create paragraph props, text run, etc.\r\n    arrTextObjects.forEach(function(textObj,idx){\r\n      // Clear/Increment loop vars\r\n      paragraphPropXml = '<a:pPr '+ (textObj.options.rtlMode ? ' rtl=\"1\" ' : '');\r\n      strXmlBullet = '';\r\n      textObj.options.lineIdx = idx;\r\n\r\n      // Inherit pPr-type options from parent shape's `options`\r\n      textObj.options.align = textObj.options.align || slideObj.options.align;\r\n      textObj.options.lineSpacing = textObj.options.lineSpacing || slideObj.options.lineSpacing;\r\n      textObj.options.indentLevel = textObj.options.indentLevel || slideObj.options.indentLevel\r\n\r\n      // A: Build paragraphProperties\r\n      {\r\n        // OPTION: align\r\n        if ( textObj.options.align ) {\r\n          switch ( textObj.options.align ) {\r\n            case 'r':\r\n            case 'right':\r\n              paragraphPropXml += 'algn=\"r\"';\r\n              break;\r\n            case 'c':\r\n            case 'ctr':\r\n            case 'center':\r\n              paragraphPropXml += 'algn=\"ctr\"';\r\n              break;\r\n            case 'justify':\r\n              paragraphPropXml += 'algn=\"just\"';\r\n              break;\r\n          }\r\n        }\r\n\r\n        if ( textObj.options.lineSpacing ) {\r\n          strXmlLnSpc = '<a:lnSpc><a:spcPts val=\"' + textObj.options.lineSpacing + '00\"/></a:lnSpc>';\r\n        }\r\n\r\n        // OPTION: indent\r\n        if ( textObj.options.indentLevel && !isNaN(Number(textObj.options.indentLevel)) && textObj.options.indentLevel > 0 ) {\r\n          paragraphPropXml += ' lvl=\"' + textObj.options.indentLevel + '\"';\r\n        }\r\n\r\n        // Set core XML for use below\r\n        paraPropXmlCore = paragraphPropXml;\r\n\r\n        // OPTION: bullet\r\n        // NOTE: OOXML uses the unicode character set for Bullets\r\n        // EX: Unicode Character 'BULLET' (U+2022) ==> '<a:buChar char=\"&#x2022;\"/>'\r\n        if ( typeof textObj.options.bullet === 'object' ) {\r\n          if ( textObj.options.bullet.type ) {\r\n            if ( textObj.options.bullet.type.toString().toLowerCase() == \"number\" ) {\r\n              paragraphPropXml += ' marL=\"'+ (textObj.options.indentLevel && textObj.options.indentLevel > 0 ? bulletLvl0Margin+(bulletLvl0Margin*textObj.options.indentLevel) : bulletLvl0Margin) +'\" indent=\"-'+bulletLvl0Margin+'\"';\r\n              strXmlBullet = '<a:buSzPct val=\"100000\"/><a:buFont typeface=\"+mj-lt\"/><a:buAutoNum type=\"arabicPeriod\"/>';\r\n            }\r\n          }\r\n          else if ( textObj.options.bullet.code ) {\r\n            var bulletCode = '&#x'+ textObj.options.bullet.code +';';\r\n\r\n            // Check value for hex-ness (s/b 4 char hex)\r\n            if ( /^[0-9A-Fa-f]{4}$/.test(textObj.options.bullet.code) == false ) {\r\n              console.warn('Warning: `bullet.code should be a 4-digit hex code (ex: 22AB)`!');\r\n              bulletCode = BULLET_TYPES['DEFAULT'];\r\n            }\r\n\r\n            paragraphPropXml += ' marL=\"'+ (textObj.options.indentLevel && textObj.options.indentLevel > 0 ? bulletLvl0Margin+(bulletLvl0Margin*textObj.options.indentLevel) : bulletLvl0Margin) +'\" indent=\"-'+bulletLvl0Margin+'\"';\r\n            strXmlBullet = '<a:buSzPct val=\"100000\"/><a:buChar char=\"'+ bulletCode +'\"/>';\r\n          }\r\n        }\r\n        // DEPRECATED: old bool value (FIXME:Drop in 2.0)\r\n        else if ( textObj.options.bullet == true ) {\r\n          paragraphPropXml += ' marL=\"'+ (textObj.options.indentLevel && textObj.options.indentLevel > 0 ? bulletLvl0Margin+(bulletLvl0Margin*textObj.options.indentLevel) : bulletLvl0Margin) +'\" indent=\"-'+bulletLvl0Margin+'\"';\r\n          strXmlBullet = '<a:buSzPct val=\"100000\"/><a:buChar char=\"'+ BULLET_TYPES['DEFAULT'] +'\"/>';\r\n        }\r\n\r\n        // Close Paragraph-Properties --------------------\r\n        // IMPORTANT: strXmlLnSpc must precede strXmlBullet for bullet lineSpacing to work (PPT-Online)\r\n        paragraphPropXml += '>'+ strXmlLnSpc + strXmlBullet +'</a:pPr>';\r\n      }\r\n\r\n      // B: Start paragraph if this is the first text obj, or if current textObj is about to be bulleted or aligned\r\n      if ( idx == 0 ) {\r\n        // Add paragraphProperties right after <p> before textrun(s) begin\r\n        strSlideXml += '<a:p>' + paragraphPropXml;\r\n      }\r\n      else if ( idx > 0 && (typeof textObj.options.bullet !== 'undefined' || typeof textObj.options.align !== 'undefined') ) {\r\n        strSlideXml += '</a:p><a:p>' + paragraphPropXml;\r\n      }\r\n\r\n      // C: Inherit any main options (color, font_size, etc.)\r\n      // We only pass the text.options to genXmlTextRun (not the Slide.options),\r\n      // so the run building function cant just fallback to Slide.color, therefore, we need to do that here before passing options below.\r\n      $.each(slideObj.options, function(key,val){\r\n        // NOTE: This loop will pick up unecessary keys (`x`, etc.), but it doesnt hurt anything\r\n        if ( key != 'bullet' && !textObj.options[key] ) textObj.options[key] = val;\r\n      });\r\n\r\n      // D: Add formatted textrun\r\n      strSlideXml += genXmlTextRun(textObj.options, textObj.text);\r\n    });\r\n\r\n    // STEP 5: Append 'endParaRPr' (when needed) and close current open paragraph\r\n    // NOTE: (ISSUE#20/#193): Add 'endParaRPr' with font/size props or PPT default (Arial/18pt en-us) is used making row \"too tall\"/not horoning opts\r\n    if ( slideObj.options.isTableCell && (slideObj.options.font_size || slideObj.options.font_face) ) {\r\n      strSlideXml += '<a:endParaRPr lang=\"'+ ( slideObj.options.lang ? slideObj.options.lang : 'en-US' ) +'\" '\r\n        + (slideObj.options.font_size ? ' sz=\"'+ Math.round(slideObj.options.font_size) +'00\"' : '') + ' dirty=\"0\">';\r\n      if ( slideObj.options.font_face ) {\r\n        strSlideXml += '  <a:latin typeface=\"'+ slideObj.options.font_face +'\" charset=\"0\" />';\r\n        strSlideXml += '  <a:ea    typeface=\"'+ slideObj.options.font_face +'\" charset=\"0\" />';\r\n        strSlideXml += '  <a:cs    typeface=\"'+ slideObj.options.font_face +'\" charset=\"0\" />';\r\n      }\r\n      strSlideXml += '</a:endParaRPr>';\r\n    }\r\n    strSlideXml += '</a:p>';\r\n\r\n    // STEP 6: Close the textBody\r\n    strSlideXml += tagClose;\r\n\r\n    // LAST: Return XML\r\n    return strSlideXml;\r\n  }\r\n\r\n  /**\r\n  * DESC: Builds <a:r></a:r> text runs for <a:p> paragraphs in textBody\r\n  * EX:\r\n  <a:r>\r\n    <a:rPr lang=\"en-US\" sz=\"2800\" dirty=\"0\" smtClean=\"0\">\r\n    <a:solidFill>\r\n      <a:srgbClr val=\"00FF00\">\r\n      </a:srgbClr>\r\n    </a:solidFill>\r\n    <a:latin typeface=\"Courier New\" pitchFamily=\"34\" charset=\"0\"/>\r\n    <a:cs typeface=\"Courier New\" pitchFamily=\"34\" charset=\"-120\"/>\r\n    </a:rPr>\r\n    <a:t>Misc font/color, size = 28</a:t>\r\n  </a:r>\r\n  */\r\n  function genXmlTextRun(opts, text_string) {\r\n    var xmlTextRun = '';\r\n    var paraProp = '';\r\n    var parsedText;\r\n\r\n    // BEGIN runProperties\r\n    var startInfo = '<a:rPr lang=\"'+ ( opts.lang ? opts.lang : 'en-US' ) +'\" '+ ( opts.lang ? ' altLang=\"en-US\"' : '' );\r\n    startInfo += ( opts.bold      ? ' b=\"1\"' : '' );\r\n    startInfo += ( opts.font_size ? ' sz=\"'+ Math.round(opts.font_size) +'00\"' : '' ); // NOTE: Use round so sizes like '7.5' wont cause corrupt pres.\r\n    startInfo += ( opts.italic    ? ' i=\"1\"' : '' );\r\n    startInfo += ( opts.underline || opts.hyperlink ? ' u=\"sng\"' : '' );\r\n    startInfo += ( opts.subscript ? ' baseline=\"-40000\"' : (opts.superscript ? ' baseline=\"30000\"' : '') );\r\n    // not doc in API yet: startInfo += ( opts.char_spacing ? ' spc=\"' + (text_info.char_spacing * 100) + '\" kern=\"0\"' : '' ); // IMPORTANT: Also disable kerning; otherwise text won't actually expand\r\n    startInfo += ' dirty=\"0\" smtClean=\"0\">';\r\n    // Color and Font are children of <a:rPr>, so add them now before closing the runProperties tag\r\n    if ( opts.color || opts.font_face ) {\r\n      if ( opts.color ) startInfo += genXmlColorSelection( opts.color );\r\n      if ( opts.font_face ) {\r\n        // NOTE: 'cs' = Complex Script, 'ea' = East Asian (use -120 instead of 0 - see Issue #174)\r\n        startInfo += '<a:latin typeface=\"' + opts.font_face + '\" pitchFamily=\"34\" charset=\"0\"/>'\r\n              + '<a:cs typeface=\"' + opts.font_face + '\" pitchFamily=\"34\" charset=\"-120\"/>'\r\n              + '<a:ea typeface=\"' + opts.font_face + '\" pitchFamily=\"34\" charset=\"-120\"/>';\r\n      }\r\n    }\r\n\r\n    // Hyperlink support\r\n    if ( opts.hyperlink ) {\r\n      if ( typeof opts.hyperlink !== 'object' ) console.log(\"ERROR: text `hyperlink` option should be an object. Ex: `hyperlink:{url:'https://github.com'}` \");\r\n      else if ( !opts.hyperlink.url || typeof opts.hyperlink.url !== 'string' ) console.log(\"ERROR: 'hyperlink.url is required and/or should be a string'\");\r\n      else if ( opts.hyperlink.url ) {\r\n        // FIXME-20170410: FUTURE-FEATURE: color (link is always blue in Keynote and PPT online, so usual text run above isnt honored for links..?)\r\n        //startInfo += '<a:uFill>'+ genXmlColorSelection('0000FF') +'</a:uFill>'; // Breaks PPT2010! (Issue#74)\r\n        startInfo += '<a:hlinkClick r:id=\"rId'+ opts.hyperlink.rId +'\" invalidUrl=\"\" action=\"\" tgtFrame=\"\" tooltip=\"'+ (opts.hyperlink.tooltip ? decodeXmlEntities(opts.hyperlink.tooltip) : '') +'\" history=\"1\" highlightClick=\"0\" endSnd=\"0\"/>';\r\n      }\r\n    }\r\n\r\n    // END runProperties\r\n    startInfo += '</a:rPr>';\r\n\r\n    // LINE-BREAKS/MULTI-LINE: Split text into multi-p:\r\n    parsedText = text_string.split(CRLF);\r\n    if ( parsedText.length > 1 ) {\r\n      var outTextData = '';\r\n      for ( var i = 0, total_size_i = parsedText.length; i < total_size_i; i++ ) {\r\n        outTextData += '<a:r>' + startInfo+ '<a:t>' + decodeXmlEntities(parsedText[i]);\r\n        // Stop/Start <p>aragraph as long as there is more lines ahead (otherwise its closed at the end of this function)\r\n        if ( (i + 1) < total_size_i ) outTextData += (opts.breakLine ? CRLF : '') + '</a:t></a:r>';\r\n      }\r\n      xmlTextRun = outTextData;\r\n    }\r\n    else {\r\n      // Handle cases where addText `text` was an array of objects - if a text object doesnt contain a '\\n' it still need alignment!\r\n      // The first pPr-align is done in makeXml - use line countr to ensure we only add subsequently as needed\r\n      xmlTextRun = ( (opts.align && opts.lineIdx > 0) ? paraProp : '') + '<a:r>' + startInfo+ '<a:t>' + decodeXmlEntities(text_string);\r\n    }\r\n\r\n    // Return paragraph with text run\r\n    return xmlTextRun + '</a:t></a:r>';\r\n  }\r\n\r\n  /**\r\n  * DESC: Builds <a:bodyPr></a:bodyPr> tag\r\n  */\r\n  function genXmlBodyProperties(objOptions) {\r\n    var bodyProperties = '<a:bodyPr';\r\n\r\n    if ( objOptions && objOptions.bodyProp ) {\r\n      // A: Enable or disable textwrapping none or square:\r\n      ( objOptions.bodyProp.wrap ) ? bodyProperties += ' wrap=\"' + objOptions.bodyProp.wrap + '\" rtlCol=\"0\"' : bodyProperties += ' wrap=\"square\" rtlCol=\"0\"';\r\n\r\n      // B: Set anchorPoints ('t','ctr',b'):\r\n      if ( objOptions.bodyProp.anchor ) bodyProperties += ' anchor=\"' + objOptions.bodyProp.anchor + '\"';\r\n      //if ( objOptions.bodyProp.anchorCtr ) bodyProperties += ' anchorCtr=\"' + objOptions.bodyProp.anchorCtr + '\"';\r\n\r\n      // C: Textbox margins [padding]:\r\n      if ( objOptions.bodyProp.bIns || objOptions.bodyProp.bIns == 0 ) bodyProperties += ' bIns=\"' + objOptions.bodyProp.bIns + '\"';\r\n      if ( objOptions.bodyProp.lIns || objOptions.bodyProp.lIns == 0 ) bodyProperties += ' lIns=\"' + objOptions.bodyProp.lIns + '\"';\r\n      if ( objOptions.bodyProp.rIns || objOptions.bodyProp.rIns == 0 ) bodyProperties += ' rIns=\"' + objOptions.bodyProp.rIns + '\"';\r\n      if ( objOptions.bodyProp.tIns || objOptions.bodyProp.tIns == 0 ) bodyProperties += ' tIns=\"' + objOptions.bodyProp.tIns + '\"';\r\n\r\n      // D: Close <a:bodyPr element\r\n      bodyProperties += '>';\r\n\r\n      // E: NEW: Add autofit type tags\r\n      if ( objOptions.shrinkText ) bodyProperties += '<a:normAutofit fontScale=\"85000\" lnSpcReduction=\"20000\" />'; // MS-PPT > Format Shape > Text Options: \"Shrink text on overflow\"\r\n      // MS-PPT > Format Shape > Text Options: \"Resize shape to fit text\" [spAutoFit]\r\n      // NOTE: Use of '<a:noAutofit/>' in lieu of '' below causes issues in PPT-2013\r\n      bodyProperties += ( objOptions.bodyProp.autoFit !== false ? '<a:spAutoFit/>' : '' );\r\n\r\n      // LAST: Close bodyProp\r\n      bodyProperties += '</a:bodyPr>';\r\n    }\r\n    else {\r\n      // DEFAULT:\r\n      bodyProperties += ' wrap=\"square\" rtlCol=\"0\">';\r\n      bodyProperties += '</a:bodyPr>';\r\n    }\r\n\r\n    // LAST: Return Close bodyProp\r\n    return ( objOptions.isTableCell ? '<a:bodyPr/>' : bodyProperties );\r\n  }\r\n\r\n  function genXmlColorSelection(color_info, back_info) {\r\n    var colorVal;\r\n    var fillType = 'solid';\r\n    var internalElements = '';\r\n    var outText = '';\r\n\r\n    if ( back_info && typeof back_info === 'string' ) {\r\n      outText += '<p:bg><p:bgPr>';\r\n      outText += genXmlColorSelection( back_info.replace('#',''), false );\r\n      outText += '<a:effectLst/>';\r\n      outText += '</p:bgPr></p:bg>';\r\n    }\r\n\r\n    if ( color_info ) {\r\n      if ( typeof color_info == 'string' ) colorVal = color_info;\r\n      else {\r\n        if ( color_info.type  ) fillType = color_info.type;\r\n        if ( color_info.color ) colorVal = color_info.color;\r\n        if ( color_info.alpha ) internalElements += '<a:alpha val=\"' + (100 - color_info.alpha) + '000\"/>';\r\n      }\r\n\r\n      switch ( fillType ) {\r\n        case 'solid':\r\n          outText += '<a:solidFill>'+ createColorElement(colorVal, internalElements) + '</a:solidFill>';\r\n          break;\r\n      }\r\n    }\r\n\r\n    return outText;\r\n  }\r\n\r\n  // XML-GEN: First 6 functions create the base /ppt files\r\n\r\n  function makeXmlContTypes() {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF;\r\n    strXml += '<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">';\r\n    strXml += ' <Default Extension=\"xml\" ContentType=\"application/xml\"/>';\r\n    strXml += ' <Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\"/>';\r\n    strXml += ' <Default Extension=\"jpeg\" ContentType=\"image/jpeg\"/>';\r\n    strXml += ' <Default Extension=\"png\" ContentType=\"image/png\"/>';\r\n    strXml += ' <Default Extension=\"gif\" ContentType=\"image/gif\"/>';\r\n    strXml += ' <Default Extension=\"m4v\" ContentType=\"video/mp4\"/>'; // hard-coded as extn!=type\r\n    strXml += ' <Default Extension=\"mp4\" ContentType=\"video/mp4\"/>'; // same here, we have to add as it wont be added in loop below\r\n    gObjPptx.slides.forEach(function(slide,idx){\r\n      slide.rels.forEach(function(rel,idy){\r\n        if ( rel.type != 'image' && rel.type != 'online' && rel.type != 'chart' && rel.extn != 'm4v' && strXml.indexOf(rel.type) == -1 )\r\n          strXml += ' <Default Extension=\"'+ rel.extn +'\" ContentType=\"'+ rel.type +'\"/>';\r\n      });\r\n    });\r\n    strXml += ' <Default Extension=\"vml\" ContentType=\"application/vnd.openxmlformats-officedocument.vmlDrawing\"/>';\r\n    strXml += ' <Default Extension=\"xlsx\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"/>';\r\n\r\n    strXml += ' <Override PartName=\"/docProps/core.xml\" ContentType=\"application/vnd.openxmlformats-package.core-properties+xml\"/>';\r\n    strXml += ' <Override PartName=\"/docProps/app.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.extended-properties+xml\"/>';\r\n    strXml += ' <Override PartName=\"/ppt/presentation.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml\"/>';\r\n    strXml += ' <Override PartName=\"/ppt/presProps.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.presProps+xml\"/>';\r\n    strXml += ' <Override PartName=\"/ppt/tableStyles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml\"/>';\r\n    strXml += ' <Override PartName=\"/ppt/theme/theme1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.theme+xml\"/>';\r\n    strXml += ' <Override PartName=\"/ppt/viewProps.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.viewProps+xml\"/>';\r\n\r\n    gObjPptx.slides.forEach(function(slide, idx){\r\n      strXml += '<Override PartName=\"/ppt/slideMasters/slideMaster'+ (idx+1) +'.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml\"/>';\r\n      strXml += '<Override PartName=\"/ppt/slides/slide'            + (idx+1) +'.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.slide+xml\"/>';\r\n      // add charts if any\r\n      slide.rels.forEach(function(rel){\r\n        if ( rel.type == 'chart' ) {\r\n          strXml += ' <Override PartName=\"'+ rel.Target +'\" ContentType=\"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\"/>';\r\n        }\r\n      });\r\n    });\r\n\r\n    gObjPptx.slideLayouts.forEach(function(layout,idx) {\r\n        strXml += '<Override PartName=\"/ppt/slideLayouts/slideLayout'+ ( idx + 1 ) +'.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml\"/>';\r\n        layout.rels.forEach(function(rel){\r\n          if ( rel.type == 'chart' ) {\r\n            strXml += ' <Override PartName=\"'+ rel.Target +'\" ContentType=\"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\"/>';\r\n          }\r\n        });\r\n      });\r\n    gObjPptx.masterSlide.rels.forEach(function(rel) {\r\n        if ( rel.type == 'chart' ) {\r\n          strXml += ' <Override PartName=\"'+ rel.Target +'\" ContentType=\"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\"/>';\r\n        }\r\n        if ( rel.type != 'image' && rel.type != 'online' && rel.type != 'chart' && rel.extn != 'm4v' && strXml.indexOf(rel.type) == -1 )\r\n          strXml += ' <Default Extension=\"'+ rel.extn +'\" ContentType=\"'+ rel.type +'\"/>';\r\n      });\r\n\r\n    strXml += '</Types>';\r\n\r\n    return strXml;\r\n  }\r\n\r\n  function makeXmlRootRels() {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF\r\n          + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'\r\n          + '  <Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\" Target=\"docProps/app.xml\"/>'\r\n          + '  <Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\" Target=\"docProps/core.xml\"/>'\r\n          + '  <Relationship Id=\"rId3\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"ppt/presentation.xml\"/>'\r\n          + '</Relationships>';\r\n    return strXml;\r\n  }\r\n\r\n  function makeXmlApp() {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF;\r\n    strXml += '<Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\" xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\">';\r\n    strXml += '<TotalTime>0</TotalTime>';\r\n    strXml += '<Words>0</Words>';\r\n    strXml += '<Application>Microsoft Office PowerPoint</Application>';\r\n    strXml += '<PresentationFormat>On-screen Show</PresentationFormat>';\r\n    strXml += '<Paragraphs>0</Paragraphs>';\r\n    strXml += '<Slides>'+ gObjPptx.slides.length +'</Slides>';\r\n    strXml += '<Notes>0</Notes>';\r\n    strXml += '<HiddenSlides>0</HiddenSlides>';\r\n    strXml += '<MMClips>0</MMClips>';\r\n    strXml += '<ScaleCrop>false</ScaleCrop>';\r\n    strXml += '<HeadingPairs>';\r\n    strXml += '  <vt:vector size=\"4\" baseType=\"variant\">';\r\n    strXml += '    <vt:variant><vt:lpstr>Theme</vt:lpstr></vt:variant>';\r\n    strXml += '    <vt:variant><vt:i4>1</vt:i4></vt:variant>';\r\n    strXml += '    <vt:variant><vt:lpstr>Slide Titles</vt:lpstr></vt:variant>';\r\n    strXml += '    <vt:variant><vt:i4>'+ gObjPptx.slides.length +'</vt:i4></vt:variant>';\r\n    strXml += '  </vt:vector>';\r\n    strXml += '</HeadingPairs>';\r\n    strXml += '<TitlesOfParts>';\r\n    strXml += '<vt:vector size=\"'+ (gObjPptx.slides.length+1) +'\" baseType=\"lpstr\">';\r\n    strXml += '<vt:lpstr>Office Theme</vt:lpstr>';\r\n    $.each(gObjPptx.slides, function(idx,slideObj){ strXml += '<vt:lpstr>Slide '+ (idx+1) +'</vt:lpstr>'; });\r\n    strXml += '</vt:vector>';\r\n    strXml += '</TitlesOfParts>';\r\n    strXml += '<Company>'+gObjPptx.company+'</Company>';\r\n    strXml += '<LinksUpToDate>false</LinksUpToDate>';\r\n    strXml += '<SharedDoc>false</SharedDoc>';\r\n    strXml += '<HyperlinksChanged>false</HyperlinksChanged>';\r\n    strXml += '<AppVersion>15.0000</AppVersion>';\r\n    strXml += '</Properties>';\r\n\r\n    return strXml;\r\n  }\r\n\r\n  function makeXmlCore() {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF;\r\n    strXml += '<cp:coreProperties xmlns:cp=\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:dcterms=\"http://purl.org/dc/terms/\" xmlns:dcmitype=\"http://purl.org/dc/dcmitype/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">';\r\n    strXml += '<dc:title>'+ decodeXmlEntities(gObjPptx.title) +'</dc:title>';\r\n    strXml += '<dc:subject>'+ decodeXmlEntities(gObjPptx.subject) +'</dc:subject>';\r\n    strXml += '<dc:creator>'+ decodeXmlEntities(gObjPptx.author) +'</dc:creator>';\r\n    strXml += '<cp:lastModifiedBy>'+ decodeXmlEntities(gObjPptx.author) +'</cp:lastModifiedBy>';\r\n    strXml += '<cp:revision>'+ gObjPptx.revision +'</cp:revision>';\r\n    strXml += '<dcterms:created xsi:type=\"dcterms:W3CDTF\">'+ new Date().toISOString() +'</dcterms:created>';\r\n    strXml += '<dcterms:modified xsi:type=\"dcterms:W3CDTF\">'+ new Date().toISOString() +'</dcterms:modified>';\r\n    strXml += '</cp:coreProperties>';\r\n    return strXml;\r\n  }\r\n\r\n  function makeXmlPresentationRels() {\r\n    var intRelNum = 0;\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF;\r\n    strXml += '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">';\r\n    strXml += '  <Relationship Id=\"rId1\" Target=\"slideMasters/slideMaster1.xml\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster\"/>';\r\n    intRelNum++;\r\n    for ( var idx=1; idx<=gObjPptx.slides.length; idx++ ) {\r\n      intRelNum++;\r\n      strXml += '  <Relationship Id=\"rId'+ intRelNum +'\" Target=\"slides/slide'+ idx +'.xml\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide\"/>';\r\n    }\r\n    intRelNum++;\r\n    strXml += '  <Relationship Id=\"rId'+  intRelNum    +'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/presProps\" Target=\"presProps.xml\"/>'\r\n        + '  <Relationship Id=\"rId'+ (intRelNum+1) +'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/viewProps\" Target=\"viewProps.xml\"/>'\r\n        + '  <Relationship Id=\"rId'+ (intRelNum+2) +'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\" Target=\"theme/theme1.xml\"/>'\r\n        + '  <Relationship Id=\"rId'+ (intRelNum+3) +'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles\" Target=\"tableStyles.xml\"/>'\r\n        + '</Relationships>';\r\n\r\n    return strXml;\r\n  }\r\n\r\n  // XML-GEN: Next 5 functions run 1-N times (once for each Slide)\r\n\r\n  /**\r\n   * Generates the XML slide resource from a Slide object\r\n   * @param {Object} inSlide - The slide object to transform into XML\r\n   * @return {string} strSlideXml - Slide OOXML\r\n  */\r\n  function makeXmlSlide(inSlide) {\r\n    // STEP 1: Generate slide XML - wrap generated text in full XML envelope\r\n    var strSlideXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF;\r\n    strSlideXml += '<p:sld xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\">';\r\n    strSlideXml += gObjPptxGenerators.slideObjectToXml(inSlide);\r\n    strSlideXml += '<p:clrMapOvr><a:masterClrMapping/></p:clrMapOvr>';\r\n    strSlideXml += '</p:sld>';\r\n\r\n    // LAST: Return\r\n    return strSlideXml;\r\n  }\r\n\r\n  /**\r\n   * Generates the XML layout resource from a layout object\r\n   * @param {Object} slideLayoutObject slide object that represents layout\r\n   * @return {String} complete XML string ready to be saved as a file\r\n  */\r\n  function makeXmlLayout(slideLayoutObject) {\r\n    var strXml =  '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + CRLF;\r\n      strXml += '<p:sldLayout xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\" preserve=\"1\" userDrawn=\"1\">';\r\n      strXml += gObjPptxGenerators.slideObjectToXml(slideLayoutObject);\r\n      strXml += '<p:clrMapOvr><a:masterClrMapping/></p:clrMapOvr>';\r\n      strXml += '</p:sldLayout>';\r\n    return strXml;\r\n  }\r\n\r\n  /**\r\n   * Generates XML for the master file..\r\n   * @param {Object} slideObject slide object that represents master slide layout\r\n   * @return {String} complete XML string ready to be saved as a file\r\n  */\r\n  function makeXmlMaster(slideObject) {\r\n    var strSlideXml = gObjPptxGenerators.slideObjectToXml(slideObject);\r\n\r\n    // NOTE: Pass layouts as static rels because they are not referrenced any time\r\n    var layoutDefs = gObjPptx.slideLayouts.map(function(layoutDef,idx){\r\n      return '<p:sldLayoutId id=\"' + (LAYOUT_IDX_SERIES_BASE + idx) + '\" r:id=\"rId' + (slideObject.rels.length + idx + 1) + '\" />';\r\n    });\r\n\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + CRLF;\r\n    strXml += '<p:sldMaster xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\">';\r\n    strXml += strSlideXml;\r\n    strXml += '<p:clrMap bg1=\"lt1\" tx1=\"dk1\" bg2=\"lt2\" tx2=\"dk2\" accent1=\"accent1\" accent2=\"accent2\" accent3=\"accent3\" accent4=\"accent4\" accent5=\"accent5\" accent6=\"accent6\" hlink=\"hlink\" folHlink=\"folHlink\" />'\r\n    strXml += '<p:sldLayoutIdLst>' + layoutDefs.join('') + '</p:sldLayoutIdLst>';\r\n    strXml += '<p:hf sldNum=\"0\" hdr=\"0\" ftr=\"0\" dt=\"0\" />';\r\n    strXml += '<p:txStyles>'\r\n      + ' <p:titleStyle>'\r\n      + '  <a:lvl1pPr algn=\"ctr\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"0\"/></a:spcBef><a:buNone/><a:defRPr sz=\"4400\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mj-lt\"/><a:ea typeface=\"+mj-ea\"/><a:cs typeface=\"+mj-cs\"/></a:defRPr></a:lvl1pPr>'\r\n      + ' </p:titleStyle>'\r\n      + ' <p:bodyStyle>'\r\n      + '  <a:lvl1pPr marL=\"342900\" indent=\"-342900\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"3200\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl1pPr>'\r\n      + '  <a:lvl2pPr marL=\"742950\" indent=\"-285750\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl2pPr>'\r\n      + '  <a:lvl3pPr marL=\"1143000\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2400\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl3pPr>'\r\n      + '  <a:lvl4pPr marL=\"1600200\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl4pPr>'\r\n      + '  <a:lvl5pPr marL=\"2057400\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl5pPr>'\r\n      + '  <a:lvl6pPr marL=\"2514600\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl6pPr>'\r\n      + '  <a:lvl7pPr marL=\"2971800\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl7pPr>'\r\n      + '  <a:lvl8pPr marL=\"3429000\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl8pPr>'\r\n      + '  <a:lvl9pPr marL=\"3886200\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl9pPr>'\r\n      + ' </p:bodyStyle>'\r\n      + ' <p:otherStyle>'\r\n      + '  <a:defPPr><a:defRPr lang=\"en-US\"/></a:defPPr>'\r\n      + '  <a:lvl1pPr marL=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl1pPr>'\r\n      + '  <a:lvl2pPr marL=\"457200\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl2pPr>'\r\n      + '  <a:lvl3pPr marL=\"914400\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl3pPr>'\r\n      + '  <a:lvl4pPr marL=\"1371600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl4pPr>'\r\n      + '  <a:lvl5pPr marL=\"1828800\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl5pPr>'\r\n      + '  <a:lvl6pPr marL=\"2286000\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl6pPr>'\r\n      + '  <a:lvl7pPr marL=\"2743200\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl7pPr>'\r\n      + '  <a:lvl8pPr marL=\"3200400\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl8pPr>'\r\n      + '  <a:lvl9pPr marL=\"3657600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl9pPr>'\r\n      + ' </p:otherStyle>'\r\n      + '</p:txStyles>'\r\n    strXml += '</p:sldMaster>';\r\n    return strXml;\r\n  }\r\n\r\n  /**\r\n   * Generates XML string for a slide layout relation file.\r\n   * @param {Number} layoutNumber 1-indexed number of a layout that relations are generated for\r\n   * @return {String} complete XML string ready to be saved as a file\r\n   */\r\n  function makeXmlSlideLayoutRel(layoutNumber) {\r\n    return gObjPptxGenerators.slideObjectRelationsToXml(\r\n      gObjPptx.slideLayouts[layoutNumber - 1],\r\n      [{\r\n        target:\"../slideMasters/slideMaster1.xml\", type:\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster\"\r\n      }]\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Generates XML string for a slide relation file.\r\n   * @param {Number} slideNumber 1-indexed number of a layout that relations are generated for\r\n   * @return {String} complete XML string ready to be saved as a file\r\n   */\r\n  function makeXmlSlideRel(slideNumber) {\r\n    return gObjPptxGenerators.slideObjectRelationsToXml(\r\n      gObjPptx.slides[slideNumber - 1],\r\n      [{\r\n        target: '../slideLayouts/slideLayout'+ getLayoutIdxForSlide(slideNumber) +'.xml',\r\n        type: \"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout\"\r\n      }]\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Generates XML string for the master file.\r\n   * @param {Object} masterSlideObject slide object\r\n   * @return {String} complete XML string ready to be saved as a file\r\n   */\r\n  function makeXmlMasterRel(masterSlideObject) {\r\n    var relCount = masterSlideObject.rels.length\r\n    var defaultRels = gObjPptx.slideLayouts.map(function(layoutDef, idx) {\r\n      return { target: '../slideLayouts/slideLayout'+ (idx + 1) +'.xml', type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout' };\r\n    });\r\n    defaultRels.push({ target: '../theme/theme1.xml', type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme' });\r\n\r\n    return gObjPptxGenerators.slideObjectRelationsToXml(\r\n      masterSlideObject,\r\n      defaultRels\r\n    );\r\n  }\r\n\r\n  /**\r\n   * For the passed slide number, resolves name of a layout that is used for.\r\n   * @param {Number} slideNumber\r\n   * @return {Number} slide number\r\n   */\r\n  function getLayoutIdxForSlide(slideNumber) {\r\n    var layoutName = gObjPptx.slides[slideNumber - 1].layout;\r\n    var layoutIdx = -1;\r\n\r\n    for (var i=0; i<gObjPptx.slideLayouts.length; i++) {\r\n      if (gObjPptx.slideLayouts[i].name === layoutName) {\r\n        return (i + 1);\r\n      }\r\n    }\r\n\r\n    // IMPORTANT: Return 1 (for `slideLayout1.xml`) as lack of a def means legacy (deprecated) master was used\r\n    // meaning all of its objects are in Layout1 and every slide that references it uses this layout.\r\n    return 1;\r\n  }\r\n\r\n  // XML-GEN: Last 5 functions create root /ppt files\r\n\r\n  function makeXmlTheme() {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF;\r\n    strXml += '<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" name=\"Office Theme\">\\\r\n            <a:themeElements>\\\r\n              <a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1>\\\r\n              <a:dk2><a:srgbClr val=\"A7A7A7\"/></a:dk2>\\\r\n              <a:lt2><a:srgbClr val=\"535353\"/></a:lt2><a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1><a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2><a:accent3>\\\r\n              <a:srgbClr val=\"9BBB59\"/></a:accent3><a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4><a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5>\\\r\n              <a:accent6><a:srgbClr val=\"F79646\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Arial\"/><a:ea typeface=\"Arial\"/><a:cs typeface=\"Arial\"/><a:font script=\"Jpan\" typeface=\"MS P????\"/><a:font script=\"Hang\" typeface=\"?? ??\"/><a:font script=\"Hans\" typeface=\"??\"/><a:font script=\"Hant\" typeface=\"????\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Angsana New\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/></a:majorFont><a:minorFont><a:latin typeface=\"Arial\"/><a:ea typeface=\"Arial\"/><a:cs typeface=\"Arial\"/><a:font script=\"Jpan\" typeface=\"MS P????\"/><a:font script=\"Hang\" typeface=\"?? ??\"/><a:font script=\"Hans\" typeface=\"??\"/><a:font script=\"Hant\" typeface=\"????\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Cordia New\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>\\\r\n              </a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"1\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:shade val=\"51000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"80000\"><a:schemeClr val=\"phClr\"><a:shade val=\"93000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"94000\"/><a:satMod val=\"135000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/>\\\r\n            </a:theme>';\r\n    return strXml;\r\n  }\r\n\r\n  function makeXmlPresentation() {\r\n    var intCurPos = 0;\r\n    // REF: http://www.datypic.com/sc/ooxml/t-p_CT_Presentation.html\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF\r\n      + '<p:presentation xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" '\r\n      + 'xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" '\r\n      + 'xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\" '+ (gObjPptx.rtlMode ? 'rtl=\"1\"' : '') +' saveSubsetFonts=\"1\">';\r\n\r\n    // STEP 1: Build SLIDE master list\r\n    strXml += '<p:sldMasterIdLst><p:sldMasterId id=\"2147483648\" r:id=\"rId1\"/></p:sldMasterIdLst>';\r\n    strXml += '<p:sldIdLst>';\r\n    for ( var idx=0; idx<gObjPptx.slides.length; idx++ ) {\r\n      strXml += '<p:sldId id=\"' + (idx + 256) + '\" r:id=\"rId' + (idx + 2) + '\"/>';\r\n    }\r\n    strXml += '</p:sldIdLst>';\r\n\r\n    // STEP 2: Build SLIDE text styles\r\n    strXml += '<p:sldSz cx=\"'+ gObjPptx.pptLayout.width +'\" cy=\"'+ gObjPptx.pptLayout.height +'\" type=\"'+ gObjPptx.pptLayout.name +'\"/>'\r\n        + '<p:notesSz cx=\"'+ gObjPptx.pptLayout.height +'\" cy=\"' + gObjPptx.pptLayout.width + '\"/>'\r\n        + '<p:defaultTextStyle>';\r\n        + '  <a:defPPr><a:defRPr lang=\"en-US\"/></a:defPPr>';\r\n    for ( var idx=1; idx<10; idx++ ) {\r\n      strXml += '  <a:lvl' + idx + 'pPr marL=\"' + intCurPos + '\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\">'\r\n          + '    <a:defRPr sz=\"1800\" kern=\"1200\">'\r\n          + '      <a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill>'\r\n          + '      <a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/>'\r\n          + '    </a:defRPr>'\r\n          + '  </a:lvl' + idx + 'pPr>';\r\n      intCurPos += 457200;\r\n    }\r\n    strXml += '</p:defaultTextStyle>';\r\n\r\n    strXml += '<p:extLst><p:ext uri=\"{EFAFB233-063F-42B5-8137-9DF3F51BA10A}\"><p15:sldGuideLst xmlns:p15=\"http://schemas.microsoft.com/office/powerpoint/2012/main\"/></p:ext></p:extLst>'\r\n        + '</p:presentation>';\r\n\r\n    return strXml;\r\n  }\r\n\r\n  function makeXmlPresProps() {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF\r\n          + '<p:presentationPr xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\">'\r\n          + '  <p:extLst>'\r\n          + '    <p:ext uri=\"{E76CE94A-603C-4142-B9EB-6D1370010A27}\"><p14:discardImageEditData xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"0\"/></p:ext>'\r\n          + '    <p:ext uri=\"{D31A062A-798A-4329-ABDD-BBA856620510}\"><p14:defaultImageDpi xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"220\"/></p:ext>'\r\n          + '    <p:ext uri=\"{FD5EFAAD-0ECE-453E-9831-46B23BE46B34}\"><p15:chartTrackingRefBased xmlns:p15=\"http://schemas.microsoft.com/office/powerpoint/2012/main\" val=\"1\"/></p:ext>'\r\n          + '  </p:extLst>'\r\n          + '</p:presentationPr>';\r\n    return strXml;\r\n  }\r\n\r\n  function makeXmlTableStyles() {\r\n    // SEE: http://openxmldeveloper.org/discussions/formats/f/13/p/2398/8107.aspx\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF\r\n          + '<a:tblStyleLst xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" def=\"{5C22544A-7EE6-4342-B048-85BDC9FD1C3A}\"/>';\r\n    return strXml;\r\n  }\r\n\r\n  function makeXmlViewProps() {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF\r\n          + '<p:viewPr xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\">'\r\n          + '<p:normalViewPr><p:restoredLeft sz=\"15620\"/><p:restoredTop sz=\"94660\"/></p:normalViewPr>'\r\n          + '<p:slideViewPr>'\r\n          + '  <p:cSldViewPr>'\r\n          + '    <p:cViewPr varScale=\"1\"><p:scale><a:sx n=\"64\" d=\"100\"/><a:sy n=\"64\" d=\"100\"/></p:scale><p:origin x=\"-1392\" y=\"-96\"/></p:cViewPr>'\r\n          + '    <p:guideLst><p:guide orient=\"horz\" pos=\"2160\"/><p:guide pos=\"2880\"/></p:guideLst>'\r\n          + '  </p:cSldViewPr>'\r\n          + '</p:slideViewPr>'\r\n          + '<p:notesTextViewPr>'\r\n          + '  <p:cViewPr><p:scale><a:sx n=\"100\" d=\"100\"/><a:sy n=\"100\" d=\"100\"/></p:scale><p:origin x=\"0\" y=\"0\"/></p:cViewPr>'\r\n          + '</p:notesTextViewPr>'\r\n          + '<p:gridSpacing cx=\"78028800\" cy=\"78028800\"/>'\r\n          + '</p:viewPr>';\r\n    return strXml;\r\n  }\r\n\r\n  /* ===============================================================================================\r\n  |\r\n  ######                                             #     ######   ###\r\n  #     #  #    #  #####   #       #   ####         # #    #     #   #\r\n  #     #  #    #  #    #  #       #  #    #       #   #   #     #   #\r\n  ######   #    #  #####   #       #  #           #     #  ######    #\r\n  #        #    #  #    #  #       #  #           #######  #         #\r\n  #        #    #  #    #  #       #  #    #      #     #  #         #\r\n  #         ####   #####   ######  #   ####       #     #  #        ###\r\n  |\r\n  ==================================================================================================\r\n  */\r\n\r\n  /**\r\n   * Expose a couple private helper functions from above\r\n   */\r\n  this.inch2Emu = inch2Emu;\r\n  this.rgbToHex = rgbToHex;\r\n\r\n  /**\r\n   * Gets the version of this library\r\n   */\r\n  this.getVersion = function getVersion() {\r\n    return APP_VER +'.'+ APP_REL;\r\n  };\r\n\r\n  /**\r\n   * Gets the Presentation's Slide Layout {object} from `LAYOUTS`\r\n   */\r\n  this.getLayout = function getLayout() {\r\n    return gObjPptx.pptLayout;\r\n  };\r\n\r\n  /**\r\n   * Set Right-to-Left (RTL) mode for users whose language requires this setting\r\n   */\r\n  this.setRTL = function setRTL(inBool) {\r\n    if ( typeof inBool !== 'boolean' ) return;\r\n    else {\r\n      gObjPptx.rtlMode = inBool;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Sets the Presentation's Slide Layout {object}: [screen4x3, screen16x9, widescreen]\r\n   * @see https://support.office.com/en-us/article/Change-the-size-of-your-slides-040a811c-be43-40b9-8d04-0de5ed79987e\r\n   * @param {string} inLayout - a const name from LAYOUTS variable\r\n   * @param {object} inLayout - an object with user-defined w/h\r\n   */\r\n  this.setLayout = function setLayout(inLayout) {\r\n    // Allow custom slide size (inches) [ISSUE #29]\r\n    if ( typeof inLayout === 'object' && inLayout.width && inLayout.height ) {\r\n      LAYOUTS['LAYOUT_USER'].width  = Math.round(Number(inLayout.width ) * EMU);\r\n      LAYOUTS['LAYOUT_USER'].height = Math.round(Number(inLayout.height) * EMU);\r\n\r\n      gObjPptx.pptLayout = LAYOUTS['LAYOUT_USER'];\r\n    }\r\n    else if ( $.inArray(inLayout, Object.keys(LAYOUTS)) > -1 ) {\r\n      gObjPptx.pptLayout = LAYOUTS[inLayout];\r\n    }\r\n    else {\r\n      try { console.warn('UNKNOWN LAYOUT! Valid values = ' + Object.keys(LAYOUTS)); } catch(ex){}\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Sets the Presentation's Title\r\n   */\r\n  this.setTitle = function setTitle(inStrTitle) {\r\n    gObjPptx.title = inStrTitle || 'PptxGenJS Presentation';\r\n  };\r\n\r\n  /**\r\n   * Sets the Presentation's Author\r\n   */\r\n  this.setAuthor = function setAuthor(inStrAuthor) {\r\n    gObjPptx.author = inStrAuthor || 'PptxGenJS';\r\n  };\r\n\r\n  /**\r\n   * DESC: Sets the Presentation's Revision\r\n   * NOTE: PowerPoint requires `revision` be: number only (without \".\" or \",\") otherwise, PPT will throw errors upon opening Presentation.\r\n   */\r\n  this.setRevision = function setRevision(inStrRevision) {\r\n    gObjPptx.revision = inStrRevision || '1';\r\n    gObjPptx.revision = gObjPptx.revision.replace(/[\\.\\,\\-]+/gi,'');\r\n    if ( isNaN(gObjPptx.revision) ) gObjPptx.revision = '1';\r\n  };\r\n\r\n  /**\r\n   * Sets the Presentation's Subject\r\n   */\r\n  this.setSubject = function setSubject(inStrSubject) {\r\n    gObjPptx.subject = inStrSubject || 'PptxGenJS Presentation';\r\n  };\r\n\r\n  /**\r\n   * Sets the Presentation's Company\r\n   */\r\n  this.setCompany = function setCompany(inStrCompany) {\r\n    gObjPptx.company = inStrCompany || 'PptxGenJS';\r\n  };\r\n\r\n  /**\r\n   * Export the Presentation to an .pptx file\r\n   * @param {string} [inStrExportName] - Filename to use for the export\r\n   */\r\n  this.save = function save(inStrExportName, funcCallback, outputType) {\r\n    var intRels = 0, arrRelsDone = [];\r\n\r\n    // STEP 1: Set export properties\r\n    if ( funcCallback ) gObjPptx.saveCallback = funcCallback;\r\n    if ( inStrExportName ) gObjPptx.fileName = inStrExportName;\r\n\r\n    // STEP 2: Read/Encode Images\r\n    // PERF: Only send unique paths for encoding (encoding func will find and fill *ALL* matching paths across the Presentation)\r\n\r\n    // A: Slide rels\r\n    gObjPptx.slides.forEach(function(slide,idx){ intRels += encodeImageRelations(slide, arrRelsDone); });\r\n\r\n    // B: Layout rels\r\n    gObjPptx.slideLayouts.forEach(function(layout,idx){ intRels += encodeImageRelations(layout, arrRelsDone); });\r\n\r\n    // C: Master Slide rels\r\n    intRels += encodeImageRelations(gObjPptx.masterSlide, arrRelsDone);\r\n\r\n    // STEP 3: Export now if there's no images to encode (otherwise, last async imgConvert call above will call exportFile)\r\n    if ( intRels == 0 ) doExportPresentation(outputType);\r\n  };\r\n\r\n  /**\r\n   * Add a new Slide to the Presentation\r\n   * @returns {Object[]} slideObj - The new Slide object\r\n   */\r\n  this.addNewSlide = function addNewSlide(inMaster, inMasterOpts) {\r\n    // DEPRECATED: moving to only `inMaster` soon (deprecated in 1.8.0)\r\n    var inMasterOpts = ( inMasterOpts && typeof inMasterOpts === 'object' ? inMasterOpts : {} );\r\n    var slideObj = {};\r\n    var slideNum = gObjPptx.slides.length;\r\n    var slideObjNum = 0;\r\n    var pageNum  = (slideNum + 1);\r\n\r\n    // A: Add this SLIDE to PRESENTATION, Add default values as well\r\n    gObjPptx.slides[slideNum] = {\r\n      slide: slideObj,\r\n      name: 'Slide ' + pageNum,\r\n      numb: pageNum,\r\n      data: [],\r\n      rels: [],\r\n      slideNumberObj: null,\r\n      hasSlideNumber: false,\r\n      layout: inMaster || '[ default ]'\r\n    };\r\n\r\n    // ==========================================================================\r\n    // PUBLIC METHODS:\r\n    // ==========================================================================\r\n\r\n    slideObj.getPageNumber = function() {\r\n      return pageNum;\r\n    };\r\n\r\n    // WARN: DEPRECATED: (leaves in 1.5 or 2.0 at latest)\r\n    slideObj.hasSlideNumber = function( inBool ) {\r\n      if ( inBool ) gObjPptx.slides[slideNum].hasSlideNumber = inBool;\r\n      else return gObjPptx.slides[slideNum].hasSlideNumber;\r\n    };\r\n    slideObj.slideNumber = function( inObj ) {\r\n      if ( inObj && typeof inObj === 'object' ) gObjPptx.slides[slideNum].slideNumberObj = inObj;\r\n      else return gObjPptx.slides[slideNum].slideNumberObj;\r\n    };\r\n\r\n    /**\r\n     * Generate the chart based on input data.\r\n     *\r\n     * OOXML Chart Spec: ISO/IEC 29500-1:2016(E)\r\n     *\r\n     * @param {object} renderType should belong to: 'column', 'pie'\r\n     * @param {object} data a JSON object with follow the following format\r\n     * {\r\n     *   title: 'eSurvey chart',\r\n     *   data: [\r\n     *    {\r\n     *      name: 'Income',\r\n     *      labels: ['2005', '2006', '2007', '2008', '2009'],\r\n     *      values: [23.5, 26.2, 30.1, 29.5, 24.6]\r\n     *    },\r\n     *    {\r\n     *      name: 'Expense',\r\n     *      labels: ['2005', '2006', '2007', '2008', '2009'],\r\n     *      values: [18.1, 22.8, 23.9, 25.1, 25]\r\n     *    }\r\n     *   ]\r\n     * }\r\n     */\r\n    slideObj.addChart = function ( type, data, opt ) {\r\n      gObjPptxGenerators.addChartDefinition(type, data, opt, gObjPptx.slides[slideNum]);\r\n      return this;\r\n    }\r\n\r\n    // WARN: DEPRECATED: Will soon take a single {object} as argument (per current docs 20161120)\r\n    // FUTURE: slideObj.addImage = function(opt){\r\n    // NOTE: Remote images (eg: \"http://whatev.com/blah\"/from web and/or remote server arent supported yet - we'd need to create an <img>, load it, then send to canvas: https://stackoverflow.com/questions/164181/how-to-fetch-a-remote-image-to-display-in-a-canvas)\r\n    slideObj.addImage = function( strImagePath, intPosX, intPosY, intSizeX, intSizeY, strImageData ) {\r\n      if (intPosX === undefined && typeof(strImagePath) === \"object\") {\r\n        intPosX = gObjPptx.slides[slideNum];\r\n      }\r\n      gObjPptxGenerators.addImageDefinition(strImagePath, intPosX || gObjPptx.slides[slideNum], intPosY, intSizeX, intSizeY, strImageData, gObjPptx.slides[slideNum]);\r\n      return this;\r\n    };\r\n\r\n    slideObj.addMedia = function( opt ) {\r\n      var intRels  = 1;\r\n      var intPosX  = (opt.x || 0);\r\n      var intPosY  = (opt.y || 0);\r\n      var intSizeX = (opt.w || 2);\r\n      var intSizeY = (opt.h || 2);\r\n      var strData  = (opt.data || '');\r\n      var strLink  = (opt.link || '');\r\n      var strPath  = (opt.path || '');\r\n      var strType  = (opt.type || \"audio\");\r\n      var strExtn  = \"mp3\";\r\n\r\n      // STEP 1: REALITY-CHECK\r\n      if ( !strPath && !strData && strType != 'online' ) {\r\n        console.error(\"ERROR: `addMedia()` requires either 'data' or 'path' values!\");\r\n        return null;\r\n      }\r\n      else if ( strData && strData.toLowerCase().indexOf('base64,') == -1 ) {\r\n        console.error(\"ERROR: Media `data` value lacks a base64 header! Ex: 'video/mpeg;base64,NMP[...]')\");\r\n        return null;\r\n      }\r\n      // Online Video: requires `link`\r\n      if ( strType == 'online' && !strLink ) {\r\n        console.error('ERROR: online videos require `link` value')\r\n        return null;\r\n      }\r\n      // Client-Browser: Cant base64 anything except png basically!\r\n      if ( typeof window !== 'undefined' && window.location.href.indexOf('file:') == 0 && !strData && strType != 'online' ) {\r\n        console.error('ERROR: Client browsers cannot encode media - use pre-encoded base64 `data` or use Node.js')\r\n        return null;\r\n      }\r\n\r\n      // STEP 2: Set vars for this Slide\r\n      var slideObjNum = gObjPptx.slides[slideNum].data.length;\r\n      var slideObjRels = gObjPptx.slides[slideNum].rels;\r\n\r\n      strType = ( strData ? strData.split(';')[0].split('/')[0] : strType );\r\n      strExtn = ( strData ? strData.split(';')[0].split('/')[1] : strPath.split('.').pop() );\r\n\r\n      gObjPptx.slides[slideNum].data[slideObjNum]       = {};\r\n      gObjPptx.slides[slideNum].data[slideObjNum].type  = 'media';\r\n      gObjPptx.slides[slideNum].data[slideObjNum].mtype = strType;\r\n      gObjPptx.slides[slideNum].data[slideObjNum].media = (strPath || 'preencoded.mov');\r\n\r\n      // STEP 3: Set media properties & options\r\n      gObjPptx.slides[slideNum].data[slideObjNum].options    = {};\r\n      gObjPptx.slides[slideNum].data[slideObjNum].options.x  = intPosX;\r\n      gObjPptx.slides[slideNum].data[slideObjNum].options.y  = intPosY;\r\n      gObjPptx.slides[slideNum].data[slideObjNum].options.cx = intSizeX;\r\n      gObjPptx.slides[slideNum].data[slideObjNum].options.cy = intSizeY;\r\n\r\n      // STEP 4: Add this media to this Slide Rels (rId/rels count spans all slides! Count all media to get next rId)\r\n      // NOTE: rId starts at 2 (hence the intRels+1 below) as slideLayout.xml is rId=1!\r\n      $.each(gObjPptx.slides, function(i,slide){ intRels += slide.rels.length; });\r\n\r\n      if ( strType == 'online' ) {\r\n        slideObjRels.push({\r\n          path: (strPath || 'preencoded'+strExtn),\r\n          type: 'online',\r\n          extn: strExtn,\r\n          data: 'dummy',\r\n          rId:  (intRels+1),\r\n          Target: strLink\r\n        });\r\n        gObjPptx.slides[slideNum].data[slideObjNum].mediaRid = slideObjRels[slideObjRels.length-1].rId;\r\n        // Add preview/overlay image\r\n        slideObjRels.push({\r\n          data: IMG_PLAYBTN,\r\n          path: 'preencoded.png',\r\n          type: 'image/png',\r\n          extn: 'png',\r\n          rId:  (intRels+2),\r\n          Target: '../media/image' + intRels + '.png'\r\n        });\r\n      }\r\n      else {\r\n        // Audio/Video files consume *TWO* rId's:\r\n        // <Relationship Id=\"rId2\" Target=\"../media/media1.mov\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/video\"/>\r\n        // <Relationship Id=\"rId3\" Target=\"../media/media1.mov\" Type=\"http://schemas.microsoft.com/office/2007/relationships/media\"/>\r\n        slideObjRels.push({\r\n          path: (strPath || 'preencoded'+strExtn),\r\n          type: strType+'/'+strExtn,\r\n          extn: strExtn,\r\n          data: (strData || ''),\r\n          rId:  (intRels+1),\r\n          Target: '../media/media' + intRels + '.' + strExtn\r\n        });\r\n        gObjPptx.slides[slideNum].data[slideObjNum].mediaRid = slideObjRels[slideObjRels.length-1].rId;\r\n        slideObjRels.push({\r\n          path: (strPath || 'preencoded'+strExtn),\r\n          type: strType+'/'+strExtn,\r\n          extn: strExtn,\r\n          data: (strData || ''),\r\n          rId:  (intRels+2),\r\n          Target: '../media/media' + intRels + '.' + strExtn\r\n        });\r\n        // Add preview/overlay image\r\n        slideObjRels.push({\r\n          data: IMG_PLAYBTN,\r\n          path: 'preencoded.png',\r\n          type: 'image/png',\r\n          extn: 'png',\r\n          rId:  (intRels+3),\r\n          Target: '../media/image' + intRels + '.png'\r\n        });\r\n      }\r\n\r\n      // LAST: Return this Slide\r\n      return this;\r\n    }\r\n\r\n    slideObj.addShape = function( shape, opt ) {\r\n      gObjPptxGenerators.addShapeDefinition(shape, opt, gObjPptx.slides[slideNum]);\r\n      return this;\r\n    };\r\n\r\n    // RECURSIVE: (sometimes)\r\n    // WARN: DEPRECATED: Will soon combine 2nd and 3rd arguments into single {object} (20161216-v1.1.2) (1.5 or 2.0 at the latest)\r\n    // FUTURE: slideObj.addTable = function(arrTabRows, inOpt){\r\n    // TODO: Move to gObjPptxGenerators\r\n    // TODO: dont forget to update \"this.color\" to \"target.slide.color\" !!!\r\n    slideObj.addTable = function( arrTabRows, inOpt, tabOpt ) {\r\n      var opt = ( inOpt && typeof inOpt === 'object' ? inOpt : {} );\r\n      for (var attr in tabOpt) { opt[attr] = tabOpt[attr]; } // FIXME: DEPRECATED: merge opts for now for non-breaking fix (20161216)\r\n\r\n      // STEP 1: REALITY-CHECK\r\n      if ( arrTabRows == null || arrTabRows.length == 0 || !Array.isArray(arrTabRows) ) {\r\n        try { console.warn('[warn] addTable: Array expected! USAGE: slide.addTable( [rows], {options} );'); } catch(ex){}\r\n        return null;\r\n      }\r\n\r\n      // STEP 2: Row setup: Handle case where user passed in a simple 1-row array. EX: `[\"cell 1\", \"cell 2\"]`\r\n      //var arrRows = $.extend(true,[],arrTabRows);\r\n      //if ( !Array.isArray(arrRows[0]) ) arrRows = [ $.extend(true,[],arrTabRows) ];\r\n      var arrRows = arrTabRows;\r\n      if ( !Array.isArray(arrRows[0]) ) arrRows = [ arrTabRows ];\r\n\r\n      // STEP 3: Set options\r\n      opt.x          = getSmartParseNumber( (opt.x || (EMU/2)), 'X' );\r\n      opt.y          = getSmartParseNumber( (opt.y || EMU), 'Y' );\r\n      opt.cy         = opt.h || opt.cy; // NOTE: Dont set default `cy` - leaving it null triggers auto-rowH in `makeXMLSlide()`\r\n      if ( opt.cy ) opt.cy = getSmartParseNumber( opt.cy, 'Y' );\r\n      opt.h          = opt.cy;\r\n      opt.autoPage   = ( opt.autoPage == false ? false : true );\r\n      opt.font_size  = opt.font_size || DEF_FONT_SIZE;\r\n      opt.lineWeight = ( typeof opt.lineWeight !== 'undefined' && !isNaN(Number(opt.lineWeight)) ? Number(opt.lineWeight) : 0 );\r\n      opt.margin     = (opt.marginPt || opt.margin); // (Legacy Support/DEPRECATED)\r\n      opt.margin     = (opt.margin == 0 || opt.margin ? opt.margin : DEF_CELL_MARGIN_PT);\r\n      if ( !isNaN(opt.margin) ) opt.margin = [Number(opt.margin), Number(opt.margin), Number(opt.margin), Number(opt.margin)]\r\n      if ( opt.lineWeight > 1 ) opt.lineWeight = 1;\r\n      else if ( opt.lineWeight < -1 ) opt.lineWeight = -1;\r\n      // Set default color if needed (table option > inherit from Slide > default to black)\r\n      if ( !opt.color ) opt.color = opt.color || this.color || DEF_FONT_COLOR;\r\n\r\n      // Set/Calc table width\r\n      // Get slide margins - start with default values, then adjust if master or slide margins exist\r\n      var arrTableMargin = DEF_SLIDE_MARGIN_IN;\r\n      // Case 1: Master margins\r\n      if ( inMaster && typeof inMaster.margin !== 'undefined' ) {\r\n        if ( Array.isArray(inMaster.margin) ) arrTableMargin = inMaster.margin;\r\n        else if ( !isNaN(Number(inMaster.margin)) ) arrTableMargin = [Number(inMaster.margin), Number(inMaster.margin), Number(inMaster.margin), Number(inMaster.margin)];\r\n      }\r\n      // Case 2: Table margins\r\n      /* FIXME: add `margin` option to slide options\r\n        else if ( slideObj.margin ) {\r\n          if ( Array.isArray(slideObj.margin) ) arrTableMargin = slideObj.margin;\r\n          else if ( !isNaN(Number(slideObj.margin)) ) arrTableMargin = [Number(slideObj.margin), Number(slideObj.margin), Number(slideObj.margin), Number(slideObj.margin)];\r\n        }\r\n      */\r\n\r\n      // Calc table width depending upon what data we have - several scenarios exist (including bad data, eg: colW doesnt match col count)\r\n      if ( opt.w || opt.cx ) {\r\n        opt.cx = getSmartParseNumber( (opt.w || opt.cx), 'X' );\r\n        opt.w = opt.cx;\r\n      }\r\n      else if ( opt.colW ) {\r\n        if ( typeof opt.colW === 'string' || typeof opt.colW === 'number' ) {\r\n          opt.cx = Math.floor(Number(opt.colW) * arrRows[0].length);\r\n          opt.w = opt.cx;\r\n        }\r\n        else if ( opt.colW && Array.isArray(opt.colW) && opt.colW.length != arrRows[0].length ) {\r\n          console.warn('addTable: colW.length != data.length! Defaulting to evenly distributed col widths.');\r\n\r\n          var numColWidth = Math.floor( ( (gObjPptx.pptLayout.width/EMU) - arrTableMargin[1] - arrTableMargin[3] ) / arrRows[0].length );\r\n          opt.colW = [];\r\n          for (var idx=0; idx<arrRows[0].length; idx++) { opt.colW.push( numColWidth ); }\r\n          opt.cx = Math.floor(numColWidth * arrRows[0].length);\r\n          opt.w = opt.cx;\r\n        }\r\n      }\r\n      else {\r\n        var numTabWidth = ( (gObjPptx.pptLayout.width/EMU) - arrTableMargin[1] - arrTableMargin[3] );\r\n        opt.cx = Math.floor(numTabWidth);\r\n        opt.w = opt.cx;\r\n      }\r\n\r\n      // STEP 4: Convert units to EMU now (we use different logic in makeSlide->table - smartCalc is not used)\r\n      if ( opt.x            < 20 ) opt.x  = inch2Emu(opt.x);\r\n      if ( opt.y            < 20 ) opt.y  = inch2Emu(opt.y);\r\n      if ( opt.cx           < 20 ) opt.cx = inch2Emu(opt.cx);\r\n      if ( opt.cy && opt.cy < 20 ) opt.cy = inch2Emu(opt.cy);\r\n\r\n      // STEP 5: Check for fine-grained formatting, disable auto-page when found\r\n      // Since genXmlTextBody already checks for text array ( text:[{},..{}] ) we're done!\r\n      // Text in individual cells will be formatted as they are added by calls to genXmlTextBody within table builder\r\n      arrRows.forEach(function(row,rIdx){\r\n        row.forEach(function(cell,cIdx){\r\n          if ( cell && cell.text && Array.isArray(cell.text) ) opt.autoPage = false;\r\n        });\r\n      });\r\n\r\n      // STEP 6: Create hyperlink rels\r\n      createHyperlinkRels(arrRows, gObjPptx.slides[slideNum].rels);\r\n\r\n      // STEP 7: Auto-Paging: (via {options} and used internally)\r\n      // (used internally by `addSlidesForTable()` to not engage recursion - we've already paged the table data, just add this one)\r\n      if ( opt && opt.autoPage == false ) {\r\n        // Add data (NOTE: Use `extend` to avoid mutation)\r\n        gObjPptx.slides[slideNum].data[gObjPptx.slides[slideNum].data.length] = {\r\n          type:       'table',\r\n          arrTabRows: arrRows,\r\n          options:    $.extend(true,{},opt)\r\n        };\r\n      }\r\n      else {\r\n        // Loop over rows and create 1-N tables as needed (ISSUE#21)\r\n        getSlidesForTableRows(arrRows,opt).forEach(function(arrRows,idx){\r\n          // A: Create new Slide when needed, otherwise, use existing (NOTE: More than 1 table can be on a Slide, so we will go up AND down the Slide chain)\r\n          var currSlide = ( !gObjPptx.slides[slideNum+idx] ? addNewSlide(inMaster, inMasterOpts) : gObjPptx.slides[slideNum+idx].slide );\r\n\r\n          // B: Reset opt.y to `option`/`margin` after first Slide (ISSUE#43, ISSUE#47, ISSUE#48)\r\n          if ( idx > 0 ) opt.y = inch2Emu( opt.newPageStartY || arrTableMargin[0] );\r\n\r\n          // C: Add this table to new Slide\r\n          opt.autoPage = false;\r\n          currSlide.addTable(arrRows, $.extend(true,{},opt));\r\n        });\r\n      }\r\n\r\n      // LAST: Return this Slide\r\n      return this;\r\n    };\r\n\r\n    slideObj.addText = function( text, options ) {\r\n      gObjPptxGenerators.addTextDefinition(text, options, gObjPptx.slides[slideNum]);\r\n      return this;\r\n    };\r\n\r\n    // ==========================================================================\r\n    // POST-METHODS:\r\n    // ==========================================================================\r\n\r\n    // NOTE: Use legacy method to add Slide Number as a regular object (an actual Footer slideNum is created and can be enabled in PPT, but i cannot make it show by default arg!, so i'm cheating)\r\n    var objLayout = gObjPptx.slideLayouts.filter(function(layout){ return layout.name == inMaster })[0];\r\n    if ( objLayout && objLayout.slideNumberObj && !slideObj.slideNumber() ) gObjPptx.slides[slideNum].slideNumberObj = objLayout.slideNumberObj;\r\n\r\n    // Add Master-Slide objects (if any)\r\n    // DEPRECATED - REMOVE in 2.0.0 (20170829)\r\n    // (new `defineSlideMaster()` is a better soln and produces *Actual* layout slides, not merely adding objs to Slide!)\r\n    // for now this function in parallel with defineSlideMaster() providing backwards compatibility\r\n    if ( inMaster && typeof inMaster === 'object' ) {\r\n      // Add Slide Master objects in order\r\n      $.each(inMaster, function(key,val){\r\n        // ISSUE#7: Allow bkgd image/color override on Slide-level\r\n        if ( key == 'bkgd' && inMasterOpts.bkgd ) val = inMasterOpts.bkgd;\r\n\r\n        // Background color/image\r\n        // DEPRECATED `src` is replaced by `path` in v1.5.0\r\n        if ( key == 'bkgd' ) {\r\n          gObjPptxGenerators.addBackgroundDefinition(val, gObjPptx.slides[slideNum]);\r\n        }\r\n\r\n        // Images **DEPRECATED** (v1.5.0)\r\n        if ( key == \"images\" && Array.isArray(val) && val.length > 0 ) {\r\n          $.each(val, function(i,image){\r\n            slideObj.addImage({\r\n              data: (image.data || ''),\r\n              path: (image.path || image.src || ''),\r\n              x: inch2Emu(image.x),\r\n              y: inch2Emu(image.y),\r\n              w: inch2Emu(image.w || image.cx),\r\n              h: inch2Emu(image.h || image.cy)\r\n            });\r\n          });\r\n        }\r\n\r\n        // Shapes **DEPRECATED** (v1.5.0)\r\n        if ( key == \"shapes\" && Array.isArray(val) && val.length > 0 ) {\r\n          $.each(val, function(i,shape){\r\n            // 1: Grab all options (x, y, color, etc.)\r\n            var objOpts = {};\r\n            $.each(Object.keys(shape), function(i,key){ if ( shape[key] != 'type' ) objOpts[key] = shape[key]; });\r\n            // 2: Create object using 'type'\r\n            if      ( shape.type == 'text'      ) slideObj.addText(shape.text, objOpts);\r\n            else if ( shape.type == 'line'      ) slideObj.addShape(gObjPptxShapes.LINE, objOpts);\r\n            else if ( shape.type == 'rectangle' ) slideObj.addShape(gObjPptxShapes.RECTANGLE, objOpts);\r\n          });\r\n        }\r\n\r\n        // Add all Slide Master objects in the order they were given (Issue#53)\r\n        if ( key == \"objects\" && Array.isArray(val) && val.length > 0 ) {\r\n          val.forEach(function(object,idx){\r\n            var key = Object.keys(object)[0];\r\n            if      ( MASTER_OBJECTS[key] && key == 'chart' ) slideObj.addChart( CHART_TYPES[(object.chart.type||'').toUpperCase()], object.chart.data, object.chart.opts );\r\n            else if ( MASTER_OBJECTS[key] && key == 'image' ) slideObj.addImage(object[key]);\r\n            else if ( MASTER_OBJECTS[key] && key == 'line'  ) slideObj.addShape(gObjPptxShapes.LINE, object[key]);\r\n            else if ( MASTER_OBJECTS[key] && key == 'rect'  ) slideObj.addShape(gObjPptxShapes.RECTANGLE, object[key]);\r\n            else if ( MASTER_OBJECTS[key] && key == 'text'  ) slideObj.addText(object[key].text, object[key].options);\r\n          });\r\n        }\r\n      });\r\n\r\n      // Add Slide Numbers\r\n      if ( typeof inMaster.isNumbered !== 'undefined' ) slideObj.hasSlideNumber(inMaster.isNumbered); // DEPRECATED\r\n      if ( inMaster.slideNumber && typeof inMaster.slideNumber === 'object' ) slideObj.slideNumber(inMaster.slideNumber);\r\n      else if ( inMasterOpts.slideNumber && typeof inMasterOpts.slideNumber === 'object' ) slideObj.slideNumber(inMasterOpts.slideNumber);\r\n    }\r\n\r\n    // LAST: Return this Slide\r\n    return slideObj;\r\n  };\r\n\r\n  /**\r\n   * Adds a new slide master [layout] to the presentation.\r\n   * @param {Object} inObjMasterDef - layout definition\r\n   * @return {Object} this\r\n   */\r\n  this.defineSlideMaster = function defineSlideMaster(inObjMasterDef) {\r\n    if ( !inObjMasterDef.title ) { throw Error(\"defineSlideMaster() object argument requires a `title` value.\"); }\r\n\r\n    var objLayout = {\r\n      name : inObjMasterDef.title,\r\n      slide: {},\r\n      data : [],\r\n      rels : [],\r\n      margin: inObjMasterDef.margin || DEF_SLIDE_MARGIN_IN,\r\n      slideNumberObj: null\r\n    };\r\n\r\n    // STEP 1: Create the Slide Master/Layout\r\n    gObjPptxGenerators.createSlideObject(inObjMasterDef, objLayout);\r\n\r\n    // STEP 2: Add it to layout defs\r\n    gObjPptx.slideLayouts.push(objLayout);\r\n\r\n    // LAST:\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Reproduces an HTML table as a PowerPoint table - including column widths, style, etc. - creates 1 or more slides as needed\r\n   * \"Auto-Paging is the future!\" --Elon Musk\r\n   *\r\n   * @param {string} tabEleId - The HTML Element ID of the table\r\n   * @param {array} inOpts - An array of options (e.g.: tabsize)\r\n   */\r\n  this.addSlidesForTable = function addSlidesForTable(tabEleId, inOpts) {\r\n    var api = this;\r\n    var opts = inOpts || {};\r\n    var arrObjTabHeadRows = [], arrObjTabBodyRows = [], arrObjTabFootRows = [];\r\n    var arrObjSlides = [], arrRows = [], arrColW = [], arrTabColW = [];\r\n    var intTabW = 0, emuTabCurrH = 0;\r\n\r\n    // REALITY-CHECK:\r\n    if ( $('#'+tabEleId).length == 0 ) { console.error('Table \"'+tabEleId+'\" does not exist!'); return; }\r\n\r\n    var arrInchMargins = [0.5, 0.5, 0.5, 0.5]; // TRBL-style\r\n    opts.margin = (opts.marginPt || opts.margin); // (Legacy Support/DEPRECATED)\r\n    opts.margin = (opts.margin || opts.margin == 0 ? opts.margin : 0.5);\r\n\r\n    if ( opts.master ) {\r\n      if ( typeof opts.master === 'string' ) {\r\n        var objLayout = gObjPptx.slideLayouts.filter(function(layout){ return layout.name == opts.master })[0];\r\n        if ( objLayout && objLayout.margin ) {\r\n          if ( Array.isArray(objLayout.margin) ) arrInchMargins = objLayout.margin;\r\n          else if ( !isNaN(objLayout.margin) ) arrInchMargins = [objLayout.margin, objLayout.margin, objLayout.margin, objLayout.margin];\r\n          opts.margin = arrInchMargins;\r\n        }\r\n      }\r\n      // LEGACY SUPPORT: DEPRECATED:\r\n      else if ( typeof opts.master === 'object' && opts.master.margin ) {\r\n        if ( Array.isArray(opts.master.margin) ) arrInchMargins = opts.master.margin;\r\n        else if ( !isNaN(opts.master.margin) ) arrInchMargins = [opts.master.margin, opts.master.margin, opts.master.margin, opts.master.margin];\r\n        opts.margin = arrInchMargins;\r\n      }\r\n    }\r\n    else if ( opts && opts.margin ) {\r\n      if ( Array.isArray(opts.margin) ) arrInchMargins = opts.margin;\r\n      else if ( !isNaN(opts.margin) ) arrInchMargins = [opts.margin, opts.margin, opts.margin, opts.margin];\r\n    }\r\n    var emuSlideTabW = ( opts.w ? inch2Emu(opts.w) : (gObjPptx.pptLayout.width  - inch2Emu(arrInchMargins[1] + arrInchMargins[3])) );\r\n    var emuSlideTabH = ( opts.h ? inch2Emu(opts.h) : (gObjPptx.pptLayout.height - inch2Emu(arrInchMargins[0] + arrInchMargins[2])) );\r\n\r\n    // STEP 1: Grab table col widths\r\n    $.each(['thead','tbody','tfoot'], function(i,val){\r\n      if ( $('#'+tabEleId+' > '+val+' > tr').length > 0 ) {\r\n        $('#'+tabEleId+' > '+val+' > tr:first-child').find('> th, > td').each(function(i,cell){\r\n          // FIXME: This is a hack - guessing at col widths when colspan\r\n          if ( $(this).attr('colspan') ) {\r\n            for (var idx=0; idx<$(this).attr('colspan'); idx++ ) {\r\n              arrTabColW.push( Math.round($(this).outerWidth()/$(this).attr('colspan')) );\r\n            }\r\n          }\r\n          else {\r\n            arrTabColW.push( $(this).outerWidth() );\r\n          }\r\n        });\r\n        return false; // break out of .each loop\r\n      }\r\n    });\r\n    $.each(arrTabColW, function(i,colW){ intTabW += colW; });\r\n\r\n    // STEP 2: Calc/Set column widths by using same column width percent from HTML table\r\n    $.each(arrTabColW, function(i,colW){\r\n      var intMinWidth = $('#'+tabEleId+' thead tr:first-child th:nth-child('+ (i+1) +')').data('pptx-min-width');\r\n      var intCalcWidth = Number(((emuSlideTabW * (colW / intTabW * 100) ) / 100 / EMU).toFixed(2));\r\n      arrColW.push( (intMinWidth > intCalcWidth ? intMinWidth : intCalcWidth) );\r\n    });\r\n\r\n    // STEP 3: Iterate over each table element and create data arrays (text and opts)\r\n    // NOTE: We create 3 arrays instead of one so we can loop over body then show header/footer rows on first and last page\r\n    $.each(['thead','tbody','tfoot'], function(i,val){\r\n      $('#'+tabEleId+' > '+val+' > tr').each(function(i,row){\r\n        var arrObjTabCells = [];\r\n        $(row).find('> th, > td').each(function(i,cell){\r\n          // A: Get RGB text/bkgd colors\r\n          var arrRGB1 = [];\r\n          var arrRGB2 = [];\r\n          arrRGB1 = $(cell).css('color').replace(/\\s+/gi,'').replace('rgba(','').replace('rgb(','').replace(')','').split(',');\r\n          arrRGB2 = $(cell).css('background-color').replace(/\\s+/gi,'').replace('rgba(','').replace('rgb(','').replace(')','').split(',');\r\n          // ISSUE#57: jQuery default is this rgba value of below giving unstyled tables a black bkgd, so use white instead (FYI: if cell has `background:#000000` jQuery returns 'rgb(0, 0, 0)', so this soln is pretty solid)\r\n          if ( $(cell).css('background-color') == 'rgba(0, 0, 0, 0)' || $(cell).css('background-color') == 'transparent' ) arrRGB2 = [255,255,255];\r\n\r\n          // B: Create option object\r\n          var objOpts = {\r\n            font_size: $(cell).css('font-size').replace(/\\D/gi,''),\r\n            bold:      (( $(cell).css('font-weight') == \"bold\" || Number($(cell).css('font-weight')) >= 500 ) ? true : false),\r\n            color:     rgbToHex( Number(arrRGB1[0]), Number(arrRGB1[1]), Number(arrRGB1[2]) ),\r\n            fill:      rgbToHex( Number(arrRGB2[0]), Number(arrRGB2[1]), Number(arrRGB2[2]) )\r\n          };\r\n          if ( $.inArray($(cell).css('text-align'), ['left','center','right','start','end']) > -1 ) objOpts.align = $(cell).css('text-align').replace('start','left').replace('end','right');\r\n          if ( $.inArray($(cell).css('vertical-align'), ['top','middle','bottom']) > -1 ) objOpts.valign = $(cell).css('vertical-align');\r\n\r\n          // C: Add padding [margin] (if any)\r\n          // NOTE: Margins translate: px->pt 1:1 (e.g.: a 20px padded cell looks the same in PPTX as 20pt Text Inset/Padding)\r\n          if ( $(cell).css('padding-left') ) {\r\n            objOpts.margin = [];\r\n            $.each(['padding-top', 'padding-right', 'padding-bottom', 'padding-left'],function(i,val){\r\n              objOpts.margin.push( Math.round($(cell).css(val).replace(/\\D/gi,'')) );\r\n            });\r\n          }\r\n\r\n          // D: Add colspan (if any)\r\n          if ( $(cell).attr('colspan') ) objOpts.colspan = $(cell).attr('colspan');\r\n\r\n          // E: Add border (if any)\r\n          if ( $(cell).css('border-top-width') || $(cell).css('border-right-width') || $(cell).css('border-bottom-width') || $(cell).css('border-left-width') ) {\r\n            objOpts.border = [];\r\n            $.each(['top','right','bottom','left'], function(i,val){\r\n              var intBorderW = Math.round( Number($(cell).css('border-'+val+'-width').replace('px','')) );\r\n              var arrRGB = [];\r\n              arrRGB = $(cell).css('border-'+val+'-color').replace(/\\s+/gi,'').replace('rgba(','').replace('rgb(','').replace(')','').split(',');\r\n              var strBorderC = rgbToHex( Number(arrRGB[0]), Number(arrRGB[1]), Number(arrRGB[2]) );\r\n              objOpts.border.push( {pt:intBorderW, color:strBorderC} );\r\n            });\r\n          }\r\n\r\n          // F: Massage cell text so we honor linebreak tag as a line break during line parsing\r\n          var $cell2 = $(cell).clone();\r\n          $cell2.html( $(cell).html().replace(/<br[^>]*>/gi,'\\n') );\r\n\r\n          // LAST: Add cell\r\n          arrObjTabCells.push({\r\n            text: $.trim( $cell2.text() ),\r\n            opts: objOpts\r\n          });\r\n        });\r\n        switch (val) {\r\n          case 'thead': arrObjTabHeadRows.push( arrObjTabCells ); break;\r\n          case 'tbody': arrObjTabBodyRows.push( arrObjTabCells ); break;\r\n          case 'tfoot': arrObjTabFootRows.push( arrObjTabCells ); break;\r\n          default:\r\n        }\r\n      });\r\n    });\r\n\r\n    // STEP 4: NOTE: `margin` is \"cell margin (pt)\" everywhere else tables are used, so explicitly convert to \"slide margin\" here\r\n    if (opts.margin) {\r\n      opts.slideMargin = opts.margin;\r\n      delete(opts.margin);\r\n    }\r\n    // STEP 5: Break table into Slides as needed\r\n    // Pass head-rows as there is an option to add to each table and the parse func needs this daa to fulfill that option\r\n    opts.arrObjTabHeadRows = arrObjTabHeadRows || '';\r\n    opts.colW = arrColW;\r\n\r\n    getSlidesForTableRows( arrObjTabHeadRows.concat(arrObjTabBodyRows).concat(arrObjTabFootRows), opts )\r\n    .forEach(function(arrTabRows,i){\r\n      // A: Create new Slide\r\n      var newSlide = ( opts.master ? api.addNewSlide(opts.master) : api.addNewSlide() );\r\n\r\n      // B: Add table to Slide\r\n      newSlide.addTable(arrTabRows, {x:(opts.x || arrInchMargins[3]), y:(opts.y || arrInchMargins[0]), w:(emuSlideTabW/EMU), colW:arrColW, autoPage:false});\r\n\r\n      // C: Add any additional objects\r\n      if ( opts.addImage ) newSlide.addImage({ path:opts.addImage.url, x:opts.addImage.x, y:opts.addImage.y, w:opts.addImage.w, h:opts.addImage.h });\r\n      if ( opts.addShape ) newSlide.addShape( opts.addShape.shape, (opts.addShape.opts || {}) );\r\n      if ( opts.addTable ) newSlide.addTable( opts.addTable.rows,  (opts.addTable.opts || {}) );\r\n      if ( opts.addText  ) newSlide.addText(  opts.addText.text,   (opts.addText.opts  || {}) );\r\n    });\r\n  }\r\n};\r\n\r\n// B: Export module\r\nmodule.exports = PptxGenJS;"]}