{"version":3,"sources":["pptxgen.bundle.js"],"names":["$$","document","querySelectorAll","apply","this","arguments","isWindow","obj","window","isArrayLike","length","type","isPlainObject","nodeType","constructor","hasOwnProperty","call","prototype","each","callback","i","extend","options","name","src","copy","copyIsArray","clone","target","deep","undefined","JSZip","require","Number","isInteger","value","isFinite","Math","floor","PptxGenJS","doExportPresentation","outputType","arrChartPromises","intSlideNum","zip","folder","file","makeXmlContTypes","makeXmlRootRels","makeXmlApp","makeXmlCore","makeXmlPresentationRels","makeXmlTheme","makeXmlPresentation","makeXmlPresProps","makeXmlTableStyles","makeXmlViewProps","idx","gObjPptx","slideLayouts","makeXmlLayout","makeXmlSlideLayoutRel","slides","makeXmlSlide","makeXmlSlideRel","makeXmlMaster","masterSlide","makeXmlMasterRel","forEach","layout","createMediaFiles","slide","Promise","all","then","strExportName","fileName","toLowerCase","indexOf","fileExtn","JSZIP_OUTPUT_TYPES","generateAsync","saveCallback","content","writeFileToBrowser","catch","strErr","console","error","a","createElement","body","appendChild","style","navigator","msSaveOrOpenBlob","blobObject","Blob","click","removeChild","URL","createObjectURL","blob","url","href","download","setTimeout","revokeObjectURL","getExcelColName","strName","LETTERS","componentToHex","c","hex","toString","createColorElement","colorStr","innerElements","isHexaRgb","REGEX_HEX_COLOR","test","SCHEME_COLOR_NAMES","warn","DEF_FONT_COLOR","join","tagName","colorAttr","rgbToHex","r","g","b","toUpperCase","inch2Emu","inches","replace","round","EMU","convertImgToDataURLviaCanvas","slideRel","image","Image","onload","width","height","canvas","ctx","getContext","drawImage","callbackImgToDataURLDone","toDataURL","ex","onerror","location","path","substring","lastIndexOf","IMG_BROKEN","inStr","intEmpty","clbk","rel","data","rels","getShapeInfo","shapeName","gObjPptxShapes","RECTANGLE","displayName","avLst","objShape","filter","getSmartParseNumber","inVal","inDir","isNaN","parseInt","pptLayout","decodeXmlEntities","createHyperlinkRels","inText","slideRels","arrTextObjects","Array","isArray","text","hyperlink","rId","log","intRels","intRelId","push","Target","parseTextToLines","cell","inWidth","CHAR","opts","lineWeight","CPL","font_size","DEF_FONT_SIZE","arrLines","strCurrLine","trim","split","line","word","CRLF","getSlidesForTableRows","inArrRows","arrInchMargins","DEF_SLIDE_MARGIN_IN","arrObjSlides","arrRows","currRow","emuTabCurrH","emuSlideTabW","emuSlideTabH","arrObjTabHeadRows","numCols","debug","w","colW","slideMargin","master","margin","cellOpts","colspan","val","x","toFixed","arrColW","iCol","row","iRow","arrCellsLines","arrCellsLineHeights","intMaxLineCnt","intMaxColIdx","y","h","iCell","lines","opt","ONEPT","lineHeight","rowspan","col","addHeaderToEach","headRow","createShadowElement","defaults","strXml","mix","blur","offset","angle","color","opacity","rotateWithShape","correctShadowOptions","shadowOpts","correctGridLineOptions","glOpts","size","createGridLineElement","encodeImageRelations","arrRelsDone","inArray","chartPromises","gObjPptxGenerators","createExcelWorksheet","pop","base64","o","oN","Object","keys","key","makeXmlCharts","showTitle","genXmlTitle","title","fontSize","titleFontSize","DEF_FONT_TITLE_SIZE","titleColor","fontFace","titleFontFace","rotate","titleRotate","titleAlign","titlePos","usesSecondaryValAxis","chartType","valAxisId","secondaryValAxis","AXIS_ID_VALUE_SECONDARY","AXIS_ID_VALUE_PRIMARY","catAxisId","secondaryCatAxis","AXIS_ID_CATEGORY_SECONDARY","AXIS_ID_CATEGORY_PRIMARY","makeChartType","valAxes","Error","catAxes","makeCatAxis","hasArea","some","item","has","makeValueAxis","showDataTable","showDataTableHorzBorder","showDataTableVertBorder","showDataTableOutline","showDataTableKeys","fill","genXmlColorSelection","border","pt","showLegend","legendPos","legendFontSize","barDir","barGrouping","colorIndex","index","strSerColor","chartColors","chartColorsOpacity","lineSize","line_dash","dataBorder","shadow","DEF_SHAPE_SHADOW","lineDataSymbol","lineDataSymbolSize","random","symbolLineColor","lineDataSymbolLineColor","lineDataSymbolLineSize","valueBarColors","BARCHART_COLORS","values","arrColors","invertedColors","catLabelFormatCode","labels","label","lineSmooth","dataLabelFormatCode","dataLabelFontSize","dataLabelColor","dataLabelFontFace","dataLabelPosition","showValue","barGapWidthPct","dataNoEffects","showLabel","showPercent","holeSize","axisId","showCatAxisTitle","catAxisTitle","catAxisTitleFontSize","catAxisTitleColor","catAxisTitleFontFace","catAxisTitleRotate","catAxisOrientation","catAxisHidden","catGridLine","DEF_CHART_GRIDLINE","catAxisLabelFontSize","catAxisLabelColor","catAxisLabelFontFace","catAxisLabelFrequency","catAxisBaseTimeUnit","catAxisMajorTimeUnit","catAxisMinorTimeUnit","catAxisMajorUnit","catAxisMinorUnit","axisPos","crosses","crossAxId","showValAxisTitle","valAxisTitle","valAxisTitleFontSize","valAxisTitleColor","valAxisTitleFontFace","valAxisTitleRotate","valAxisOrientation","valAxisMaxVal","valAxisMinVal","valAxisHidden","valGridLine","valAxisLabelFormatCode","valAxisLabelFontSize","valAxisLabelColor","valAxisLabelFontFace","valAxisMajorUnit","convertRotationDegrees","d","align","sizeAttr","genXmlTextBody","slideObj","isTableCell","tagStart","tagClose","strSlideXml","strXmlBullet","strXmlLnSpc","paragraphPropXml","bullet","breakLine","genXmlBodyProperties","textObj","rtlMode","lineIdx","lineSpacing","indentLevel","code","bulletCode","BULLET_TYPES","genXmlTextRun","font_face","lang","text_string","parsedText","xmlTextRun","startInfo","bold","italic","underline","subscript","superscript","tooltip","outTextData","total_size_i","objOptions","bodyProperties","bodyProp","wrap","anchor","bIns","lIns","rIns","tIns","shrinkText","autoFit","color_info","back_info","colorVal","fillType","internalElements","outText","alpha","extn","company","subject","author","revision","Date","toISOString","intRelNum","inSlide","slideObjectToXml","slideLayoutObject","slideObject","layoutDefs","map","layoutDef","LAYOUT_IDX_SERIES_BASE","layoutNumber","slideObjectRelationsToXml","slideNumber","getLayoutIdxForSlide","masterSlideObject","defaultRels","layoutName","intCurPos","MASTER_OBJECTS","chart","rect","LAYOUTS","LAYOUT_4x3","LAYOUT_16x9","LAYOUT_16x10","LAYOUT_WIDE","LAYOUT_USER","BASE_SHAPES","LINE","DEFAULT","CHECK","STAR","TRIANGLE","CHART_TYPES","AREA","BAR","PIE","DOUGHNUT","PIECHART_COLORS","IMG_PLAYBTN","DEF_CELL_BORDER","DEF_CELL_MARGIN_PT","slideNumberObj","chartCounter","imageCounter","charts","colors","shapes","masters","clrKey","bind","addBackgroundDefinition","bkg","targetRels","strImgExtn","bkgdImgRid","back","addTextDefinition","resultObject","valign","shape","line_size","inset","addShapeDefinition","addImageDefinition","strImagePath","intPosX","intPosY","intWidth","intHeight","strImageData","sizing","cx","cy","objHyperlink","imageRelId","exec","imgObj","imageRid","addChartDefinition","tmpOpt","chartId","chartRelId","tmpData","concat","lineShadow","globalId","chartRid","createSlideObject","slideDef","bkgd","objects","object","intTableNum","slideItemObj","locationAttr","shapeType","flipH","flipV","arrTabRows","objTableGrid","objTabOpts","intColCnt","intColW","numb","rIdx","cIdx","currColIdx","idy","hmerge","idz","vmerge","rowObj","intRowH","rowH","cellValign","cellColspan","cellRowspan","cellFill","optImp","cellMargin","marginPt","strC","intW","strClr","strAttr","tmp","isTextBox","rectRadius","min","line_head","line_tail","boxW","boxH","boxX","boxY","imageSizingXml","mtype","mediaRid","media","shift","lastRid","max","cover","imgSize","boxDim","imgRatio","isBoxBased","hzPerc","vzPerc","contain","widthBased","crop","imageSize","l","t","chartObject","resolve","reject","zipExcel","strSharedStrings","objData","strTableXml","strSheetXml","getVersion","APP_VER","getLayout","setRTL","inBool","setLayout","inLayout","setTitle","inStrTitle","setAuthor","inStrAuthor","setRevision","inStrRevision","setSubject","inStrSubject","setCompany","inStrCompany","save","inStrExportName","funcCallback","addNewSlide","inMaster","inMasterOpts","slideNum","pageNum","hasSlideNumber","getPageNumber","inObj","addChart","addImage","intSizeX","intSizeY","addMedia","strData","strLink","link","strPath","strType","strExtn","slideObjNum","slideObjRels","addShape","addTable","inOpt","tabOpt","attr","autoPage","arrTableMargin","numColWidth","numTabWidth","currSlide","newPageStartY","addText","objLayout","objOpts","isNumbered","defineSlideMaster","inObjMasterDef","addSlidesForTable","tabEleId","inOpts","api","arrObjTabBodyRows","arrObjTabFootRows","arrTabColW","intTabW","find","outerWidth","intMinWidth","intCalcWidth","arrObjTabCells","arrRGB1","arrRGB2","css","intBorderW","arrRGB","strBorderC","$cell2","html","newSlide","rows","module","exports"],"mappings":"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","file":"pptxgen.bundle.js","sourcesContent":["/*\\\r\n|*|  :: pptxgen.js ::\r\n|*|\r\n|*|  JavaScript framework that creates PowerPoint (pptx) presentations\r\n|*|  https://github.com/gitbrent/PptxGenJS\r\n|*|\r\n|*|  This framework is released under the MIT Public License (MIT)\r\n|*|\r\n|*|  PptxGenJS (C) 2015-2017 Brent Ely -- https://github.com/gitbrent\r\n|*|\r\n|*|  Some code derived from the OfficeGen project:\r\n|*|  github.com/Ziv-Barber/officegen/ (Copyright 2013 Ziv Barber)\r\n|*|\r\n|*|  Permission is hereby granted, free of charge, to any person obtaining a copy\r\n|*|  of this software and associated documentation files (the \"Software\"), to deal\r\n|*|  in the Software without restriction, including without limitation the rights\r\n|*|  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n|*|  copies of the Software, and to permit persons to whom the Software is\r\n|*|  furnished to do so, subject to the following conditions:\r\n|*|\r\n|*|  The above copyright notice and this permission notice shall be included in all\r\n|*|  copies or substantial portions of the Software.\r\n|*|\r\n|*|  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n|*|  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n|*|  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n|*|  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n|*|  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n|*|  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\r\n|*|  SOFTWARE.\r\n\\*/\r\n\r\n/*\r\n  PPTX Units are \"DXA\" (except for font sizing)\r\n  ....: There are 1440 DXA per inch. 1 inch is 72 points. 1 DXA is 1/20th's of a point (20 DXA is 1 point).\r\n  ....: There is also something called EMU's (914400 EMUs is 1 inch, 12700 EMUs is 1pt).\r\n  SEE: https://startbigthinksmall.wordpress.com/2010/01/04/points-inches-and-emus-measuring-units-in-office-open-xml/\r\n  |\r\n  OBJECT LAYOUTS: 16x9 (10\" x 5.625\"), 16x10 (10\" x 6.25\"), 4x3 (10\" x 7.5\"), Wide (13.33\" x 7.5\") and Custom (any size)\r\n  |\r\n  REFS:\r\n  * \"Structure of a PresentationML document (Open XML SDK)\"\r\n  * @see: https://msdn.microsoft.com/en-us/library/office/gg278335.aspx\r\n  * TableStyleId enumeration\r\n  * @see: https://msdn.microsoft.com/en-us/library/office/hh273476(v=office.14).aspx\r\n*/\r\n\r\n\r\nvar $$ = function() {\r\n  return document.querySelectorAll.apply(this, arguments);\r\n};\r\n\r\nvar isWindow = function(obj) {\r\n  return obj != null && obj === obj.window;\r\n};\r\nvar isArrayLike = function(obj) {\r\n\r\n  // Support: real iOS 8.2 only (not reproducible in simulator)\r\n  // `in` check used to prevent JIT error (gh-2145)\r\n  // hasOwn isn't used here due to false negatives\r\n  // regarding Nodelist length in IE\r\n  var length = !!obj && 'length' in obj && obj.length,\r\n    type = typeof obj;\r\n\r\n  if ( typeof obj === 'function' || isWindow( obj ) ) {\r\n    return false;\r\n  }\r\n\r\n  return type === 'array' || length === 0 ||\r\n    typeof length === 'number' && length > 0 && ( length - 1 ) in obj;\r\n};\r\nvar isPlainObject = function(obj) {\r\n  // Not plain objects:\r\n  // - Any object or value whose internal [[Class]] property is not \"[object Object]\"\r\n  // - DOM nodes\r\n  // - window\r\n  if ( typeof obj !== 'object' || obj.nodeType || isWindow( obj ) ) {\r\n    return false;\r\n  }\r\n\r\n  if ( obj.constructor &&\r\n      !hasOwnProperty.call( obj.constructor.prototype, 'isPrototypeOf' ) ) {\r\n    return false;\r\n  }\r\n\r\n  // If the function hasn't returned already, we're confident that\r\n  // |obj| is a plain object, created by {} or constructed with new Object\r\n  return true;\r\n};\r\n\r\n$$.each = function(obj, callback) {\r\n  var length, i = 0;\r\n\r\n  if ( isArrayLike( obj ) ) {\r\n    length = obj.length;\r\n    for ( ; i < length; i++ ) {\r\n      if ( callback.call( obj[ i ], i, obj[ i ] ) === false ) {\r\n        break;\r\n      }\r\n    }\r\n  } else {\r\n    for ( i in obj ) {\r\n      if ( callback.call( obj[ i ], i, obj[ i ] ) === false ) {\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  return obj;\r\n};\r\n\r\nvar extend = function() {\r\n  var options, name, src, copy, copyIsArray, clone,\r\n    target = arguments[0] || {},\r\n    i = 1,\r\n    length = arguments.length,\r\n    deep = false;\r\n\r\n  // Handle a deep copy situation\r\n  if ( typeof target === 'boolean' ) {\r\n    deep = target;\r\n\r\n    // Skip the boolean and the target\r\n    target = arguments[ i ] || {};\r\n    i++;\r\n  }\r\n\r\n  // Handle case when target is a string or something (possible in deep copy)\r\n  if ( typeof target !== 'object' && typeof target !== 'function' ) {\r\n    target = {};\r\n  }\r\n\r\n  // Extend jQuery itself if only one argument is passed\r\n  if ( i === length ) {\r\n    target = this;\r\n    i--;\r\n  }\r\n\r\n  for ( ; i < length; i++ ) {\r\n    // Only deal with non-null/undefined values\r\n    if ( (options = arguments[ i ]) != null ) {\r\n      // Extend the base object\r\n      for ( name in options ) {\r\n        src = target[ name ];\r\n        copy = options[ name ];\r\n\r\n        // Prevent never-ending loop\r\n        if ( target === copy ) {\r\n          continue;\r\n        }\r\n\r\n        // Recurse if we're merging plain objects or arrays\r\n        if ( deep && copy && ( isPlainObject(copy) || (copyIsArray = isArrayLike(copy)) ) ) {\r\n          if ( copyIsArray ) {\r\n            copyIsArray = false;\r\n            clone = src && isArrayLike(src) ? src : [];\r\n\r\n          } else {\r\n            clone = src && isPlainObject(src) ? src : {};\r\n          }\r\n\r\n          // Never move original objects, clone them\r\n          target[ name ] = extend( deep, clone, copy );\r\n\r\n        // Don't bring in undefined values\r\n        } else if ( copy !== undefined ) {\r\n          target[ name ] = copy;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // Return the modified object\r\n  return target;\r\n};\r\n$$.extend = extend;\r\n// A: Load depdendencies\r\nvar JSZip = require('jszip');\r\n\r\n// Polyfill for IE11 (https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isInteger)\r\nNumber.isInteger = Number.isInteger || function(value) {\r\n  return typeof value === 'number' && isFinite(value) && Math.floor(value) === value;\r\n};\r\n\r\nvar PptxGenJS = function(){\r\n  // APP\r\n  var APP_VER = '1.9.0-beta';\r\n  var APP_REL = '20170920';\r\n\r\n  // CONSTANTS\r\n  var MASTER_OBJECTS = {\r\n    'chart': { name:'chart' },\r\n    'image': { name:'image' },\r\n    'line' : { name:'line'  },\r\n    'rect' : { name:'rect'  },\r\n    'text' : { name:'text'  }\r\n  };\r\n  var LAYOUTS = {\r\n    'LAYOUT_4x3'  : { name: 'screen4x3',   width:  9144000, height: 6858000 },\r\n    'LAYOUT_16x9' : { name: 'screen16x9',  width:  9144000, height: 5143500 },\r\n    'LAYOUT_16x10': { name: 'screen16x10', width:  9144000, height: 5715000 },\r\n    'LAYOUT_WIDE' : { name: 'custom',      width: 12191996, height: 6858000 },\r\n    'LAYOUT_USER' : { name: 'custom',      width: 12191996, height: 6858000 }\r\n  };\r\n  var BASE_SHAPES = {\r\n    'RECTANGLE': { 'displayName': 'Rectangle', 'name': 'rect', 'avLst': {} },\r\n    'LINE'     : { 'displayName': 'Line',      'name': 'line', 'avLst': {} }\r\n  };\r\n  // NOTE: 20170304: BULLET_TYPES: Only default is used so far. I'd like to combine the two peices of code that use these before implementing these as options\r\n  // Since we close <p> within the text object bullets, its slightly more difficult than combining into a func and calling to get the paraProp\r\n  // and i'm not sure if anyone will even use these... so, skipping for now.\r\n  var BULLET_TYPES = {\r\n    'DEFAULT' : '&#x2022;',\r\n    'CHECK'   : '&#x2713;',\r\n    'STAR'    : '&#x2605;',\r\n    'TRIANGLE': '&#x25B6;'\r\n  };\r\n  var CHART_TYPES = {\r\n    'AREA'    : { 'displayName':'Area Chart',      'name':'area'     },\r\n    'BAR'     : { 'displayName':'Bar Chart' ,      'name':'bar'      },\r\n    'LINE'    : { 'displayName':'Line Chart',      'name':'line'     },\r\n    'PIE'     : { 'displayName':'Pie Chart' ,      'name':'pie'      },\r\n    'DOUGHNUT': { 'displayName':'Doughnut Chart' , 'name':'doughnut' }\r\n  };\r\n  var PIECHART_COLORS = ['5DA5DA','FAA43A','60BD68','F17CB0','B2912F','B276B2','DECF3F','F15854','A7A7A7', '5DA5DA','FAA43A','60BD68','F17CB0','B2912F','B276B2','DECF3F','F15854','A7A7A7'];\r\n  var BARCHART_COLORS = ['C0504D','4F81BD','9BBB59','8064A2','4BACC6','F79646','628FC6','C86360', 'C0504D','4F81BD','9BBB59','8064A2','4BACC6','F79646','628FC6','C86360'];\r\n  // IMAGES (base64)\r\n  {\r\n    var IMG_BROKEN  = 'data:image/png;base64,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';\r\n    var IMG_PLAYBTN = 'data:image/png;base64,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';\r\n  }\r\n  //\r\n  var CRLF = '\\r\\n'; // AKA: Chr(13) & Chr(10)\r\n  var EMU = 914400;  // One (1) inch (OfficeXML measures in EMU (English Metric Units))\r\n  var ONEPT = 12700; // One (1) point (pt)\r\n  var LAYOUT_IDX_SERIES_BASE = 2147483649;\r\n  var LETTERS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');\r\n  var JSZIP_OUTPUT_TYPES = ['arraybuffer', 'base64', 'binarystring', 'blob', 'nodebuffer', 'uint8array']; /** @see https://stuk.github.io/jszip/documentation/api_jszip/generate_async.html */\r\n  var REGEX_HEX_COLOR = /^[0-9a-fA-F]{6}$/;\r\n  var SLDNUMFLDID = '{F7021451-1387-4CA6-816F-3879F97B5CBC}';\r\n  //\r\n  var DEF_CELL_BORDER = { color:'666666' };\r\n  var DEF_CELL_MARGIN_PT = [3, 3, 3, 3]; // TRBL-style\r\n  var DEF_FONT_COLOR = '000000';\r\n  var DEF_FONT_SIZE = 12;\r\n  var DEF_FONT_TITLE_SIZE = 18;\r\n  var DEF_SLIDE_MARGIN_IN = [0.5, 0.5, 0.5, 0.5]; // TRBL-style\r\n  var DEF_CHART_GRIDLINE = { color: '888888', style: 'solid', size: 1 };\r\n  var DEF_SHAPE_SHADOW = { type: 'outer', blur: 3, offset: (23000 / 12700), angle: 90, color: '000000', opacity: 0.35, rotateWithShape: true };\r\n  var AXIS_ID_VALUE_PRIMARY       = '2094734552';\r\n  var AXIS_ID_VALUE_SECONDARY     = '2094734553';\r\n  var AXIS_ID_CATEGORY_PRIMARY    = '2094734554';\r\n  var AXIS_ID_CATEGORY_SECONDARY  = '2094734555';\r\n\r\n  // A: Create internal pptx object\r\n  var gObjPptx = {};\r\n\r\n  // B: Set Presentation Property Defaults\r\n  {\r\n    // Presentation props/metadata\r\n    gObjPptx.author    = 'PptxGenJS';\r\n    gObjPptx.company   = 'PptxGenJS';\r\n    gObjPptx.revision  = '1';\r\n    gObjPptx.subject   = 'PptxGenJS Presentation';\r\n    gObjPptx.title     = 'PptxGenJS Presentation';\r\n\r\n    // PptxGenJS props\r\n    gObjPptx.saveCallback = null;\r\n    gObjPptx.fileName     = 'Presentation';\r\n    gObjPptx.fileExtn     = '.pptx';\r\n    gObjPptx.pptLayout    = LAYOUTS['LAYOUT_16x9'];\r\n    gObjPptx.rtlMode      = false;\r\n\r\n    // PptxGenJS data\r\n    /** @type {object} master slide layout object */\r\n    gObjPptx.masterSlide = {\r\n      slide: {},\r\n      data : [],\r\n      rels : [],\r\n      slideNumberObj: null\r\n    };\r\n\r\n    /** @type {Number} global counter for included charts (used for index in their filenames) */\r\n    gObjPptx.chartCounter = 0;\r\n\r\n    /** @type {Number} global counter for included images (used for index in their filenames) */\r\n    gObjPptx.imageCounter = 0;\r\n\r\n    /** @type {object[]} this Presentations Slides (Slide objects) */\r\n    gObjPptx.slides = [];\r\n\r\n    /** @type {object[]} slide layout definition objects, used for generating slide layout files */\r\n    gObjPptx.slideLayouts = [{\r\n      name : 'BLANK',\r\n      slide: {},\r\n      data : [],\r\n      rels : [],\r\n      margin: DEF_SLIDE_MARGIN_IN,\r\n      slideNumberObj: null\r\n    }];\r\n  }\r\n\r\n  // C: Expose shape library to clients\r\n  this.charts  = CHART_TYPES;\r\n  this.colors  = {};\r\n  this.shapes  = BASE_SHAPES;\r\n  this.masters = {};\r\n  /* LEGACY/DEPRECATED ^^^ - WILL BE REMOVED in 2.0 */\r\n  // Declare only after `this.colors` is initialized\r\n  var SCHEME_COLOR_NAMES = Object.keys(this.colors).map(function(clrKey){return this.colors[clrKey];}.bind(this));\r\n\r\n  // D: Fall back to base shapes if shapes file was not linked\r\n  var gObjPptxShapes =  this.shapes;\r\n\r\n  /* ===============================================================================================\r\n  |\r\n   #####\r\n  #     # ###### #    # ###### #####    ##   #####  ####  #####   ####\r\n  #       #      ##   # #      #    #  #  #    #   #    # #    # #\r\n  #  #### #####  # #  # #####  #    # #    #   #   #    # #    #  ####\r\n  #     # #      #  # # #      #####  ######   #   #    # #####       #\r\n  #     # #      #   ## #      #   #  #    #   #   #    # #   #  #    #\r\n   #####  ###### #    # ###### #    # #    #   #    ####  #    #  ####\r\n  |\r\n  ==================================================================================================\r\n  */\r\n\r\n  var gObjPptxGenerators = {\r\n    /**\r\n     * Adds a background image or color to a slide definition.\r\n     * @param {String|Object} bkg color string or an object with image definition\r\n     * @param {Object} target slide object that the background is set to\r\n     * DEPRECATED `src` is replaced by `path` in v1.5.0\r\n     */\r\n    addBackgroundDefinition: function addBackgroundDefinition(bkg, target) {\r\n      if ( typeof bkg === 'object' && (bkg.src || bkg.path || bkg.data) ) {\r\n        // Allow the use of only the data key (no src reqd)\r\n        bkg.src = bkg.src || bkg.path || null;\r\n        if (!bkg.src) bkg.src = 'preencoded.png';\r\n        var targetRels = target.rels;\r\n        var strImgExtn = bkg.src.substring( bkg.src.indexOf('.')+1 ).toLowerCase();\r\n        if ( strImgExtn == 'jpg' ) strImgExtn = 'jpeg';\r\n        if ( strImgExtn == 'gif' ) strImgExtn = 'png'; // MS-PPT: canvas.toDataURL for gif comes out image/png, and PPT will show \"needs repair\" unless we do this\r\n        // FIXME: The next few lines are copies from .addImage above. A bad idea thats already bit me once! So of course it's makred as future :)\r\n        var intRels = targetRels.length + 1;\r\n        targetRels.push({\r\n          path: bkg.src,\r\n          type: 'image/'+strImgExtn,\r\n          extn: strImgExtn,\r\n          data: (bkg.data || ''),\r\n          rId: intRels,\r\n          Target: '../media/image' + (++gObjPptx.imageCounter) + '.' + strImgExtn\r\n        });\r\n        target.slide.bkgdImgRid = intRels;\r\n      }\r\n      else if ( bkg && typeof bkg === 'string' ) {\r\n        target.slide.back = bkg;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Adds a text object to a slide definition.\r\n     * @param {String} text\r\n     * @param {Object} opt\r\n     * @param {Object} target slide object that the text should be added to\r\n     */\r\n    addTextDefinition: function addTextDefinition(text, opt, target) {\r\n      opt = ( opt && typeof opt === 'object' ? opt : {} );\r\n      text = ( text || '' );\r\n      var resultObject = {};\r\n      if ( Array.isArray(text) && text.length == 0 ) text = '';\r\n\r\n      // STEP 2: Set some options\r\n      // Set color (options > inherit from Slide > default to black)\r\n      opt.color = ( opt.color || target.slide.color || DEF_FONT_COLOR );\r\n\r\n      // ROBUST: Convert attr values that will likely be passed by users to valid OOXML values\r\n      if ( opt.valign ) opt.valign = opt.valign.toLowerCase().replace(/^c.*/i,'ctr').replace(/^m.*/i,'ctr').replace(/^t.*/i,'t').replace(/^b.*/i,'b');\r\n      if ( opt.align  ) opt.align  = opt.align.toLowerCase().replace(/^c.*/i,'center').replace(/^m.*/i,'center').replace(/^l.*/i,'left').replace(/^r.*/i,'right');\r\n\r\n      // ROBUST: Set rational values for some shadow props if needed\r\n      correctShadowOptions(opt.shadow);\r\n\r\n      // STEP 3: Set props\r\n      resultObject.type = 'text';\r\n      resultObject.text = text;\r\n\r\n      // STEP 4: Set options\r\n      resultObject.options = opt;\r\n      if ( opt.shape && opt.shape.name == 'line' ) {\r\n        opt.line      = (opt.line      || '333333' );\r\n        opt.line_size = (opt.line_size || 1 );\r\n      }\r\n      resultObject.options.bodyProp = {};\r\n      resultObject.options.bodyProp.autoFit = (opt.autoFit || false); // If true, shape will collapse to text size (Fit To Shape)\r\n      resultObject.options.bodyProp.anchor = (opt.valign || 'ctr'); // VALS: [t,ctr,b]\r\n      resultObject.options.lineSpacing = (opt.lineSpacing && !isNaN(opt.lineSpacing) ? opt.lineSpacing : null);\r\n\r\n      if ( (opt.inset && !isNaN(Number(opt.inset))) || opt.inset == 0 ) {\r\n        resultObject.options.bodyProp.lIns = inch2Emu(opt.inset);\r\n        resultObject.options.bodyProp.rIns = inch2Emu(opt.inset);\r\n        resultObject.options.bodyProp.tIns = inch2Emu(opt.inset);\r\n        resultObject.options.bodyProp.bIns = inch2Emu(opt.inset);\r\n      }\r\n\r\n      target.data.push(resultObject);\r\n      createHyperlinkRels(text || '', target.rels);\r\n\r\n      return resultObject;\r\n    },\r\n\r\n    /**\r\n     * Adds a shape object to a slide definition.\r\n     * @param {Object} shape shape const object (pptx.shapes)\r\n     * @param {Object} opt\r\n     * @param {Object} target slide object that the shape should be added to\r\n     * @return {Object} shape object\r\n     */\r\n    addShapeDefinition: function addShapeDefinition(shape, opt, target) {\r\n      var resultObject = {};\r\n      var options = ( typeof opt === 'object' ? opt : {} );\r\n\r\n      if ( !shape || typeof shape !== 'object' ) {\r\n        console.log('ERROR: Missing/Invalid shape parameter! Example: `addShape(pptx.shapes.LINE, {x:1, y:1, w:1, h:1});` ');\r\n        return;\r\n      }\r\n\r\n      resultObject.type = 'text';\r\n      resultObject.options = options;\r\n      options.shape     = shape;\r\n      options.x         = ( options.x || (options.x == 0 ? 0 : 1) );\r\n      options.y         = ( options.y || (options.y == 0 ? 0 : 1) );\r\n      options.w         = ( options.w || 1.0 );\r\n      options.h         = ( options.h || (shape.name == 'line' ? 0 : 1.0) );\r\n      options.line      = ( options.line || (shape.name == 'line' ? '333333' : null) );\r\n      options.line_size = ( options.line_size || (shape.name == 'line' ? 1 : null) );\r\n      if ( ['dash','dashDot','lgDash','lgDashDot','lgDashDotDot','solid','sysDash','sysDot'].indexOf(options.line_dash || '') < 0 ) options.line_dash = 'solid';\r\n\r\n      target.data.push(resultObject);\r\n      return resultObject;\r\n    },\r\n\r\n    /**\r\n     * Adds an image object to a slide definition.\r\n     * This method can be called with only two args (opt, target) - this is supposed to be the only way in future.\r\n     * @param {String|Object} strImagePath image path or object options\r\n     * @param {Number|Object} intPosX x-position or slide object that the image should be addded to\r\n     * @param {Number} intPosY\r\n     * @param {Number} intSizeX\r\n     * @param {Number} intWidth\r\n     * @param {Number} intHeight\r\n     * @param {String} strImageData base64 encoded representation of the image\r\n     * @param {Object} target slide that the image should be added to (if not specified as the 2nd arg)\r\n     * @return {Object} image object\r\n     */\r\n    addImageDefinition: function addImageDefinition(strImagePath, intPosX, intPosY, intWidth, intHeight, strImageData, target) {\r\n      var resultObject = {};\r\n      var sizing = null;\r\n      // FIRST: Set vars for this image (object param replaces positional args in 1.1.0)\r\n      // FIXME: FUTURE: DEPRECATED: Only allow object param in 1.5 or 2.0\r\n      if ( typeof strImagePath === 'object' ) {\r\n        target = intPosX; // if the opts are an object, the second arg is supposed to be a target\r\n        intPosX = (strImagePath.x || 0);\r\n        intPosY = (strImagePath.y || 0);\r\n        intWidth = (strImagePath.cx || strImagePath.w || 0);\r\n        intHeight = (strImagePath.cy || strImagePath.h || 0);\r\n        sizing = strImagePath.sizing || null;\r\n        var objHyperlink = (strImagePath.hyperlink || '');\r\n        strImageData = (strImagePath.data || '');\r\n        strImagePath = (strImagePath.path || ''); // IMPORTANT: This line must be last as were about to ovewrite ourself!\r\n      }\r\n\r\n      var imageRelId = target.rels.length + 1;\r\n\r\n      // REALITY-CHECK:\r\n      if ( !strImagePath && !strImageData ) {\r\n        console.error('ERROR: `addImage()` requires either \\'data\\' or \\'path\\' parameter!');\r\n        return null;\r\n      }\r\n      else if ( strImageData && strImageData.toLowerCase().indexOf('base64,') == -1 ) {\r\n        console.error('ERROR: Image `data` value lacks a base64 header! Ex: \\'image/png;base64,NMP[...]\\')');\r\n        return null;\r\n      }\r\n\r\n      // Every image encoded via canvas>base64 is png (as of early 2017 no browser will produce other mime types)\r\n      var strImgExtn = 'png';\r\n      // However, pre-encoded images can be whatever mime-type they want (and good for them!)\r\n      if ( strImageData && /image\\/(\\w+)\\;/.exec(strImageData) && /image\\/(\\w+)\\;/.exec(strImageData).length > 0 ) {\r\n        strImgExtn = /image\\/(\\w+)\\;/.exec(strImageData)[1];\r\n      }\r\n\r\n      resultObject.type  = 'image';\r\n      resultObject.image = (strImagePath || 'preencoded.png');\r\n\r\n      // STEP 3: Set image properties & options\r\n      // FIXME: Measure actual image when no intWidth/intHeight params passed\r\n      // ....: This is an async process: we need to make getSizeFromImage use callback, then set H/W...\r\n      // if ( !intWidth || !intHeight ) { var imgObj = getSizeFromImage(strImagePath);\r\n      var imgObj = { width:1, height:1 };\r\n      resultObject.options = {\r\n        x: (intPosX  || 0),\r\n        y: (intPosY  || 0),\r\n        cx: (intWidth || imgObj.width),\r\n        cy: (intHeight || imgObj.height),\r\n        sizing: sizing\r\n      };\r\n\r\n      // STEP 4: Add this image to this Slide Rels (rId/rels count spans all slides! Count all images to get next rId)\r\n      target.rels.push({\r\n        path: (strImagePath || 'preencoded'+strImgExtn),\r\n        type: 'image/'+strImgExtn,\r\n        extn: strImgExtn,\r\n        data: (strImageData || ''),\r\n        rId:  imageRelId,\r\n        Target: '../media/image'+ (++gObjPptx.imageCounter) +'.'+ strImgExtn\r\n      });\r\n      resultObject.imageRid = imageRelId;\r\n\r\n      // STEP 5: (Issue#77) Hyperlink support\r\n      if ( typeof objHyperlink === 'object' ) {\r\n        if ( !objHyperlink.url || typeof objHyperlink.url !== 'string' ) console.log('ERROR: \\'hyperlink.url is required and/or should be a string\\'');\r\n        else {\r\n          var intRelId = imageRelId + 1;\r\n\r\n          target.rels.push({\r\n            type: 'hyperlink',\r\n            data: 'dummy',\r\n            rId:  intRelId,\r\n            Target: objHyperlink.url\r\n          });\r\n\r\n          objHyperlink.rId = intRelId;\r\n          resultObject.hyperlink = objHyperlink;\r\n        }\r\n      }\r\n\r\n      target.data.push(resultObject);\r\n      return resultObject;\r\n    },\r\n\r\n    /**\r\n     * Generate the chart based on input data.\r\n     * OOXML Chart Spec: ISO/IEC 29500-1:2016(E)\r\n     *\r\n     * @param {object} type should belong to: 'column', 'pie'\r\n     * @param {object} data a JSON object with follow the following format\r\n     * @param {object} opt\r\n     * @param {object} target slide object that the chart should be added to\r\n     * @return {Object} chart object\r\n     * {\r\n     *   title: 'eSurvey chart',\r\n     *   data: [\r\n     *    {\r\n     *      name: 'Income',\r\n     *      labels: ['2005', '2006', '2007', '2008', '2009'],\r\n     *      values: [23.5, 26.2, 30.1, 29.5, 24.6]\r\n     *    },\r\n     *    {\r\n     *      name: 'Expense',\r\n     *      labels: ['2005', '2006', '2007', '2008', '2009'],\r\n     *      values: [18.1, 22.8, 23.9, 25.1, 25]\r\n     *    }\r\n     *   ]\r\n     *  }\r\n     */\r\n    addChartDefinition: function addChartDefinition(type, data, opt, target) {\r\n      var targetRels = target.rels;\r\n      var chartId = (++gObjPptx.chartCounter);\r\n      var chartRelId = target.rels.length + 1;\r\n      var resultObject = {};\r\n      // DESIGN: `type` can an object (ex: `pptx.charts.DOUGHNUT`) or an array of chart objects\r\n      // EX: addChartDefinition([ { type:pptx.charts.BAR, data:{name:'', labels:[], values[]} }, {<etc>} ])\r\n      // Multi-Type Charts\r\n      var tmpOpt;\r\n      var tmpData = [], options;\r\n      if (Array.isArray(type)) {\r\n        // For multi-type charts there needs to be data for each type,\r\n        // as well as a single data source for non-series operations.\r\n        // The data is indexed below to keep the data in order when segmented\r\n        // into types.\r\n        type.forEach(function(obj) {\r\n          tmpData = tmpData.concat(obj.data);\r\n        });\r\n        tmpOpt = data || opt;\r\n      }\r\n      else {\r\n        tmpData = data;\r\n        tmpOpt = opt;\r\n      }\r\n      tmpData.forEach(function(item,i){ item.index = i; });\r\n      options = ( tmpOpt && typeof tmpOpt === 'object' ? tmpOpt : {} );\r\n\r\n      // STEP 1: TODO: check for reqd fields, correct type, etc\r\n      // `type` exists in CHART_TYPES\r\n      // Array.isArray(data)\r\n      /*\r\n      if ( Array.isArray(rel.data) && rel.data.length > 0 && typeof rel.data[0] === 'object'\r\n        && rel.data[0].labels && Array.isArray(rel.data[0].labels)\r\n        && rel.data[0].values && Array.isArray(rel.data[0].values) ) {\r\n        obj = rel.data[0];\r\n      }\r\n      else {\r\n        console.warn(\"USAGE: addChart( 'pie', [ {name:'Sales', labels:['Jan','Feb'], values:[10,20]} ], {x:1, y:1} )\");\r\n        return;\r\n      }\r\n      */\r\n\r\n      // STEP 2: Set default options/decode user options\r\n      // A: Core\r\n      options.type = type;\r\n      options.x = (typeof options.x !== 'undefined' && options.x != null && !isNaN(options.x) ? options.x : 1);\r\n      options.y = (typeof options.y !== 'undefined' && options.y != null && !isNaN(options.y) ? options.y : 1);\r\n      options.w = (options.w || '50%');\r\n      options.h = (options.h || '50%');\r\n\r\n      // B: Options: misc\r\n      if ( ['bar','col'].indexOf(options.barDir || '') < 0 ) options.barDir = 'col';\r\n      // IMPORTANT: 'bestFit' will cause issues with PPT-Online in some cases, so defualt to 'ctr'!\r\n      if ( ['bestFit','b','ctr','inBase','inEnd','l','outEnd','r','t'].indexOf(options.dataLabelPosition || '') < 0 ) options.dataLabelPosition = (options.type.name == 'pie' || options.type.name == 'doughnut' ? 'bestFit' : 'ctr');\r\n      if ( ['b','l','r','t','tr'].indexOf(options.legendPos || '') < 0 ) options.legendPos = 'r';\r\n      // barGrouping: \"21.2.3.17 ST_Grouping (Grouping)\"\r\n      if ( ['clustered','standard','stacked','percentStacked'].indexOf(options.barGrouping || '') < 0 ) options.barGrouping = 'standard';\r\n      if ( options.barGrouping.indexOf('tacked') > -1 ) {\r\n        options.dataLabelPosition = 'ctr'; // IMPORTANT: PPT-Online will not open Presentation when 'outEnd' etc is used on stacked!\r\n        if (!options.barGapWidthPct) options.barGapWidthPct = 50;\r\n      }\r\n      // lineDataSymbol: http://www.datypic.com/sc/ooxml/a-val-32.html\r\n      // Spec has [plus,star,x] however neither PPT2013 nor PPT-Online support them\r\n      if ( ['circle','dash','diamond','dot','none','square','triangle'].indexOf(options.lineDataSymbol || '') < 0 ) options.lineDataSymbol = 'circle';\r\n      options.lineDataSymbolSize = ( options.lineDataSymbolSize && !isNaN(options.lineDataSymbolSize ) ? options.lineDataSymbolSize : 6 );\r\n      options.lineDataSymbolLineSize = ( options.lineDataSymbolLineSize && !isNaN(options.lineDataSymbolLineSize ) ? options.lineDataSymbolLineSize * ONEPT : 0.75 * ONEPT );\r\n      // `layout` allows the override of PPT defaults to maximize space\r\n      if ( options.layout ) {\r\n        ['x', 'y', 'w', 'h'].forEach(function(key) {\r\n          var val = options.layout[key];\r\n          if (isNaN(Number(val)) || val < 0 || val > 1) {\r\n            console.warn('Warning: chart.layout.' + key + ' can only be 0-1');\r\n            delete options.layout[key]; // remove invalid value so that default will be used\r\n          }\r\n        });\r\n      }\r\n\r\n      // use default lines only for y-axis if nothing specified\r\n      options.valGridLine = options.valGridLine || {};\r\n      options.catGridLine = options.catGridLine || 'none';\r\n      correctGridLineOptions(options.catGridLine);\r\n      correctGridLineOptions(options.valGridLine);\r\n\r\n      if ( options.lineShadow ) {\r\n        console.warn('`lineShadow` is deprecated - please switch to `shadow`');\r\n        options.shadow = options.lineShadow;\r\n      }\r\n\r\n      correctShadowOptions(options.shadow);\r\n\r\n      // C: Options: plotArea\r\n      options.showDataTable           = (options.showDataTable           == true || options.showDataTable           == false ? options.showDataTable           : false);\r\n      options.showDataTableHorzBorder = (options.showDataTableHorzBorder == true || options.showDataTableHorzBorder == false ? options.showDataTableHorzBorder : true );\r\n      options.showDataTableVertBorder = (options.showDataTableVertBorder == true || options.showDataTableVertBorder == false ? options.showDataTableVertBorder : true );\r\n      options.showDataTableOutline    = (options.showDataTableOutline    == true || options.showDataTableOutline    == false ? options.showDataTableOutline    : true );\r\n      options.showDataTableKeys       = (options.showDataTableKeys       == true || options.showDataTableKeys       == false ? options.showDataTableKeys       : true );\r\n      options.showLabel     = (options.showLabel     == true || options.showLabel     == false ? options.showLabel     : false);\r\n      options.showLegend    = (options.showLegend    == true || options.showLegend    == false ? options.showLegend    : false);\r\n      options.showPercent   = (options.showPercent   == true || options.showPercent   == false ? options.showPercent   : true );\r\n      options.showTitle     = (options.showTitle     == true || options.showTitle     == false ? options.showTitle     : false);\r\n      options.showValue     = (options.showValue     == true || options.showValue     == false ? options.showValue     : false);\r\n\r\n      // D: Options: chart\r\n      options.barGapWidthPct = (!isNaN(options.barGapWidthPct) && options.barGapWidthPct >= 0 && options.barGapWidthPct <= 1000 ? options.barGapWidthPct : 150);\r\n      options.chartColors = ( Array.isArray(options.chartColors) ? options.chartColors : (options.type == 'pie' || options.type == 'doughnut' ? PIECHART_COLORS : BARCHART_COLORS) );\r\n      options.chartColorsOpacity = ( options.chartColorsOpacity && !isNaN(options.chartColorsOpacity) ? options.chartColorsOpacity : null );\r\n      //\r\n      options.border = ( options.border && typeof options.border === 'object' ? options.border : null );\r\n      if ( options.border && (!options.border.pt || isNaN(options.border.pt)) ) options.border.pt = 1;\r\n      if ( options.border && (!options.border.color || typeof options.border.color !== 'string' || options.border.color.length != 6) ) options.border.color = '363636';\r\n      //\r\n      options.dataBorder = ( options.dataBorder && typeof options.dataBorder === 'object' ? options.dataBorder : null );\r\n      if ( options.dataBorder && (!options.dataBorder.pt || isNaN(options.dataBorder.pt)) ) options.dataBorder.pt = 0.75;\r\n      if ( options.dataBorder && (!options.dataBorder.color || typeof options.dataBorder.color !== 'string' || options.dataBorder.color.length != 6) ) options.dataBorder.color = 'F9F9F9';\r\n      //\r\n      options.dataLabelFormatCode = options.dataLabelFormatCode && typeof options.dataLabelFormatCode === 'string' ? options.dataLabelFormatCode : (options.type.name == 'pie' || options.type.name == 'doughnut') ? '0%' : '#,##0';\r\n      //\r\n      options.lineSize = ( typeof options.lineSize === 'number' ? options.lineSize : 2 );\r\n      options.valAxisMajorUnit = ( typeof options.valAxisMajorUnit === 'number' ? options.valAxisMajorUnit : null );\r\n\r\n      // STEP 4: Set props\r\n      resultObject.type    = 'chart';\r\n      resultObject.options = options;\r\n\r\n      // STEP 5: Add this chart to this Slide Rels (rId/rels count spans all slides! Count all images to get next rId)\r\n      targetRels.push({\r\n        rId:     chartRelId,\r\n        data:    tmpData,\r\n        opts:    options,\r\n        type:    'chart',\r\n        globalId: chartId,\r\n        fileName:'chart'+ chartId +'.xml',\r\n        Target:  '/ppt/charts/chart'+ chartId +'.xml'\r\n      });\r\n      resultObject.chartRid = chartRelId;\r\n\r\n      target.data.push(resultObject);\r\n      return resultObject;\r\n    },\r\n\r\n    /* ===== */\r\n\r\n    /**\r\n     * Transforms a slide definition to a slide object that is then passed to the XML transformation process.\r\n     * The following object is expected as a slide definition:\r\n     * {\r\n     *   bkgd: 'FF00FF',\r\n     *   objects: [{\r\n     *     text: {\r\n     *       text: 'Hello World',\r\n     *       x: 1,\r\n     *       y: 1\r\n     *     }\r\n     *   }]\r\n     * }\r\n     * @param {Object} slideDef slide definition\r\n     * @param {Object} target empty slide object that should be updated by the passed definition\r\n     *\r\n     */\r\n    createSlideObject: function createSlideObject(slideDef, target) {\r\n      // STEP 1: Add background\r\n      if ( slideDef.bkgd ) {\r\n        gObjPptxGenerators.addBackgroundDefinition(slideDef.bkgd, target);\r\n      }\r\n\r\n      // STEP 2: Add all Slide Master objects in the order they were given (Issue#53)\r\n      if ( slideDef.objects && Array.isArray(slideDef.objects) && slideDef.objects.length > 0 ) {\r\n        slideDef.objects.forEach(function(object){\r\n          var key = Object.keys(object)[0];\r\n          if      ( MASTER_OBJECTS[key] && key == 'chart' ) gObjPptxGenerators.addChartDefinition(CHART_TYPES[(object.chart.type||'').toUpperCase()], object.chart.data, object.chart.opts, target);\r\n          else if ( MASTER_OBJECTS[key] && key == 'image' ) gObjPptxGenerators.addImageDefinition(object[key], target);\r\n          else if ( MASTER_OBJECTS[key] && key == 'line'  ) gObjPptxGenerators.addShapeDefinition(gObjPptxShapes.LINE, object[key], target);\r\n          else if ( MASTER_OBJECTS[key] && key == 'rect'  ) gObjPptxGenerators.addShapeDefinition(gObjPptxShapes.RECTANGLE, object[key], target);\r\n          else if ( MASTER_OBJECTS[key] && key == 'text'  ) gObjPptxGenerators.addTextDefinition(object[key].text, object[key].options, target);\r\n        });\r\n      }\r\n\r\n      // STEP 3: Add Slide Numbers (NOTE: Do this last so numbers are not covered by objects!)\r\n      if ( slideDef.slideNumber && typeof slideDef.slideNumber === 'object' ) {\r\n        target.slideNumberObj = slideDef.slideNumber;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Transforms a slide object to resulting XML string.\r\n     * @param {Object} slideObject slide object created within gObjPptxGenerators.createSlideObject\r\n     * @return {String} XML string with <p:cSld> as the root\r\n     */\r\n    slideObjectToXml: function slideObjectToXml(slideObject) {\r\n      var strSlideXml = slideObject.name ? '<p:cSld name=\"'+ slideObject.name +'\">' : '<p:cSld>';\r\n      var intTableNum = 1;\r\n\r\n      // Background color\r\n      if ( slideObject.slide.back ) {\r\n        strSlideXml += genXmlColorSelection(false, slideObject.slide.back);\r\n      }\r\n      // B: Add background image (using Strech) (if any)\r\n      if ( slideObject.slide.bkgdImgRid ) {\r\n        // FIXME: We should be doing this in the slideLayout...\r\n        strSlideXml += '<p:bg>'\r\n            + '<p:bgPr><a:blipFill dpi=\"0\" rotWithShape=\"1\">'\r\n            + '<a:blip r:embed=\"rId'+ slideObject.slide.bkgdImgRid +'\"><a:lum/></a:blip>'\r\n            + '<a:srcRect/><a:stretch><a:fillRect/></a:stretch></a:blipFill>'\r\n            + '<a:effectLst/></p:bgPr>'\r\n          + '</p:bg>';\r\n      }\r\n\r\n      // STEP 3: Continue slide by starting spTree node\r\n      strSlideXml += '<p:spTree>';\r\n      strSlideXml += '<p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/><p:nvPr/></p:nvGrpSpPr>';\r\n      strSlideXml += '<p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"0\" cy=\"0\"/>';\r\n      strSlideXml += '<a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/></a:xfrm></p:grpSpPr>';\r\n\r\n      // STEP 4: Loop over all Slide.data objects and add them to this slide ===============================\r\n      slideObject.data.forEach(function(slideItemObj, idx) {\r\n        var x = 0, y = 0, cx = getSmartParseNumber('75%','X'), cy = 0;\r\n        var locationAttr = '', shapeType = null;\r\n\r\n        // A: Set option vars\r\n        slideItemObj.options = slideItemObj.options || {};\r\n\r\n        if ( slideItemObj.options.w  || slideItemObj.options.w  == 0 ) slideItemObj.options.cx = slideItemObj.options.w;\r\n        if ( slideItemObj.options.h  || slideItemObj.options.h  == 0 ) slideItemObj.options.cy = slideItemObj.options.h;\r\n        //\r\n        if ( slideItemObj.options.x  || slideItemObj.options.x  == 0 )  x = getSmartParseNumber( slideItemObj.options.x , 'X' );\r\n        if ( slideItemObj.options.y  || slideItemObj.options.y  == 0 )  y = getSmartParseNumber( slideItemObj.options.y , 'Y' );\r\n        if ( slideItemObj.options.cx || slideItemObj.options.cx == 0 ) cx = getSmartParseNumber( slideItemObj.options.cx, 'X' );\r\n        if ( slideItemObj.options.cy || slideItemObj.options.cy == 0 ) cy = getSmartParseNumber( slideItemObj.options.cy, 'Y' );\r\n        //\r\n        if ( slideItemObj.options.shape  ) shapeType = getShapeInfo( slideItemObj.options.shape );\r\n        //\r\n        if ( slideItemObj.options.flipH  ) locationAttr += ' flipH=\"1\"';\r\n        if ( slideItemObj.options.flipV  ) locationAttr += ' flipV=\"1\"';\r\n        if ( slideItemObj.options.rotate ) locationAttr += ' rot=\"' + convertRotationDegrees(slideItemObj.options.rotate)+ '\"';\r\n\r\n        // B: Add OBJECT to current Slide ----------------------------\r\n        switch ( slideItemObj.type ) {\r\n        case 'table':\r\n          // FIRST: Ensure we have rows - otherwise, bail!\r\n          if ( !slideItemObj.arrTabRows || (Array.isArray(slideItemObj.arrTabRows) && slideItemObj.arrTabRows.length == 0) ) break;\r\n\r\n          // Set table vars\r\n          var objTableGrid = {};\r\n          var arrTabRows = slideItemObj.arrTabRows;\r\n          var objTabOpts = slideItemObj.options;\r\n          var intColCnt = 0, intColW = 0;\r\n\r\n          // Calc number of columns\r\n          // NOTE: Cells may have a colspan, so merely taking the length of the [0] (or any other) row is not\r\n          // ....: sufficient to determine column count. Therefore, check each cell for a colspan and total cols as reqd\r\n          arrTabRows[0].forEach(function(cell){\r\n            var cellOpts = cell.options || cell.opts || null; // DEPRECATED (`opts`)\r\n            intColCnt += ( cellOpts && cellOpts.colspan ? cellOpts.colspan : 1 );\r\n          });\r\n\r\n          // STEP 1: Start Table XML =============================\r\n          // NOTE: Non-numeric cNvPr id values will trigger \"presentation needs repair\" type warning in MS-PPT-2013\r\n          var strXml = '<p:graphicFrame>'\r\n                + '  <p:nvGraphicFramePr>'\r\n                + '    <p:cNvPr id=\"'+ (intTableNum*slideObject.numb + 1) +'\" name=\"Table '+ (intTableNum*slideObject.numb) +'\"/>'\r\n                + '    <p:cNvGraphicFramePr><a:graphicFrameLocks noGrp=\"1\"/></p:cNvGraphicFramePr>'\r\n                + '    <p:nvPr><p:extLst><p:ext uri=\"{D42A27DB-BD31-4B8C-83A1-F6EECF244321}\"><p14:modId xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"1579011935\"/></p:ext></p:extLst></p:nvPr>'\r\n                + '  </p:nvGraphicFramePr>'\r\n                + '  <p:xfrm>'\r\n                + '    <a:off  x=\"'+ (x  || EMU) +'\"  y=\"'+ (y  || EMU) +'\"/>'\r\n                + '    <a:ext cx=\"'+ (cx || EMU) +'\" cy=\"'+ (cy || EMU) +'\"/>'\r\n                + '  </p:xfrm>'\r\n                + '  <a:graphic>'\r\n                + '    <a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/table\">'\r\n                + '      <a:tbl>'\r\n                + '        <a:tblPr/>';\r\n          // + '        <a:tblPr bandRow=\"1\"/>';\r\n\r\n            // FIXME: Support banded rows, first/last row, etc.\r\n            // NOTE: Banding, etc. only shows when using a table style! (or set alt row color if banding)\r\n            // <a:tblPr firstCol=\"0\" firstRow=\"0\" lastCol=\"0\" lastRow=\"0\" bandCol=\"0\" bandRow=\"1\">\r\n\r\n            // STEP 2: Set column widths\r\n            // Evenly distribute cols/rows across size provided when applicable (calc them if only overall dimensions were provided)\r\n            // A: Col widths provided?\r\n          if ( Array.isArray(objTabOpts.colW) ) {\r\n            strXml += '<a:tblGrid>';\r\n            for ( var col=0; col<intColCnt; col++ ) {\r\n              strXml += '  <a:gridCol w=\"'+ Math.round(inch2Emu(objTabOpts.colW[col]) || (slideItemObj.options.cx/intColCnt)) +'\"/>';\r\n            }\r\n            strXml += '</a:tblGrid>';\r\n          }\r\n          // B: Table Width provided without colW? Then distribute cols\r\n          else {\r\n            intColW = ( objTabOpts.colW ? objTabOpts.colW : EMU );\r\n            if ( slideItemObj.options.cx && !objTabOpts.colW ) intColW = Math.round( slideItemObj.options.cx / intColCnt ); // FIX: Issue#12\r\n            strXml += '<a:tblGrid>';\r\n            for ( col=0; col<intColCnt; col++ ) { strXml += '<a:gridCol w=\"'+ intColW +'\"/>'; }\r\n            strXml += '</a:tblGrid>';\r\n          }\r\n\r\n          // STEP 3: Build our row arrays into an actual grid to match the XML we will be building next (ISSUE #36)\r\n          // Note row arrays can arrive \"lopsided\" as in row1:[1,2,3] row2:[3] when first two cols rowspan!,\r\n          // so a simple loop below in XML building wont suffice to build table right.\r\n          // We have to build an actual grid now\r\n          /*\r\n              EX: (A0:rowspan=3, B1:rowspan=2, C1:colspan=2)\r\n\r\n              /------|------|------|------\\\r\n              |  A0  |  B0  |  C0  |  D0  |\r\n              |      |  B1  |  C1  |      |\r\n              |      |      |  C2  |  D2  |\r\n              \\------|------|------|------/\r\n            */\r\n          $$.each(arrTabRows, function(rIdx,row){\r\n            // A: Create row if needed (recall one may be created in loop below for rowspans, so dont assume we need to create one each iteration)\r\n            if ( !objTableGrid[rIdx] ) objTableGrid[rIdx] = {};\r\n\r\n            // B: Loop over all cells\r\n            $$(row).each(function(cIdx,cell){\r\n              // DESIGN: NOTE: Row cell arrays can be \"uneven\" (diff cell count in each) due to rowspan/colspan\r\n              // Therefore, for each cell we run 0->colCount to determien the correct slot for it to reside\r\n              // as the uneven/mixed nature of the data means we cannot use the cIdx value alone.\r\n              // E.g.: the 2nd element in the row array may actually go into the 5th table grid row cell b/c of colspans!\r\n              for (var idx=0; (cIdx+idx)<intColCnt; idx++) {\r\n                var currColIdx = (cIdx + idx);\r\n\r\n                if ( !objTableGrid[rIdx][currColIdx] ) {\r\n                  // A: Set this cell\r\n                  objTableGrid[rIdx][currColIdx] = cell;\r\n\r\n                  // B: Handle `colspan` or `rowspan` (a {cell} cant have both! FIXME: FUTURE: ROWSPAN & COLSPAN in same cell)\r\n                  if ( cell && cell.opts && cell.opts.colspan && !isNaN(Number(cell.opts.colspan)) ) {\r\n                    for (var idy=1; idy<Number(cell.opts.colspan); idy++) {\r\n                      objTableGrid[rIdx][currColIdx+idy] = {'hmerge':true, text:'hmerge'};\r\n                    }\r\n                  }\r\n                  else if ( cell && cell.opts && cell.opts.rowspan && !isNaN(Number(cell.opts.rowspan)) ) {\r\n                    for (var idz=1; idz<Number(cell.opts.rowspan); idz++) {\r\n                      if ( !objTableGrid[rIdx+idz] ) objTableGrid[rIdx+idz] = {};\r\n                      objTableGrid[rIdx+idz][currColIdx] = {'vmerge':true, text:'vmerge'};\r\n                    }\r\n                  }\r\n\r\n                  // C: Break out of colCnt loop now that slot has been filled\r\n                  break;\r\n                }\r\n              }\r\n            });\r\n          });\r\n          /* Only useful for rowspan/colspan testing\r\n            if ( objTabOpts.debug ) {\r\n              console.table(objTableGrid);\r\n              var arrText = [];\r\n              $$.each(objTableGrid, function(i,row){ var arrRow = []; $$.each(row,function(i,cell){ arrRow.push(cell.text); }); arrText.push(arrRow); });\r\n              console.table( arrText );\r\n            }\r\n            */\r\n\r\n          // STEP 4: Build table rows/cells ============================\r\n          $$.each(objTableGrid, function(rIdx,rowObj){\r\n            // A: Table Height provided without rowH? Then distribute rows\r\n            var intRowH = 0; // IMPORTANT: Default must be zero for auto-sizing to work\r\n            if ( Array.isArray(objTabOpts.rowH) && objTabOpts.rowH[rIdx] ) intRowH = inch2Emu(Number(objTabOpts.rowH[rIdx]));\r\n            else if ( objTabOpts.rowH && !isNaN(Number(objTabOpts.rowH)) ) intRowH = inch2Emu(Number(objTabOpts.rowH));\r\n            else if ( slideItemObj.options.cy || slideItemObj.options.h ) intRowH = ( slideItemObj.options.h ? inch2Emu(slideItemObj.options.h) : slideItemObj.options.cy) / arrTabRows.length;\r\n\r\n            // B: Start row\r\n            strXml += '<a:tr h=\"'+ intRowH +'\">';\r\n\r\n            // C: Loop over each CELL\r\n            $$.each(rowObj, function(cIdx,cell){\r\n              // 1: \"hmerge\" cells are just place-holders in the table grid - skip those and go to next cell\r\n              if ( cell.hmerge ) return;\r\n\r\n              // 2: OPTIONS: Build/set cell options ===========================\r\n              {\r\n                var cellOpts = cell.options || cell.opts || {};\r\n                if ( typeof cell === 'number' || typeof cell === 'string' ) cell = { text:cell.toString() };\r\n                cellOpts.isTableCell = true; // Used to create textBody XML\r\n                cell.options = cellOpts;\r\n\r\n                // B: Apply default values (tabOpts being used when cellOpts dont exist):\r\n                // SEE: http://officeopenxml.com/drwTableCellProperties-alignment.php\r\n                ['align','bold','border','color','fill','font_face','font_size','margin','marginPt','underline','valign']\r\n                  .forEach(function(name){\r\n                    if ( objTabOpts[name] && !cellOpts[name] && cellOpts[name] != 0 ) cellOpts[name] = objTabOpts[name];\r\n                  });\r\n\r\n                var cellValign  = (cellOpts.valign)     ? ' anchor=\"'+ cellOpts.valign.replace(/^c$/i,'ctr').replace(/^m$/i,'ctr').replace('center','ctr').replace('middle','ctr').replace('top','t').replace('btm','b').replace('bottom','b') +'\"' : '';\r\n                var cellColspan = (cellOpts.colspan)    ? ' gridSpan=\"'+ cellOpts.colspan +'\"' : '';\r\n                var cellRowspan = (cellOpts.rowspan)    ? ' rowSpan=\"'+ cellOpts.rowspan +'\"' : '';\r\n                var cellFill    = ((cell.optImp && cell.optImp.fill)  || cellOpts.fill ) ? ' <a:solidFill><a:srgbClr val=\"'+ ((cell.optImp && cell.optImp.fill) || cellOpts.fill.replace('#','')) +'\"/></a:solidFill>' : '';\r\n                var cellMargin  = ( cellOpts.margin == 0 || cellOpts.margin ? cellOpts.margin : (cellOpts.marginPt || DEF_CELL_MARGIN_PT) );\r\n                if ( !Array.isArray(cellMargin) && typeof cellMargin === 'number' ) cellMargin = [cellMargin,cellMargin,cellMargin,cellMargin];\r\n                cellMargin = ' marL=\"'+ cellMargin[3]*ONEPT +'\" marR=\"'+ cellMargin[1]*ONEPT +'\" marT=\"'+ cellMargin[0]*ONEPT +'\" marB=\"'+ cellMargin[2]*ONEPT +'\"';\r\n              }\r\n\r\n              // FIXME: Cell NOWRAP property (text wrap: add to a:tcPr (horzOverflow=\"overflow\" or whatev opts exist)\r\n\r\n              // 3: ROWSPAN: Add dummy cells for any active rowspan\r\n              if ( cell.vmerge ) {\r\n                strXml += '<a:tc vMerge=\"1\"><a:tcPr/></a:tc>';\r\n                return;\r\n              }\r\n\r\n              // 4: Set CELL content and properties ==================================\r\n              strXml += '<a:tc'+ cellColspan + cellRowspan +'>' + genXmlTextBody(cell) + '<a:tcPr'+ cellMargin + cellValign +'>';\r\n\r\n              // 5: Borders: Add any borders\r\n              if ( cellOpts.border && typeof cellOpts.border === 'string' && cellOpts.border.toLowerCase() == 'none' ) {\r\n                strXml += '  <a:lnL w=\"0\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:noFill/></a:lnL>';\r\n                strXml += '  <a:lnR w=\"0\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:noFill/></a:lnR>';\r\n                strXml += '  <a:lnT w=\"0\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:noFill/></a:lnT>';\r\n                strXml += '  <a:lnB w=\"0\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:noFill/></a:lnB>';\r\n              }\r\n              else if ( cellOpts.border && typeof cellOpts.border === 'string' ) {\r\n                strXml += '  <a:lnL w=\"'+ ONEPT +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:srgbClr val=\"'+ cellOpts.border +'\"/></a:solidFill></a:lnL>';\r\n                strXml += '  <a:lnR w=\"'+ ONEPT +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:srgbClr val=\"'+ cellOpts.border +'\"/></a:solidFill></a:lnR>';\r\n                strXml += '  <a:lnT w=\"'+ ONEPT +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:srgbClr val=\"'+ cellOpts.border +'\"/></a:solidFill></a:lnT>';\r\n                strXml += '  <a:lnB w=\"'+ ONEPT +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:srgbClr val=\"'+ cellOpts.border +'\"/></a:solidFill></a:lnB>';\r\n              }\r\n              else if ( cellOpts.border && Array.isArray(cellOpts.border) ) {\r\n                $$.each([ {idx:3,name:'lnL'}, {idx:1,name:'lnR'}, {idx:0,name:'lnT'}, {idx:2,name:'lnB'} ], function(i,obj){\r\n                  if ( cellOpts.border[obj.idx] ) {\r\n                    var strC = '<a:solidFill><a:srgbClr val=\"'+ ((cellOpts.border[obj.idx].color) ? cellOpts.border[obj.idx].color : DEF_CELL_BORDER.color) +'\"/></a:solidFill>';\r\n                    var intW = (cellOpts.border[obj.idx] && (cellOpts.border[obj.idx].pt || cellOpts.border[obj.idx].pt == 0)) ? (ONEPT * Number(cellOpts.border[obj.idx].pt)) : ONEPT;\r\n                    strXml += '<a:'+ obj.name +' w=\"'+ intW +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">'+ strC +'</a:'+ obj.name +'>';\r\n                  }\r\n                  else strXml += '<a:'+ obj.name +' w=\"0\"><a:miter lim=\"400000\" /></a:'+ obj.name +'>';\r\n                });\r\n              }\r\n              else if ( cellOpts.border && typeof cellOpts.border === 'object' ) {\r\n                var intW = (cellOpts.border && (cellOpts.border.pt || cellOpts.border.pt == 0) ) ? (ONEPT * Number(cellOpts.border.pt)) : ONEPT;\r\n                var strClr = '<a:solidFill><a:srgbClr val=\"'+ ((cellOpts.border.color) ? cellOpts.border.color.replace('#','') : DEF_CELL_BORDER.color) +'\"/></a:solidFill>';\r\n                var strAttr = '<a:prstDash val=\"';\r\n                strAttr += ((cellOpts.border.type && cellOpts.border.type.toLowerCase().indexOf('dash') > -1) ? 'sysDash' : 'solid' );\r\n                strAttr += '\"/><a:round/><a:headEnd type=\"none\" w=\"med\" len=\"med\"/><a:tailEnd type=\"none\" w=\"med\" len=\"med\"/>';\r\n                // *** IMPORTANT! *** LRTB order matters! (Reorder a line below to watch the borders go wonky in MS-PPT-2013!!)\r\n                strXml += '<a:lnL w=\"'+ intW +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">'+ strClr + strAttr +'</a:lnL>';\r\n                strXml += '<a:lnR w=\"'+ intW +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">'+ strClr + strAttr +'</a:lnR>';\r\n                strXml += '<a:lnT w=\"'+ intW +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">'+ strClr + strAttr +'</a:lnT>';\r\n                strXml += '<a:lnB w=\"'+ intW +'\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">'+ strClr + strAttr +'</a:lnB>';\r\n                // *** IMPORTANT! *** LRTB order matters!\r\n              }\r\n\r\n              // 6: Close cell Properties & Cell\r\n              strXml += cellFill;\r\n              strXml += '  </a:tcPr>';\r\n              strXml += ' </a:tc>';\r\n\r\n              // LAST: COLSPAN: Add a 'merged' col for each column being merged (SEE: http://officeopenxml.com/drwTableGrid.php)\r\n              if ( cellOpts.colspan ) {\r\n                for (var tmp=1; tmp<Number(cellOpts.colspan); tmp++) { strXml += '<a:tc hMerge=\"1\"><a:tcPr/></a:tc>'; }\r\n              }\r\n            });\r\n\r\n            // D: Complete row\r\n            strXml += '</a:tr>';\r\n          });\r\n\r\n          // STEP 5: Complete table\r\n          strXml += '      </a:tbl>';\r\n          strXml += '    </a:graphicData>';\r\n          strXml += '  </a:graphic>';\r\n          strXml += '</p:graphicFrame>';\r\n\r\n          // STEP 6: Set table XML\r\n          strSlideXml += strXml;\r\n\r\n          // LAST: Increment counter\r\n          intTableNum++;\r\n          break;\r\n\r\n        case 'text':\r\n          // Lines can have zero cy, but text should not\r\n          if ( !slideItemObj.options.line && cy == 0 ) cy = (EMU * 0.3);\r\n\r\n          // Margin/Padding/Inset for textboxes\r\n          if ( slideItemObj.options.margin && Array.isArray(slideItemObj.options.margin) ) {\r\n            slideItemObj.options.bodyProp.lIns = (slideItemObj.options.margin[0] * ONEPT || 0);\r\n            slideItemObj.options.bodyProp.rIns = (slideItemObj.options.margin[1] * ONEPT || 0);\r\n            slideItemObj.options.bodyProp.bIns = (slideItemObj.options.margin[2] * ONEPT || 0);\r\n            slideItemObj.options.bodyProp.tIns = (slideItemObj.options.margin[3] * ONEPT || 0);\r\n          }\r\n          else if ( (slideItemObj.options.margin || slideItemObj.options.margin == 0) && Number.isInteger(slideItemObj.options.margin) ) {\r\n            slideItemObj.options.bodyProp.lIns = (slideItemObj.options.margin * ONEPT);\r\n            slideItemObj.options.bodyProp.rIns = (slideItemObj.options.margin * ONEPT);\r\n            slideItemObj.options.bodyProp.bIns = (slideItemObj.options.margin * ONEPT);\r\n            slideItemObj.options.bodyProp.tIns = (slideItemObj.options.margin * ONEPT);\r\n          }\r\n\r\n          if ( shapeType == null ) shapeType = getShapeInfo(null);\r\n\r\n          // A: Start SHAPE =======================================================\r\n          strSlideXml += '<p:sp>';\r\n\r\n          // B: The addition of the \"txBox\" attribute is the sole determiner of if an object is a Shape or Textbox\r\n          strSlideXml += '<p:nvSpPr><p:cNvPr id=\"'+ (idx+2) +'\" name=\"Object '+ (idx+1) +'\"/>';\r\n          strSlideXml += '<p:cNvSpPr' + ((slideItemObj.options && slideItemObj.options.isTextBox) ? ' txBox=\"1\"/><p:nvPr/>' : '/><p:nvPr/>');\r\n          strSlideXml += '</p:nvSpPr>';\r\n          strSlideXml += '<p:spPr><a:xfrm' + locationAttr + '>';\r\n          strSlideXml += '<a:off x=\"'  + x  + '\" y=\"'  + y  + '\"/>';\r\n          strSlideXml += '<a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/></a:xfrm>';\r\n          strSlideXml += '<a:prstGeom prst=\"' + shapeType.name + '\"><a:avLst>'\r\n              + (slideItemObj.options.rectRadius ? '<a:gd name=\"adj\" fmla=\"val '+ Math.round(slideItemObj.options.rectRadius * EMU * 100000 / Math.min(cx, cy)) +'\" />' : '')\r\n              + '</a:avLst></a:prstGeom>';\r\n\r\n          // Option: FILL\r\n          strSlideXml += ( slideItemObj.options.fill ? genXmlColorSelection(slideItemObj.options.fill) : '<a:noFill/>' );\r\n\r\n          // Shape Type: LINE: line color\r\n          if ( slideItemObj.options.line ) {\r\n            strSlideXml += '<a:ln'+ ( slideItemObj.options.line_size ? ' w=\"'+ (slideItemObj.options.line_size*ONEPT) +'\"' : '') +'>';\r\n            strSlideXml += genXmlColorSelection( slideItemObj.options.line );\r\n            if ( slideItemObj.options.line_dash ) strSlideXml += '<a:prstDash val=\"' + slideItemObj.options.line_dash + '\"/>';\r\n            if ( slideItemObj.options.line_head ) strSlideXml += '<a:headEnd type=\"' + slideItemObj.options.line_head + '\"/>';\r\n            if ( slideItemObj.options.line_tail ) strSlideXml += '<a:tailEnd type=\"' + slideItemObj.options.line_tail + '\"/>';\r\n            strSlideXml += '</a:ln>';\r\n          }\r\n\r\n          // EFFECTS > SHADOW: REF: @see http://officeopenxml.com/drwSp-effects.php\r\n          if ( slideItemObj.options.shadow ) {\r\n            slideItemObj.options.shadow.type    = ( slideItemObj.options.shadow.type    || 'outer' );\r\n            slideItemObj.options.shadow.blur    = ( slideItemObj.options.shadow.blur    || 8 ) * ONEPT;\r\n            slideItemObj.options.shadow.offset  = ( slideItemObj.options.shadow.offset  || 4 ) * ONEPT;\r\n            slideItemObj.options.shadow.angle   = ( slideItemObj.options.shadow.angle   || 270 ) * 60000;\r\n            slideItemObj.options.shadow.color   = ( slideItemObj.options.shadow.color   || '000000' );\r\n            slideItemObj.options.shadow.opacity = ( slideItemObj.options.shadow.opacity || 0.75 ) * 100000;\r\n\r\n            strSlideXml += '<a:effectLst>';\r\n            strSlideXml += '<a:'+ slideItemObj.options.shadow.type +'Shdw sx=\"100000\" sy=\"100000\" kx=\"0\" ky=\"0\" ';\r\n            strSlideXml += ' algn=\"bl\" rotWithShape=\"0\" blurRad=\"'+ slideItemObj.options.shadow.blur +'\" ';\r\n            strSlideXml += ' dist=\"'+ slideItemObj.options.shadow.offset +'\" dir=\"'+ slideItemObj.options.shadow.angle +'\">';\r\n            strSlideXml += '<a:srgbClr val=\"'+ slideItemObj.options.shadow.color +'\">';\r\n            strSlideXml += '<a:alpha val=\"'+ slideItemObj.options.shadow.opacity +'\"/></a:srgbClr>';\r\n            strSlideXml += '</a:outerShdw>';\r\n            strSlideXml += '</a:effectLst>';\r\n          }\r\n\r\n          /* FIXME: FUTURE: Text wrapping (copied from MS-PPTX export)\r\n            // Commented out b/c i'm not even sure this works - current code produces text that wraps in shapes and textboxes, so...\r\n            if ( slideItemObj.options.textWrap ) {\r\n              strSlideXml += '<a:extLst>'\r\n                    + '<a:ext uri=\"{C572A759-6A51-4108-AA02-DFA0A04FC94B}\">'\r\n                    + '<ma14:wrappingTextBoxFlag xmlns:ma14=\"http://schemas.microsoft.com/office/mac/drawingml/2011/main\" val=\"1\" />'\r\n                    + '</a:ext>'\r\n                    + '</a:extLst>';\r\n            }\r\n            */\r\n\r\n          // B: Close Shape Properties\r\n          strSlideXml += '</p:spPr>';\r\n\r\n          // Add formatted text\r\n          strSlideXml += genXmlTextBody(slideItemObj);\r\n\r\n          // LAST: Close SHAPE =======================================================\r\n          strSlideXml += '</p:sp>';\r\n          break;\r\n\r\n        case 'image':\r\n          var sizing = slideItemObj.options.sizing,\r\n            width = cx,\r\n            height = cy;\r\n\r\n          strSlideXml += '<p:pic>';\r\n          strSlideXml += '  <p:nvPicPr>';\r\n          strSlideXml += '    <p:cNvPr id=\"'+ (idx + 2) +'\" name=\"Object '+ (idx + 1) +'\" descr=\"'+ slideItemObj.image +'\">';\r\n          if ( slideItemObj.hyperlink ) strSlideXml += '<a:hlinkClick r:id=\"rId'+ slideItemObj.hyperlink.rId +'\" tooltip=\"'+ (slideItemObj.hyperlink.tooltip ? decodeXmlEntities(slideItemObj.hyperlink.tooltip) : '') +'\"/>';\r\n          strSlideXml += '    </p:cNvPr>';\r\n          strSlideXml += '    <p:cNvPicPr><a:picLocks noChangeAspect=\"1\"/></p:cNvPicPr><p:nvPr/>';\r\n          strSlideXml += '  </p:nvPicPr>';\r\n          strSlideXml += '<p:blipFill>';\r\n          strSlideXml += '  <a:blip r:embed=\"rId' + slideItemObj.imageRid + '\" cstate=\"print\"/>';\r\n          if (sizing && sizing.type) {\r\n            var boxW = sizing.w ? getSmartParseNumber(sizing.w, 'X') : cx,\r\n              boxH = sizing.h ? getSmartParseNumber(sizing.h, 'Y') : cy,\r\n              boxX = getSmartParseNumber(sizing.x || 0, 'X'),\r\n              boxY = getSmartParseNumber(sizing.y || 0, 'Y');\r\n\r\n            strSlideXml += gObjPptxGenerators.imageSizingXml[sizing.type]({w: width, h: height}, {w: boxW, h: boxH, x: boxX, y: boxY});\r\n            width = boxW;\r\n            height = boxH;\r\n          }\r\n          else {\r\n            strSlideXml += '  <a:stretch><a:fillRect/></a:stretch>';\r\n          }\r\n          strSlideXml += '</p:blipFill>';\r\n          strSlideXml += '<p:spPr>';\r\n          strSlideXml += ' <a:xfrm' + locationAttr + '>';\r\n          strSlideXml += '  <a:off  x=\"' + x  + '\"  y=\"' + y  + '\"/>';\r\n          strSlideXml += '  <a:ext cx=\"' + width + '\" cy=\"' + height + '\"/>';\r\n          strSlideXml += ' </a:xfrm>';\r\n          strSlideXml += ' <a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom>';\r\n          strSlideXml += '</p:spPr>';\r\n          strSlideXml += '</p:pic>';\r\n          break;\r\n\r\n        case 'media':\r\n          if ( slideItemObj.mtype == 'online' ) {\r\n            strSlideXml += '<p:pic>';\r\n            strSlideXml += ' <p:nvPicPr>';\r\n            // IMPORTANT: <p:cNvPr id=\"\" value is critical - if not the same number as preiew image rId, PowerPoint throws error!\r\n            strSlideXml += ' <p:cNvPr id=\"'+ (slideItemObj.mediaRid+2) +'\" name=\"Picture'+ (idx + 1) +'\"/>';\r\n            strSlideXml += ' <p:cNvPicPr/>';\r\n            strSlideXml += ' <p:nvPr>';\r\n            strSlideXml += '  <a:videoFile r:link=\"rId'+ slideItemObj.mediaRid +'\"/>';\r\n            strSlideXml += ' </p:nvPr>';\r\n            strSlideXml += ' </p:nvPicPr>';\r\n            strSlideXml += ' <p:blipFill><a:blip r:embed=\"rId'+ (slideItemObj.mediaRid+2) +'\"/><a:stretch><a:fillRect/></a:stretch></p:blipFill>'; // NOTE: Preview image is required!\r\n            strSlideXml += ' <p:spPr>';\r\n            strSlideXml += '  <a:xfrm' + locationAttr + '>';\r\n            strSlideXml += '   <a:off x=\"'  + x  + '\" y=\"'  + y  + '\"/>';\r\n            strSlideXml += '   <a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/>';\r\n            strSlideXml += '  </a:xfrm>';\r\n            strSlideXml += '  <a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom>';\r\n            strSlideXml += ' </p:spPr>';\r\n            strSlideXml += '</p:pic>';\r\n          }\r\n          else {\r\n            strSlideXml += '<p:pic>';\r\n            strSlideXml += ' <p:nvPicPr>';\r\n            // IMPORTANT: <p:cNvPr id=\"\" value is critical - if not the same number as preiew image rId, PowerPoint throws error!\r\n            strSlideXml += ' <p:cNvPr id=\"'+ (slideItemObj.mediaRid+2) +'\" name=\"'+ slideItemObj.media.split('/').pop().split('.').shift() +'\"><a:hlinkClick r:id=\"\" action=\"ppaction://media\"/></p:cNvPr>';\r\n            strSlideXml += ' <p:cNvPicPr><a:picLocks noChangeAspect=\"1\"/></p:cNvPicPr>';\r\n            strSlideXml += ' <p:nvPr>';\r\n            strSlideXml += '  <a:videoFile r:link=\"rId'+ slideItemObj.mediaRid +'\"/>';\r\n            strSlideXml += '  <p:extLst>';\r\n            strSlideXml += '   <p:ext uri=\"{DAA4B4D4-6D71-4841-9C94-3DE7FCFB9230}\">';\r\n            strSlideXml += '    <p14:media xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" r:embed=\"rId' + (slideItemObj.mediaRid+1) + '\"/>';\r\n            strSlideXml += '   </p:ext>';\r\n            strSlideXml += '  </p:extLst>';\r\n            strSlideXml += ' </p:nvPr>';\r\n            strSlideXml += ' </p:nvPicPr>';\r\n            strSlideXml += ' <p:blipFill><a:blip r:embed=\"rId'+ (slideItemObj.mediaRid+2) +'\"/><a:stretch><a:fillRect/></a:stretch></p:blipFill>'; // NOTE: Preview image is required!\r\n            strSlideXml += ' <p:spPr>';\r\n            strSlideXml += '  <a:xfrm' + locationAttr + '>';\r\n            strSlideXml += '   <a:off x=\"'  + x  + '\" y=\"'  + y  + '\"/>';\r\n            strSlideXml += '   <a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/>';\r\n            strSlideXml += '  </a:xfrm>';\r\n            strSlideXml += '  <a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom>';\r\n            strSlideXml += ' </p:spPr>';\r\n            strSlideXml += '</p:pic>';\r\n          }\r\n          break;\r\n\r\n        case 'chart':\r\n          strSlideXml += '<p:graphicFrame>';\r\n          strSlideXml += ' <p:nvGraphicFramePr>';\r\n          strSlideXml += '   <p:cNvPr id=\"'+ (idx + 2) +'\" name=\"Chart '+ (idx + 1) +'\"/>';\r\n          strSlideXml += '   <p:cNvGraphicFramePr/>';\r\n          strSlideXml += '   <p:nvPr/>';\r\n          strSlideXml += ' </p:nvGraphicFramePr>';\r\n          strSlideXml += ' <p:xfrm>';\r\n          strSlideXml += '  <a:off  x=\"' + x  + '\"  y=\"' + y  + '\"/>';\r\n          strSlideXml += '  <a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/>';\r\n          strSlideXml += ' </p:xfrm>';\r\n          strSlideXml += ' <a:graphic xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\">';\r\n          strSlideXml += '  <a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/chart\">';\r\n          strSlideXml += '   <c:chart r:id=\"rId'+ (slideItemObj.chartRid) +'\" xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\"/>';\r\n          strSlideXml += '  </a:graphicData>';\r\n          strSlideXml += ' </a:graphic>';\r\n          strSlideXml += '</p:graphicFrame>';\r\n          break;\r\n        }\r\n      });\r\n\r\n      // STEP 5: Add slide numbers last (if any)\r\n      if ( slideObject.slideNumberObj ) {\r\n        if ( !slideObject.slideNumberObj ) slideObject.slideNumberObj = { x:0.3, y:'90%' };\r\n\r\n        strSlideXml += '<p:sp>'\r\n          + '  <p:nvSpPr>'\r\n          + '    <p:cNvPr id=\"25\" name=\"Slide Number Placeholder 24\"/>'\r\n          + '    <p:cNvSpPr><a:spLocks noGrp=\"1\" /></p:cNvSpPr>'\r\n          + '    <p:nvPr><p:ph type=\"sldNum\" sz=\"quarter\" idx=\"4294967295\"/></p:nvPr>'\r\n          + '  </p:nvSpPr>'\r\n          + '  <p:spPr>'\r\n          + '    <a:xfrm><a:off x=\"'+ getSmartParseNumber(slideObject.slideNumberObj.x, 'X') +'\" y=\"'+ getSmartParseNumber(slideObject.slideNumberObj.y, 'Y') +'\"/><a:ext cx=\"800000\" cy=\"300000\"/></a:xfrm>'\r\n          + '    <a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom>'\r\n          + '    <a:extLst><a:ext uri=\"{C572A759-6A51-4108-AA02-DFA0A04FC94B}\"><ma14:wrappingTextBoxFlag val=\"0\" xmlns:ma14=\"http://schemas.microsoft.com/office/mac/drawingml/2011/main\"/></a:ext></a:extLst>'\r\n          + '  </p:spPr>';\r\n        // ISSUE #68: \"Page number styling\"\r\n        strSlideXml += '<p:txBody>';\r\n        strSlideXml += '  <a:bodyPr/>';\r\n        strSlideXml += '  <a:lstStyle><a:lvl1pPr>';\r\n        if ( slideObject.slideNumberObj.fontFace || slideObject.slideNumberObj.fontSize || slideObject.slideNumberObj.color ) {\r\n          strSlideXml += '<a:defRPr sz=\"'+ (slideObject.slideNumberObj.fontSize || '12') +'00\">';\r\n          if ( slideObject.slideNumberObj.color ) strSlideXml += genXmlColorSelection(slideObject.slideNumberObj.color);\r\n          if ( slideObject.slideNumberObj.fontFace ) strSlideXml += '<a:latin typeface=\"'+ slideObject.slideNumberObj.fontFace +'\"/><a:cs typeface=\"'+ slideObject.slideNumberObj.fontFace +'\"/>';\r\n          strSlideXml += '</a:defRPr>';\r\n        }\r\n        strSlideXml += '</a:lvl1pPr></a:lstStyle>';\r\n\r\n        // FIXME:\r\n        // TODO: slide numbers not showing by default\r\n        //strSlideXml += '<a:p><a:pPr/><a:fld id=\"'+SLDNUMFLDID+'\" type=\"slidenum\"/></a:p>'\r\n        strSlideXml += '<a:p><a:fld id=\"'+SLDNUMFLDID+'\" type=\"slidenum\">'\r\n          + '<a:rPr lang=\"en-US\" smtClean=\"0\"/><a:t></a:t></a:fld>'\r\n          + '<a:endParaRPr lang=\"en-US\" /></a:p>';\r\n\r\n        strSlideXml += '</p:txBody></p:sp>';\r\n      }\r\n\r\n      // STEP 6: Close spTree and finalize slide XML\r\n      strSlideXml += '</p:spTree>';\r\n      /* FIXME: Remove this in 2.0.0 (commented for 1.6.0)\r\n      strSlideXml += '<p:extLst>';\r\n      strSlideXml += ' <p:ext uri=\"{BB962C8B-B14F-4D97-AF65-F5344CB8AC3E}\">';\r\n      strSlideXml += '  <p14:creationId xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"1544976994\"/>';\r\n      strSlideXml += ' </p:ext>';\r\n      strSlideXml += '</p:extLst>';\r\n      */\r\n      strSlideXml += '</p:cSld>';\r\n\r\n      // LAST: Return\r\n      return strSlideXml;\r\n    },\r\n\r\n    /**\r\n     * Transforms slide relations to XML string.\r\n     * Extra relations that are not dynamic can be passed using the 2nd arg (e.g. theme relation in master file).\r\n     * These relations use rId series that starts with 1-increased maximum of rIds used for dynamic relations.\r\n     * @param {Object} slideObject slide object whose relations are being transformed\r\n     * @param {Object[]} defaultRels array of default relations (such objects expected: { target: <filepath>, type: <schemepath> })\r\n     * @return {String} complete XML string ready to be saved as a file\r\n     */\r\n    slideObjectRelationsToXml: function slideObjectRelationsToXml(slideObject, defaultRels) {\r\n      var lastRid = 0; // stores maximum rId used for dynamic relations\r\n      var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + CRLF;\r\n      strXml += '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">';\r\n      // Add any rels for this Slide (image/audio/video/youtube/chart)\r\n      slideObject.rels.forEach(function(rel){\r\n        lastRid = Math.max(lastRid, rel.rId);\r\n        if      ( rel.type.toLowerCase().indexOf('image')  > -1 ) {\r\n          strXml += '<Relationship Id=\"rId'+ rel.rId +'\" Target=\"'+ rel.Target +'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\"/>';\r\n        }\r\n        else if ( rel.type.toLowerCase().indexOf('chart')  > -1 ) {\r\n          strXml += '<Relationship Id=\"rId'+ rel.rId +'\" Target=\"'+ rel.Target +'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart\"/>';\r\n        }\r\n        else if ( rel.type.toLowerCase().indexOf('audio')  > -1 ) {\r\n          // As media has *TWO* rel entries per item, check for first one, if found add second rel with alt style\r\n          if ( strXml.indexOf(' Target=\"'+ rel.Target +'\"') > -1 )\r\n            strXml += '<Relationship Id=\"rId'+ rel.rId +'\" Target=\"'+ rel.Target +'\" Type=\"http://schemas.microsoft.com/office/2007/relationships/media\"/>';\r\n          else\r\n            strXml += '<Relationship Id=\"rId'+ rel.rId +'\" Target=\"'+ rel.Target +'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/audio\"/>';\r\n        }\r\n        else if ( rel.type.toLowerCase().indexOf('video')  > -1 ) {\r\n          // As media has *TWO* rel entries per item, check for first one, if found add second rel with alt style\r\n          if ( strXml.indexOf(' Target=\"'+ rel.Target +'\"') > -1 )\r\n            strXml += '<Relationship Id=\"rId'+ rel.rId +'\" Target=\"'+ rel.Target +'\" Type=\"http://schemas.microsoft.com/office/2007/relationships/media\"/>';\r\n          else\r\n            strXml += '<Relationship Id=\"rId'+ rel.rId +'\" Target=\"'+ rel.Target +'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/video\"/>';\r\n        }\r\n        else if ( rel.type.toLowerCase().indexOf('online') > -1 ) {\r\n          // As media has *TWO* rel entries per item, check for first one, if found add second rel with alt style\r\n          if ( strXml.indexOf(' Target=\"'+ rel.Target +'\"') > -1 )\r\n            strXml += '<Relationship Id=\"rId'+ rel.rId +'\" Target=\"'+ rel.Target +'\" Type=\"http://schemas.microsoft.com/office/2007/relationships/image\"/>';\r\n          else\r\n            strXml += '<Relationship Id=\"rId'+ rel.rId +'\" Target=\"'+ rel.Target +'\" TargetMode=\"External\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/video\"/>';\r\n        }\r\n        else if ( rel.type.toLowerCase().indexOf('hyperlink') > -1 ) {\r\n          strXml += '<Relationship Id=\"rId'+ rel.rId +'\" Target=\"'+ rel.Target +'\" TargetMode=\"External\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\"/>';\r\n        }\r\n      });\r\n\r\n      defaultRels.forEach(function(rel, idx) {\r\n        strXml += '<Relationship Id=\"rId' + (lastRid + idx + 1) + '\" Target=\"' + rel.target + '\" Type=\"' + rel.type + '\"/>';\r\n      });\r\n\r\n      strXml += '</Relationships>';\r\n      return strXml;\r\n    },\r\n\r\n    imageSizingXml: {\r\n      cover: function(imgSize, boxDim) {\r\n        var imgRatio = imgSize.h / imgSize.w,\r\n          boxRatio = boxDim.h / boxDim.w,\r\n          isBoxBased = boxRatio > imgRatio,\r\n          width = isBoxBased ? (boxDim.h / imgRatio) : boxDim.w,\r\n          height = isBoxBased ? boxDim.h : (boxDim.w * imgRatio),\r\n          hzPerc = Math.round(1e5 * 0.5 * (1 - boxDim.w / width)),\r\n          vzPerc = Math.round(1e5 * 0.5 * (1 - boxDim.h / height));\r\n        return '<a:srcRect l=\"' + hzPerc + '\" r=\"' + hzPerc + '\" t=\"' + vzPerc + '\" b=\"' + vzPerc + '\" /><a:stretch/>';\r\n      },\r\n      contain: function(imgSize, boxDim) {\r\n        var imgRatio = imgSize.h / imgSize.w,\r\n          boxRatio = boxDim.h / boxDim.w,\r\n          widthBased = boxRatio > imgRatio,\r\n          width =  widthBased ? boxDim.w : (boxDim.h / imgRatio),\r\n          height = widthBased ? (boxDim.w * imgRatio) : boxDim.h,\r\n          hzPerc = Math.round(1e5 * 0.5 * (1 - boxDim.w / width)),\r\n          vzPerc = Math.round(1e5 * 0.5 * (1 - boxDim.h / height));\r\n        return '<a:srcRect l=\"' + hzPerc + '\" r=\"' + hzPerc + '\" t=\"' + vzPerc + '\" b=\"' + vzPerc + '\" /><a:stretch/>';\r\n\r\n      },\r\n      crop: function(imageSize, boxDim) {\r\n        var l = boxDim.x,\r\n          r = imageSize.w - (boxDim.x + boxDim.w),\r\n          t = boxDim.y,\r\n          b = imageSize.h - (boxDim.y + boxDim.h),\r\n          lPerc = Math.round(1e5 * (l / imageSize.w)),\r\n          rPerc = Math.round(1e5 * (r / imageSize.w)),\r\n          tPerc = Math.round(1e5 * (t / imageSize.h)),\r\n          bPerc = Math.round(1e5 * (b / imageSize.h));\r\n        return '<a:srcRect l=\"' + lPerc + '\" r=\"' + rPerc + '\" t=\"' + tPerc + '\" b=\"' + bPerc + '\" /><a:stretch/>';\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Based on passed data, creates Excel Worksheet that is used as a data source for a chart.\r\n     * @param {Object} chartObject chart object\r\n     * @param {ZipObject} zip zip file that the resulting XLSX should be added to\r\n     * @return {Promise} promise of generating the XLSX file\r\n     */\r\n    createExcelWorksheet: function createExcelWorksheet(chartObject, zip) {\r\n      var data = chartObject.data;\r\n      return new Promise(function(resolve, reject) {\r\n        var zipExcel = new JSZip();\r\n\r\n        zipExcel.folder('_rels');\r\n        zipExcel.folder('docProps');\r\n        zipExcel.folder('xl/_rels');\r\n        zipExcel.folder('xl/tables');\r\n        zipExcel.folder('xl/theme');\r\n        zipExcel.folder('xl/worksheets');\r\n        zipExcel.folder('xl/worksheets/_rels');\r\n\r\n        {\r\n          zipExcel.file('[Content_Types].xml',\r\n            '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">'\r\n            + '  <Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\"/>'\r\n            + '  <Default Extension=\"xml\" ContentType=\"application/xml\"/>'\r\n            //+ '  <Default Extension=\"jpeg\" ContentType=\"image/jpg\"/><Default Extension=\"png\" ContentType=\"image/png\"/>'\r\n            //+ '  <Default Extension=\"bmp\" ContentType=\"image/bmp\"/><Default Extension=\"gif\" ContentType=\"image/gif\"/><Default Extension=\"tif\" ContentType=\"image/tif\"/><Default Extension=\"pdf\" ContentType=\"application/pdf\"/><Default Extension=\"mov\" ContentType=\"application/movie\"/><Default Extension=\"vml\" ContentType=\"application/vnd.openxmlformats-officedocument.vmlDrawing\"/>'\r\n            //+ '  <Default Extension=\"xlsx\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"/>'\r\n            + '  <Override PartName=\"/xl/workbook.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\"/>'\r\n            + '  <Override PartName=\"/xl/worksheets/sheet1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\"/>'\r\n            + '  <Override PartName=\"/xl/theme/theme1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.theme+xml\"/>'\r\n            + '  <Override PartName=\"/xl/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\"/>'\r\n            + '  <Override PartName=\"/xl/sharedStrings.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\"/>'\r\n            + '  <Override PartName=\"/xl/tables/table1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\"/>'\r\n            + '  <Override PartName=\"/docProps/core.xml\" ContentType=\"application/vnd.openxmlformats-package.core-properties+xml\"/>'\r\n            + '  <Override PartName=\"/docProps/app.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.extended-properties+xml\"/>'\r\n            + '</Types>\\n'\r\n          );\r\n          zipExcel.file('_rels/.rels', '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'\r\n            + '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\" Target=\"docProps/core.xml\"/>'\r\n            + '<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\" Target=\"docProps/app.xml\"/>'\r\n            + '<Relationship Id=\"rId3\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/>'\r\n            + '</Relationships>\\n');\r\n          zipExcel.file('docProps/app.xml',\r\n            '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\" xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\">'\r\n            + '<Application>Microsoft Excel</Application>'\r\n            + '<DocSecurity>0</DocSecurity>'\r\n            + '<HeadingPairs><vt:vector size=\"2\" baseType=\"variant\"><vt:variant><vt:lpstr>Worksheets</vt:lpstr></vt:variant><vt:variant><vt:i4>1</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size=\"1\" baseType=\"lpstr\"><vt:lpstr>Sheet1</vt:lpstr></vt:vector></TitlesOfParts>'\r\n            + '</Properties>\\n'\r\n          );\r\n          zipExcel.file('docProps/core.xml',\r\n            '<?xml version=\"1.0\" encoding=\"UTF-8\"?><cp:coreProperties xmlns:cp=\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:dcterms=\"http://purl.org/dc/terms/\" xmlns:dcmitype=\"http://purl.org/dc/dcmitype/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">'\r\n            + '<dc:creator>PptxGenJS</dc:creator>'\r\n            + '<cp:lastModifiedBy>Ely, Brent</cp:lastModifiedBy>'\r\n            + '<dcterms:created xsi:type=\"dcterms:W3CDTF\">'+ new Date().toISOString() +'</dcterms:created>'\r\n            + '<dcterms:modified xsi:type=\"dcterms:W3CDTF\">'+ new Date().toISOString() +'</dcterms:modified>'\r\n            + '</cp:coreProperties>\\n');\r\n          zipExcel.file('xl/_rels/workbook.xml.rels',\r\n            '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'\r\n            + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'\r\n            + '<Relationship Id=\"rId3\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>'\r\n            + '<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\" Target=\"theme/theme1.xml\"/>'\r\n            + '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Target=\"worksheets/sheet1.xml\"/>'\r\n            + '<Relationship Id=\"rId4\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\" Target=\"sharedStrings.xml\"/>'\r\n            + '</Relationships>\\n'\r\n          );\r\n          zipExcel.file('xl/styles.xml',\r\n            '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\"><numFmts count=\"1\"><numFmt numFmtId=\"0\" formatCode=\"General\"/></numFmts><fonts count=\"4\"><font><sz val=\"9\"/><color indexed=\"8\"/><name val=\"Geneva\"/></font><font><sz val=\"9\"/><color indexed=\"8\"/><name val=\"Geneva\"/></font><font><sz val=\"10\"/><color indexed=\"8\"/><name val=\"Geneva\"/></font><font><sz val=\"18\"/><color indexed=\"8\"/>'\r\n            + '<name val=\"Arial\"/></font></fonts><fills count=\"2\"><fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill></fills><borders count=\"1\"><border><left/><right/><top/><bottom/><diagonal/></border></borders><dxfs count=\"0\"/><tableStyles count=\"0\"/><colors><indexedColors><rgbColor rgb=\"ff000000\"/><rgbColor rgb=\"ffffffff\"/><rgbColor rgb=\"ffff0000\"/><rgbColor rgb=\"ff00ff00\"/><rgbColor rgb=\"ff0000ff\"/>'\r\n            + '<rgbColor rgb=\"ffffff00\"/><rgbColor rgb=\"ffff00ff\"/><rgbColor rgb=\"ff00ffff\"/><rgbColor rgb=\"ff000000\"/><rgbColor rgb=\"ffffffff\"/><rgbColor rgb=\"ff878787\"/><rgbColor rgb=\"fff9f9f9\"/></indexedColors></colors></styleSheet>\\n'\r\n          );\r\n          zipExcel.file('xl/theme/theme1.xml',\r\n            '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" name=\"Office Theme\"><a:themeElements><a:clrScheme name=\"Office Theme\"><a:dk1><a:srgbClr val=\"000000\"/></a:dk1><a:lt1><a:srgbClr val=\"FFFFFF\"/></a:lt1><a:dk2><a:srgbClr val=\"A7A7A7\"/></a:dk2><a:lt2><a:srgbClr val=\"535353\"/></a:lt2><a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1><a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2><a:accent3><a:srgbClr val=\"9BBB59\"/></a:accent3><a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4><a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5><a:accent6><a:srgbClr val=\"F79646\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"FF00FF\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office Theme\"><a:majorFont><a:latin typeface=\"Helvetica\"/><a:ea typeface=\"Helvetica\"/><a:cs typeface=\"Helvetica\"/></a:majorFont><a:minorFont><a:latin typeface=\"Arial\"/><a:ea typeface=\"Arial\"/><a:cs typeface=\"Arial\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\"Office Theme\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"1\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"100000\"/><a:shade val=\"100000\"/><a:satMod val=\"129999\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:shade val=\"100000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"104999\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw sx=\"100000\" sy=\"100000\" kx=\"0\" ky=\"0\" algn=\"b\" rotWithShape=\"0\" blurRad=\"38100\" dist=\"23000\" dir=\"5400000\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw sx=\"100000\" sy=\"100000\" kx=\"0\" ky=\"0\" algn=\"b\" rotWithShape=\"0\" blurRad=\"38100\" dist=\"23000\" dir=\"5400000\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw sx=\"100000\" sy=\"100000\" kx=\"0\" ky=\"0\" algn=\"b\" rotWithShape=\"0\" blurRad=\"38100\" dist=\"20000\" dir=\"5400000\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults><a:spDef><a:spPr><a:solidFill><a:srgbClr val=\"FFFFFF\"/></a:solidFill><a:ln w=\"25400\" cap=\"flat\"><a:solidFill><a:schemeClr val=\"accent1\"/></a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln><a:effectLst><a:outerShdw sx=\"100000\" sy=\"100000\" kx=\"0\" ky=\"0\" algn=\"b\" rotWithShape=\"0\" blurRad=\"38100\" dist=\"23000\" dir=\"5400000\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:sp3d/></a:spPr><a:bodyPr rot=\"0\" spcFirstLastPara=\"1\" vertOverflow=\"overflow\" horzOverflow=\"overflow\" vert=\"horz\" wrap=\"square\" lIns=\"45719\" tIns=\"45719\" rIns=\"45719\" bIns=\"45719\" numCol=\"1\" spcCol=\"38100\" rtlCol=\"0\" anchor=\"ctr\" upright=\"0\"><a:spAutoFit/></a:bodyPr><a:lstStyle><a:defPPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"0\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/><a:sym typeface=\"Arial\"/></a:defRPr></a:defPPr><a:lvl1pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl1pPr><a:lvl2pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl2pPr><a:lvl3pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl3pPr><a:lvl4pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl4pPr><a:lvl5pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl5pPr><a:lvl6pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl6pPr><a:lvl7pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl7pPr><a:lvl8pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl8pPr><a:lvl9pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl9pPr></a:lstStyle><a:style><a:lnRef idx=\"0\"/><a:fillRef idx=\"0\"/><a:effectRef idx=\"0\"/><a:fontRef idx=\"none\"/></a:style></a:spDef><a:lnDef><a:spPr><a:noFill/><a:ln w=\"25400\" cap=\"flat\"><a:solidFill><a:schemeClr val=\"accent1\"/></a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln><a:effectLst><a:outerShdw sx=\"100000\" sy=\"100000\" kx=\"0\" ky=\"0\" algn=\"b\" rotWithShape=\"0\" blurRad=\"38100\" dist=\"20000\" dir=\"5400000\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:sp3d/></a:spPr><a:bodyPr rot=\"0\" spcFirstLastPara=\"1\" vertOverflow=\"overflow\" horzOverflow=\"overflow\" vert=\"horz\" wrap=\"square\" lIns=\"91439\" tIns=\"45719\" rIns=\"91439\" bIns=\"45719\" numCol=\"1\" spcCol=\"38100\" rtlCol=\"0\" anchor=\"t\" upright=\"0\"><a:noAutofit/></a:bodyPr><a:lstStyle><a:defPPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:defPPr><a:lvl1pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl1pPr><a:lvl2pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl2pPr><a:lvl3pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl3pPr><a:lvl4pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl4pPr><a:lvl5pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl5pPr><a:lvl6pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl6pPr><a:lvl7pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl7pPr><a:lvl8pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl8pPr><a:lvl9pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl9pPr></a:lstStyle><a:style><a:lnRef idx=\"0\"/><a:fillRef idx=\"0\"/><a:effectRef idx=\"0\"/><a:fontRef idx=\"none\"/></a:style></a:lnDef><a:txDef><a:spPr><a:noFill/><a:ln w=\"12700\" cap=\"flat\"><a:noFill/><a:miter lim=\"400000\"/></a:ln><a:effectLst/><a:sp3d/></a:spPr><a:bodyPr rot=\"0\" spcFirstLastPara=\"1\" vertOverflow=\"overflow\" horzOverflow=\"overflow\" vert=\"horz\" wrap=\"square\" lIns=\"45719\" tIns=\"45719\" rIns=\"45719\" bIns=\"45719\" numCol=\"1\" spcCol=\"38100\" rtlCol=\"0\" anchor=\"t\" upright=\"0\"><a:spAutoFit/></a:bodyPr><a:lstStyle><a:defPPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"0\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/><a:sym typeface=\"Arial\"/></a:defRPr></a:defPPr><a:lvl1pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl1pPr><a:lvl2pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl2pPr><a:lvl3pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl3pPr><a:lvl4pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl4pPr><a:lvl5pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl5pPr><a:lvl6pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl6pPr><a:lvl7pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl7pPr><a:lvl8pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl8pPr><a:lvl9pPr marL=\"0\" marR=\"0\" indent=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" fontAlgn=\"auto\" latinLnBrk=\"1\" hangingPunct=\"0\"><a:lnSpc><a:spcPct val=\"100000\"/></a:lnSpc><a:spcBef><a:spcPts val=\"0\"/></a:spcBef><a:spcAft><a:spcPts val=\"0\"/></a:spcAft><a:buClrTx/><a:buSzTx/><a:buFontTx/><a:buNone/><a:tabLst/><a:defRPr b=\"0\" baseline=\"0\" cap=\"none\" i=\"0\" spc=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\" kumimoji=\"0\" normalizeH=\"0\"><a:ln><a:noFill/></a:ln><a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:effectLst/><a:uFillTx/></a:defRPr></a:lvl9pPr></a:lstStyle><a:style><a:lnRef idx=\"0\"/><a:fillRef idx=\"0\"/><a:effectRef idx=\"0\"/><a:fontRef idx=\"none\"/></a:style></a:txDef></a:objectDefaults></a:theme>\\n'\r\n          );\r\n          zipExcel.file('xl/workbook.xml',\r\n            '<?xml version=\"1.0\" encoding=\"UTF-8\"?>'\r\n            + '<workbook xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x15\" xmlns:x15=\"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main\">'\r\n            + '<fileVersion appName=\"xl\" lastEdited=\"6\" lowestEdited=\"6\" rupBuild=\"14420\"/>'\r\n            + '<workbookPr defaultThemeVersion=\"153222\"/>'\r\n            + '<bookViews><workbookView xWindow=\"0\" yWindow=\"0\" windowWidth=\"15960\" windowHeight=\"18080\"/></bookViews>'\r\n            + '<sheets><sheet name=\"Sheet1\" sheetId=\"1\" r:id=\"rId1\"/></sheets>'\r\n            + '<calcPr calcId=\"0\"/><oleSize ref=\"A1\"/>'\r\n            + '</workbook>\\n'\r\n          );\r\n          zipExcel.file('xl/worksheets/_rels/sheet1.xml.rels',\r\n            '<?xml version=\"1.0\" encoding=\"UTF-8\"?>'\r\n            + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'\r\n            + '  <Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table\" Target=\"../tables/table1.xml\"/>'\r\n            + '</Relationships>\\n'\r\n          );\r\n        }\r\n\r\n        // `sharedStrings.xml`\r\n        {\r\n          var strSharedStrings = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>';\r\n          strSharedStrings += '<sst xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" count=\"'+ (data[0].labels.length + data.length + 1) +'\" uniqueCount=\"'+ (data[0].labels.length + data.length +1) +'\">';\r\n\r\n          // A: Add Labels\r\n          data[0].labels.forEach(function(label){ strSharedStrings += '<si><t>'+ decodeXmlEntities(label) +'</t></si>'; });\r\n\r\n          // B: Add Series\r\n          data.forEach(function(objData){ strSharedStrings += '<si><t>'+ (objData.name || ' ') +'</t></si>'; });\r\n\r\n          // C: Add 'blank' for A1\r\n          strSharedStrings += '<si><t xml:space=\"preserve\"></t></si>';\r\n\r\n          strSharedStrings += '</sst>\\n';\r\n          zipExcel.file('xl/sharedStrings.xml', strSharedStrings);\r\n        }\r\n\r\n        // tables/table1.xml\r\n        {\r\n          var strTableXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>';\r\n          strTableXml += '<table xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" id=\"1\" name=\"Table1\" displayName=\"Table1\" ref=\"A1:'+ LETTERS[data.length] + (data[0].labels.length+1) +'\" totalsRowShown=\"0\">';\r\n          strTableXml += '<tableColumns count=\"' + (data[0].labels.length+1) +'\">';\r\n          strTableXml += '<tableColumn id=\"1\" name=\" \"/>';\r\n          data[0].labels.forEach(function(label,idx){ strTableXml += '<tableColumn id=\"'+ (idx+2) +'\" name=\"'+ decodeXmlEntities(label) +'\"/>'; });\r\n          strTableXml += '</tableColumns>';\r\n          strTableXml += '<tableStyleInfo showFirstColumn=\"0\" showLastColumn=\"0\" showRowStripes=\"1\" showColumnStripes=\"0\"/>';\r\n          strTableXml += '</table>';\r\n          zipExcel.file('xl/tables/table1.xml', strTableXml);\r\n        }\r\n\r\n        // worksheets/sheet1.xml\r\n        var strSheetXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>';\r\n        strSheetXml += '<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">';\r\n        strSheetXml += '<dimension ref=\"A1:'+ LETTERS[data.length] + (data[0].labels.length+1) +'\"/>';\r\n        strSheetXml += '<sheetViews><sheetView tabSelected=\"1\" workbookViewId=\"0\"><selection activeCell=\"B1\" sqref=\"B1\"/></sheetView></sheetViews>';\r\n        strSheetXml += '<sheetFormatPr defaultRowHeight=\"15\"/>';\r\n        strSheetXml += '<cols>';\r\n        strSheetXml += '<col min=\"10\" max=\"100\" width=\"20\" customWidth=\"1\"/>';\r\n        data[0].labels.forEach(function(){ strSheetXml += '<col min=\"10\" max=\"100\" width=\"10\" customWidth=\"1\"/>'; });\r\n        strSheetXml += '</cols>';\r\n        strSheetXml += '<sheetData>';\r\n\r\n        /* EX: INPUT: `data`\r\n        [\r\n          { name:'Red', labels:['Jan..May-17'], values:[11,13,14,15,16] },\r\n          { name:'Amb', labels:['Jan..May-17'], values:[22, 6, 7, 8, 9] },\r\n          { name:'Grn', labels:['Jan..May-17'], values:[33,32,42,53,63] }\r\n        ];\r\n        */\r\n        /* EX: OUTPUT: lineChart Worksheet:\r\n          -|---A---|--B--|--C--|--D--|\r\n          1|       | Red | Amb | Grn |\r\n          2|Jan-17 |   11|   22|   33|\r\n          3|Feb-17 |   55|   43|   70|\r\n          4|Mar-17 |   56|  143|   99|\r\n          5|Apr-17 |   65|    3|  120|\r\n          6|May-17 |   75|   93|  170|\r\n          -|-------|-----|-----|-----|\r\n        */\r\n\r\n        // A: Create header row first (NOTE: Start at index=1 as headers cols start with 'B')\r\n        strSheetXml += '<row r=\"1\">';\r\n        strSheetXml += '<c r=\"A1\" t=\"s\"><v>'+ (data.length + data[0].labels.length) +'</v></c>';\r\n        for (var idx=1; idx<=data[0].labels.length; idx++) {\r\n          // FIXME: Max cols is 52\r\n          strSheetXml += '<c r=\"'+ ( idx < 26 ? LETTERS[idx] : 'A'+LETTERS[idx%LETTERS.length] ) +'1\" t=\"s\">'; // NOTE: use `t=\"s\"` for label cols!\r\n          strSheetXml += '<v>'+ (idx-1) +'</v>';\r\n          strSheetXml += '</c>';\r\n        }\r\n        strSheetXml += '</row>';\r\n\r\n        // B: Add data row(s)\r\n        data.forEach(function(row,idx){\r\n          // Leading col is reserved for the label, so hard-code it, then loop over col values\r\n          strSheetXml += '<row r=\"'+ (idx+2) +'\">';\r\n          strSheetXml += '<c r=\"A'+ (idx+2) +'\" t=\"s\">';\r\n          strSheetXml += '<v>'+ (data[0].values.length + idx + 1) +'</v>';\r\n          strSheetXml += '</c>';\r\n          row.values.forEach(function(val,idy){\r\n            strSheetXml += '<c r=\"'+ ( (idy+1) < 26 ? LETTERS[(idy+1)] : 'A'+LETTERS[(idy+1)%LETTERS.length] ) +''+ (idx+2) +'\">';\r\n            strSheetXml += '<v>'+ (val || '') +'</v>';\r\n            strSheetXml += '</c>';\r\n          });\r\n          strSheetXml += '</row>';\r\n        });\r\n\r\n        strSheetXml += '</sheetData>';\r\n        strSheetXml += '<pageMargins left=\"0.7\" right=\"0.7\" top=\"0.75\" bottom=\"0.75\" header=\"0.3\" footer=\"0.3\"/>';\r\n        //strSheetXml += '<tableParts count=\"1\"><tablePart r:id=\"rId1\"/></tableParts>'; // Causes unreadable error in O365\r\n        strSheetXml += '</worksheet>\\n';\r\n        zipExcel.file('xl/worksheets/sheet1.xml', strSheetXml);\r\n\r\n        // C: Add XLSX to PPTX export\r\n        zipExcel.generateAsync({type:'base64'})\r\n          .then(function(content){\r\n          // 1: Create the embedded Excel worksheet with labels and data\r\n            zip.file( 'ppt/embeddings/Microsoft_Excel_Worksheet'+ chartObject.globalId +'.xlsx', content, {base64:true} );\r\n\r\n            // 2: Create the chart.xml and rels files\r\n            zip.file('ppt/charts/_rels/'+ chartObject.fileName +'.rels',\r\n              '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'\r\n            + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'\r\n            + '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/package\" Target=\"../embeddings/Microsoft_Excel_Worksheet'+ chartObject.globalId +'.xlsx\"/>'\r\n            + '</Relationships>'\r\n            );\r\n            zip.file('ppt/charts/'+chartObject.fileName, makeXmlCharts(chartObject));\r\n\r\n            // 3: Done\r\n            resolve();\r\n          })\r\n          .catch(function(strErr){\r\n            reject(strErr);\r\n          });\r\n      });\r\n    }\r\n  };\r\n\r\n  /* ===============================================================================================\r\n  |\r\n  #     #\r\n  #     #  ######  #       #####   ######  #####    ####\r\n  #     #  #       #       #    #  #       #    #  #\r\n  #######  #####   #       #    #  #####   #    #   ####\r\n  #     #  #       #       #####   #       #####        #\r\n  #     #  #       #       #       #       #   #   #    #\r\n  #     #  ######  ######  #       ######  #    #   ####\r\n  |\r\n  ==================================================================================================\r\n  */\r\n\r\n  /**\r\n   * DESC: Export the .pptx file\r\n   */\r\n  function doExportPresentation(outputType) {\r\n    var arrChartPromises = [];\r\n    var intSlideNum = 0;\r\n\r\n    // STEP 1: Create new JSZip file\r\n    var zip = new JSZip();\r\n\r\n    // STEP 2: Add all required folders and files\r\n    zip.folder('_rels');\r\n    zip.folder('docProps');\r\n    zip.folder('ppt').folder('_rels');\r\n    zip.folder('ppt/charts').folder('_rels');\r\n    zip.folder('ppt/embeddings');\r\n    zip.folder('ppt/media');\r\n    zip.folder('ppt/slideLayouts').folder('_rels');\r\n    zip.folder('ppt/slideMasters').folder('_rels');\r\n    zip.folder('ppt/slides').folder('_rels');\r\n    zip.folder('ppt/theme');\r\n    //\r\n    zip.file('[Content_Types].xml', makeXmlContTypes());\r\n    zip.file('_rels/.rels', makeXmlRootRels());\r\n    zip.file('docProps/app.xml', makeXmlApp());\r\n    zip.file('docProps/core.xml', makeXmlCore());\r\n    zip.file('ppt/_rels/presentation.xml.rels', makeXmlPresentationRels());\r\n    //\r\n    zip.file('ppt/theme/theme1.xml', makeXmlTheme());\r\n    zip.file('ppt/presentation.xml', makeXmlPresentation());\r\n    zip.file('ppt/presProps.xml',    makeXmlPresProps());\r\n    zip.file('ppt/tableStyles.xml',  makeXmlTableStyles());\r\n    zip.file('ppt/viewProps.xml',    makeXmlViewProps());\r\n\r\n    for ( var idx=1; idx<=gObjPptx.slideLayouts.length; idx++ ) {\r\n      zip.file('ppt/slideLayouts/slideLayout'+ idx +'.xml', makeXmlLayout(gObjPptx.slideLayouts[idx - 1]));\r\n      zip.file('ppt/slideLayouts/_rels/slideLayout'+ idx +'.xml.rels', makeXmlSlideLayoutRel( idx ));\r\n    }\r\n\r\n    // Create a Layout/Master/Rel/Slide file for each SLIDE\r\n    for ( idx=0; idx<gObjPptx.slides.length; idx++ ) {\r\n      intSlideNum++;\r\n      zip.file('ppt/slides/slide'+ intSlideNum +'.xml', makeXmlSlide(gObjPptx.slides[idx]));\r\n      zip.file('ppt/slides/_rels/slide'+ intSlideNum +'.xml.rels', makeXmlSlideRel( intSlideNum ));\r\n    }\r\n\r\n    zip.file('ppt/slideMasters/slideMaster1.xml', makeXmlMaster(gObjPptx.masterSlide));\r\n    zip.file('ppt/slideMasters/_rels/slideMaster1.xml.rels', makeXmlMasterRel(gObjPptx.masterSlide));\r\n\r\n    // Create all Rels (images, media, chart data)\r\n    gObjPptx.slideLayouts.forEach(function(layout){\r\n      createMediaFiles(layout, zip, arrChartPromises);\r\n    });\r\n    gObjPptx.slides.forEach(function(slide){\r\n      createMediaFiles(slide, zip, arrChartPromises);\r\n    });\r\n    createMediaFiles(gObjPptx.masterSlide, zip, arrChartPromises);\r\n\r\n    // STEP 3: Wait for Promises (if any) then generate the PPTX file\r\n    Promise.all( arrChartPromises )\r\n      .then(function(){\r\n        var strExportName = ((gObjPptx.fileName.toLowerCase().indexOf('.ppt') > -1) ? gObjPptx.fileName : gObjPptx.fileName+gObjPptx.fileExtn);\r\n        if ( outputType && JSZIP_OUTPUT_TYPES.indexOf(outputType) >= 0) {\r\n          zip.generateAsync({ type:outputType }).then(gObjPptx.saveCallback);\r\n        }\r\n        else {\r\n          zip.generateAsync({type:'blob'}).then(function(content){ writeFileToBrowser(strExportName, content); });\r\n        }\r\n      })\r\n      .catch(function(strErr){\r\n        console.error(strErr);\r\n      });\r\n  }\r\n\r\n  function writeFileToBrowser(strExportName, content) {\r\n    // STEP 1: Create element\r\n    var a = document.createElement('a');\r\n    document.body.appendChild(a);\r\n    a.style = 'display: none';\r\n\r\n    // STEP 2: Download file to browser\r\n    // DESIGN: Use `createObjectURL()` (or MS-specific func for IE11) to D/L files in client browsers (FYI: synchronously executed)\r\n    if ( window.navigator.msSaveOrOpenBlob ) {\r\n      // REF: https://docs.microsoft.com/en-us/microsoft-edge/dev-guide/html5/file-api/blob\r\n      var blobObject = new Blob([content]);\r\n      $$(a).click(function(){\r\n        window.navigator.msSaveOrOpenBlob(blobObject, strExportName);\r\n      });\r\n      a.click();\r\n\r\n      // Clean-up\r\n      document.body.removeChild(a);\r\n\r\n      // LAST: Callback (if any)\r\n      if ( gObjPptx.saveCallback ) gObjPptx.saveCallback(strExportName);\r\n    }\r\n    else if ( window.URL.createObjectURL ) {\r\n      var blob = new Blob([content], {type: 'octet/stream'});\r\n      var url = window.URL.createObjectURL(blob);\r\n      a.href = url;\r\n      a.download = strExportName;\r\n      a.click();\r\n\r\n      // Clean-up (NOTE: Add a slight delay before removing to avoid 'blob:null' error in Firefox Issue#81)\r\n      setTimeout(function(){\r\n        window.URL.revokeObjectURL(url);\r\n        document.body.removeChild(a);\r\n      }, 100);\r\n\r\n      // LAST: Callback (if any)\r\n      if ( gObjPptx.saveCallback ) gObjPptx.saveCallback(strExportName);\r\n    }\r\n\r\n    // STEP 3: Clear callback func post-save\r\n    gObjPptx.saveCallback = null;\r\n  }\r\n\r\n  /**\r\n   * DESC: Calc and return excel column name (eg: 'A2')\r\n   */\r\n  function getExcelColName(length) {\r\n    var strName = '';\r\n\r\n    if ( length <= 26 ) {\r\n      strName = LETTERS[length];\r\n    }\r\n    else {\r\n      strName += LETTERS[ Math.floor(length/LETTERS.length)-1 ];\r\n      strName += LETTERS[ (length % LETTERS.length) ];\r\n    }\r\n\r\n    return strName;\r\n  }\r\n\r\n  /**\r\n   * DESC: Convert component value to hex value\r\n   */\r\n  function componentToHex(c) {\r\n    var hex = c.toString(16);\r\n    return hex.length == 1 ? '0' + hex : hex;\r\n  }\r\n\r\n  /**\r\n   * DESC: Depending on the passed color string, creates either `a:schemeClr` (when scheme color) or `a:srgbClr` (when hexa representation).\r\n   * color (string): hexa representation (eg. \"FFFF00\") or a scheme color constant (eg. colors.ACCENT1)\r\n   * innerElements (optional string): Additional elements that adjust the color and are enclosed by the color element.\r\n   */\r\n  function createColorElement(colorStr, innerElements) {\r\n    var isHexaRgb = REGEX_HEX_COLOR.test(colorStr);\r\n    if ( !isHexaRgb && SCHEME_COLOR_NAMES.indexOf(colorStr) === -1 ) {\r\n      console.warn('\"' + colorStr + '\" is not a valid scheme color or hexa RGB! \"'+DEF_FONT_COLOR+'\" is used as a fallback. Pass 6-digit RGB or these `pptx.colors` values:\\n' + SCHEME_COLOR_NAMES.join(', '));\r\n      colorStr = DEF_FONT_COLOR;\r\n    }\r\n    var tagName = isHexaRgb ? 'srgbClr' : 'schemeClr';\r\n    var colorAttr = ' val=\"'+ colorStr +'\"';\r\n    return innerElements ? '<a:'+ tagName + colorAttr +'>'+ innerElements +'</a:'+ tagName +'>' : '<a:'+ tagName + colorAttr +' />';\r\n  }\r\n\r\n  /**\r\n   * DESC: Used by `addSlidesForTable()` to convert RGB colors from jQuery selectors to Hex for Presentation colors\r\n   */\r\n  function rgbToHex(r, g, b) {\r\n    if (!Number.isInteger(r)) console.warn('Integer expected!');\r\n    return (componentToHex(r) + componentToHex(g) + componentToHex(b)).toUpperCase();\r\n  }\r\n\r\n  function inch2Emu(inches) {\r\n    // FIRST: Provide Caller Safety: Numbers may get conv<->conv during flight, so be kind and do some simple checks to ensure inches were passed\r\n    // Any value over 100 damn sure isnt inches, must be EMU already, so just return it\r\n    if (inches > 100) return inches;\r\n    if ( typeof inches == 'string' ) inches = Number( inches.replace(/in*/gi,'') );\r\n    return Math.round(EMU * inches);\r\n  }\r\n\r\n  // Placeholder\r\n  // function getSizeFromImage(inImgUrl) {\r\n  //   // A: Create\r\n  //   var image = new Image();\r\n\r\n  //   // B: Set onload event\r\n  //   image.onload = function(){\r\n  //     // FIRST: Check for any errors: This is the best method (try/catch wont work, etc.)\r\n  //     if (this.width + this.height == 0) { return { width:0, height:0 }; }\r\n  //     var obj = { width:this.width, height:this.height };\r\n  //     return obj;\r\n  //   };\r\n  //   image.onerror = function(){\r\n  //     try { console.error( '[Error] Unable to load image: ' + inImgUrl ); } catch(ex){}\r\n  //   };\r\n\r\n  //   // C: Load image\r\n  //   image.src = inImgUrl;\r\n  // }\r\n\r\n  function convertImgToDataURLviaCanvas(slideRel) {\r\n    // A: Create\r\n    var image = new Image();\r\n\r\n    // B: Set onload event\r\n    image.onload = function(){\r\n      // First: Check for any errors: This is the best method (try/catch wont work, etc.)\r\n      if (this.width + this.height == 0) { this.onerror(); return; }\r\n      var canvas = document.createElement('CANVAS');\r\n      var ctx = canvas.getContext('2d');\r\n      canvas.height = this.height;\r\n      canvas.width  = this.width;\r\n      ctx.drawImage(this, 0, 0);\r\n      // Users running on local machine will get the following error:\r\n      // \"SecurityError: Failed to execute 'toDataURL' on 'HTMLCanvasElement': Tainted canvases may not be exported.\"\r\n      // when the canvas.toDataURL call executes below.\r\n      try { callbackImgToDataURLDone( canvas.toDataURL(slideRel.type), slideRel ); }\r\n      catch(ex) {\r\n        this.onerror();\r\n        return;\r\n      }\r\n      canvas = null;\r\n    };\r\n    image.onerror = function(){\r\n      if ( typeof window !== 'undefined' && window.location.href.indexOf('file:') == 0 ) {\r\n        console.warn('WARNING: You are running this in a local web browser, which means you cant read local files!\\n(use \\'--allow-file-access-from-files\\' flag with Chrome, etc.)');\r\n      }\r\n      console.error('Unable to load image: \"'+ slideRel.path +'\"\\nPlease check the image URL:\\n'+ ( slideRel.path.indexOf('/') == 0 ? slideRel.path : window.location.href.substring(0,window.location.href.lastIndexOf('/')+1) + slideRel.path ) );\r\n      \r\n      // Return a predefined \"Broken image\" graphic so the user will see something on the slide\r\n      callbackImgToDataURLDone(IMG_BROKEN, slideRel);\r\n    };\r\n\r\n    // C: Load image\r\n    image.src = slideRel.path;\r\n  }\r\n\r\n  function callbackImgToDataURLDone(inStr, slideRel) {\r\n    var intEmpty = 0;\r\n    var clbk = function(rel){\r\n      if ( rel.path == slideRel.path ) rel.data = inStr;\r\n      if ( !rel.data ) intEmpty++;\r\n    };\r\n\r\n    // STEP 1: Set data for this rel, count outstanding\r\n    gObjPptx.slides.forEach(function(slide) {\r\n      slide.rels.forEach(clbk);\r\n    });\r\n    gObjPptx.slideLayouts.forEach(function(layout) {\r\n      layout.rels.forEach(clbk);\r\n    });\r\n    gObjPptx.masterSlide.rels.forEach(clbk);\r\n\r\n    // STEP 2: Continue export process if all rels have base64 `data` now\r\n    if ( intEmpty == 0 ) doExportPresentation();\r\n  }\r\n\r\n  function getShapeInfo(shapeName) {\r\n    if ( !shapeName ) return gObjPptxShapes.RECTANGLE;\r\n\r\n    if ( typeof shapeName == 'object' && shapeName.name && shapeName.displayName && shapeName.avLst ) return shapeName;\r\n\r\n    if ( gObjPptxShapes[shapeName] ) return gObjPptxShapes[shapeName];\r\n\r\n    var objShape = gObjPptxShapes.filter(function(obj){ return obj.name == shapeName || obj.displayName; })[0];\r\n    if ( typeof objShape !== 'undefined' && objShape != null ) return objShape;\r\n\r\n    return gObjPptxShapes.RECTANGLE;\r\n  }\r\n\r\n  function getSmartParseNumber(inVal, inDir) {\r\n    // FIRST: Convert string numeric value if reqd\r\n    if ( typeof inVal == 'string' && !isNaN(Number(inVal)) ) inVal = Number(inVal);\r\n\r\n    // CASE 1: Number in inches\r\n    // Figure any number less than 100 is inches\r\n    if ( typeof inVal == 'number' && inVal < 100 ) return inch2Emu(inVal);\r\n\r\n    // CASE 2: Number is already converted to something other than inches\r\n    // Figure any number greater than 100 is not inches! :)  Just return it (its EMU already i guess??)\r\n    if ( typeof inVal == 'number' && inVal >= 100 ) return inVal;\r\n\r\n    // CASE 3: Percentage (ex: '50%')\r\n    if ( typeof inVal == 'string' && inVal.indexOf('%') > -1 ) {\r\n      if ( inDir && inDir == 'X') return Math.round( (parseInt(inVal,10) / 100) * gObjPptx.pptLayout.width  );\r\n      if ( inDir && inDir == 'Y') return Math.round( (parseInt(inVal,10) / 100) * gObjPptx.pptLayout.height );\r\n      // Default: Assume width (x/cx)\r\n      return Math.round( (parseInt(inVal,10) / 100) * gObjPptx.pptLayout.width );\r\n    }\r\n\r\n    // LAST: Default value\r\n    return 0;\r\n  }\r\n\r\n  /**\r\n   * DESC: Replace special XML characters with HTML-encoded strings\r\n   */\r\n  function decodeXmlEntities(inStr) {\r\n    // NOTE: Dont use short-circuit eval here as value c/b \"0\" (zero) etc.!\r\n    if ( typeof inStr === 'undefined' || inStr == null ) return '';\r\n    return inStr.toString().replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\"/g,'&quot;').replace(/\\'/g,'&apos;');\r\n  }\r\n\r\n  function createHyperlinkRels(inText, slideRels) {\r\n    var arrTextObjects = [];\r\n\r\n    // Only text objects can have hyperlinks, so return if this is plain text/number\r\n    if ( typeof inText === 'string' || typeof inText === 'number' ) return;\r\n    // IMPORTANT: Check for isArray before typeof=object, or we'll exhaust recursion!\r\n    else if ( Array.isArray(inText) ) arrTextObjects = inText;\r\n    else if ( typeof inText === 'object' ) arrTextObjects = [inText];\r\n\r\n    arrTextObjects.forEach(function(text){\r\n      // `text` can be an array of other `text` objects (table cell word-level formatting), so use recursion\r\n      if ( Array.isArray(text) ) createHyperlinkRels(text, slideRels);\r\n      else if ( text && typeof text === 'object' && text.options && text.options.hyperlink && !text.options.hyperlink.rId ) {\r\n        if ( typeof text.options.hyperlink !== 'object' ) console.log('ERROR: text `hyperlink` option should be an object. Ex: `hyperlink: {url:\\'https://github.com\\'}` ');\r\n        else if ( !text.options.hyperlink.url || typeof text.options.hyperlink.url !== 'string' ) console.log('ERROR: \\'hyperlink.url is required and/or should be a string\\'');\r\n        else {\r\n          var intRels = 1;\r\n          gObjPptx.slides.forEach(function(slide){ intRels += slide.rels.length; });\r\n          var intRelId = intRels+1;\r\n\r\n          slideRels.push({\r\n            type: 'hyperlink',\r\n            data: 'dummy',\r\n            rId:  intRelId,\r\n            Target: text.options.hyperlink.url\r\n          });\r\n\r\n          text.options.hyperlink.rId = intRelId;\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n  * Magic happens here\r\n  */\r\n  function parseTextToLines(cell, inWidth) {\r\n    var CHAR = 2.2 + (cell.opts && cell.opts.lineWeight ? cell.opts.lineWeight : 0); // Character Constant (An approximation of the Golden Ratio)\r\n    var CPL = (inWidth*EMU / ( (cell.opts.font_size || DEF_FONT_SIZE)/CHAR )); // Chars-Per-Line\r\n    var arrLines = [];\r\n    var strCurrLine = '';\r\n\r\n    // Allow a single space/whitespace as cell text\r\n    if ( cell.text && cell.text.trim() == '' ) return [' '];\r\n\r\n    // A: Remove leading/trailing space\r\n    var inStr = (cell.text || '').toString().trim();\r\n\r\n    // B: Build line array\r\n    $$.each(inStr.split('\\n'), function(i,line){\r\n      $$.each(line.split(' '), function(i,word){\r\n        if ( strCurrLine.length + word.length + 1 < CPL ) {\r\n          strCurrLine += (word + ' ');\r\n        }\r\n        else {\r\n          if ( strCurrLine ) arrLines.push( strCurrLine );\r\n          strCurrLine = (word + ' ');\r\n        }\r\n      });\r\n      // All words for this line have been exhausted, flush buffer to new line, clear line var\r\n      if ( strCurrLine ) arrLines.push( $$.trim(strCurrLine) + CRLF );\r\n      strCurrLine = '';\r\n    });\r\n\r\n    // C: Remove trailing linebreak\r\n    arrLines[(arrLines.length-1)] = $$.trim(arrLines[(arrLines.length-1)]);\r\n\r\n    // D: Return lines\r\n    return arrLines;\r\n  }\r\n\r\n  /**\r\n  * Magic happens here\r\n  */\r\n  function getSlidesForTableRows(inArrRows, opts) {\r\n    opts = opts || {};\r\n    var LINEH_MODIFIER = 1.9;\r\n    var arrInchMargins = DEF_SLIDE_MARGIN_IN; // (0.5\" on all sides)\r\n    var arrObjSlides = [], arrRows = [], currRow = [];\r\n    var emuTabCurrH = 0;\r\n    var emuSlideTabW = EMU*1, emuSlideTabH = EMU*1;\r\n    var arrObjTabHeadRows = opts.arrObjTabHeadRows || '';\r\n    var numCols = 0;\r\n\r\n    if (opts.debug) console.log('------------------------------------');\r\n    if (opts.debug) console.log('opts.w ............. = '+ (opts.w||'').toString());\r\n    if (opts.debug) console.log('opts.colW .......... = '+ (opts.colW||'').toString());\r\n    if (opts.debug) console.log('opts.slideMargin ... = '+ (opts.slideMargin||'').toString());\r\n\r\n    // NOTE: Use default size as zero cell margin is causing our tables to be too large and touch bottom of slide!\r\n    if ( !opts.slideMargin && opts.slideMargin != 0 ) opts.slideMargin = DEF_SLIDE_MARGIN_IN[0];\r\n\r\n    // STEP 1: Calc margins/usable space\r\n    if ( opts.slideMargin || opts.slideMargin == 0 ) {\r\n      if ( Array.isArray(opts.slideMargin) ) arrInchMargins = opts.slideMargin;\r\n      else if ( !isNaN(opts.slideMargin) ) arrInchMargins = [opts.slideMargin, opts.slideMargin, opts.slideMargin, opts.slideMargin];\r\n    }\r\n    else if ( opts && opts.master && opts.master.margin ) {\r\n      if ( Array.isArray(opts.master.margin) ) arrInchMargins = opts.master.margin;\r\n      else if ( !isNaN(opts.master.margin) ) arrInchMargins = [opts.master.margin, opts.master.margin, opts.master.margin, opts.master.margin];\r\n    }\r\n\r\n    // STEP 2: Calc number of columns\r\n    // NOTE: Cells may have a colspan, so merely taking the length of the [0] (or any other) row is not\r\n    // ....: sufficient to determine column count. Therefore, check each cell for a colspan and total cols as reqd\r\n    inArrRows[0].forEach(function(cell){\r\n      if (!cell) cell = {};\r\n      var cellOpts = cell.options || cell.opts || null; // DEPRECATED (`opts`)\r\n      numCols += ( cellOpts && cellOpts.colspan ? cellOpts.colspan : 1 );\r\n    });\r\n\r\n    if (opts.debug) console.log('arrInchMargins ..... = '+ arrInchMargins.toString());\r\n    if (opts.debug) console.log('numCols ............ = '+ numCols );\r\n\r\n    // Calc opts.w if we can\r\n    if ( !opts.w && opts.colW ) {\r\n      if ( Array.isArray(opts.colW) ) opts.colW.forEach(function(val){ opts.w += val; });\r\n      else { opts.w = opts.colW * numCols; }\r\n    }\r\n\r\n    // STEP 2: Calc usable space/table size now that we have usable space calc'd\r\n    emuSlideTabW = ( opts.w ? inch2Emu(opts.w) : (gObjPptx.pptLayout.width - inch2Emu((opts.x || arrInchMargins[1]) + arrInchMargins[3])) );\r\n    if (opts.debug) console.log('emuSlideTabW (in) ........ = '+ (emuSlideTabW/EMU).toFixed(1) );\r\n    if (opts.debug) console.log('gObjPptx.pptLayout.h ..... = '+ (gObjPptx.pptLayout.height/EMU));\r\n\r\n    // STEP 3: Calc column widths if needed so we can subsequently calc lines (we need `emuSlideTabW`!)\r\n    if ( !opts.colW || !Array.isArray(opts.colW) ) {\r\n      if ( opts.colW && !isNaN(Number(opts.colW)) ) {\r\n        var arrColW = [];\r\n        inArrRows[0].forEach(function(){ arrColW.push( opts.colW ); });\r\n        opts.colW = [];\r\n        arrColW.forEach(function(val){ opts.colW.push(val); });\r\n      }\r\n      // No column widths provided? Then distribute cols.\r\n      else {\r\n        opts.colW = [];\r\n        for (var iCol=0; iCol<numCols; iCol++) { opts.colW.push( (emuSlideTabW/EMU/numCols) ); }\r\n      }\r\n    }\r\n\r\n    // STEP 4: Iterate over each line and perform magic =========================\r\n    // NOTE: inArrRows will be an array of {text:'', opts{}} whether from `addSlidesForTable()` or `.addTable()`\r\n    inArrRows.forEach(function(row,iRow){\r\n      // A: Reset ROW variables\r\n      var arrCellsLines = [], arrCellsLineHeights = [], intMaxLineCnt = 0, intMaxColIdx = 0;\r\n\r\n      // B: Calc usable vertical space/table height\r\n      // NOTE: Use margins after the first Slide (dont re-use opt.y - it could've been halfway down the page!) (ISSUE#43,ISSUE#47,ISSUE#48)\r\n      if ( arrObjSlides.length > 0 ) {\r\n        emuSlideTabH = ( gObjPptx.pptLayout.height - inch2Emu( (opts.y/EMU < arrInchMargins[0] ? opts.y/EMU : arrInchMargins[0]) + arrInchMargins[2]) );\r\n        // Use whichever is greater: area between margins or the table H provided (dont shrink usable area - the whole point of over-riding X on paging is to *increarse* usable space)\r\n        if ( emuSlideTabH < opts.h ) emuSlideTabH = opts.h;\r\n      }\r\n      else emuSlideTabH = ( opts.h ? opts.h : (gObjPptx.pptLayout.height - inch2Emu((opts.y/EMU || arrInchMargins[0]) + arrInchMargins[2])) );\r\n      if (opts.debug) console.log('* Slide '+arrObjSlides.length+': emuSlideTabH (in) ........ = '+ (emuSlideTabH/EMU).toFixed(1));\r\n\r\n      // C: Parse and store each cell's text into line array (**MAGIC HAPPENS HERE**)\r\n      row.forEach(function(cell,iCell){\r\n        // FIRST: REALITY-CHECK:\r\n        if (!cell) cell = {};\r\n\r\n        // DESIGN: Cells are henceforth {objects} with `text` and `opts`\r\n        var lines = [];\r\n\r\n        // 1: Cleanse data\r\n        if ( !isNaN(cell) || typeof cell === 'string' ) {\r\n          // Grab table formatting `opts` to use here so text style/format inherits as it should\r\n          cell = { text:cell.toString(), opts:opts };\r\n        }\r\n        else if ( typeof cell === 'object' ) {\r\n          // ARG0: `text`\r\n          if ( typeof cell.text === 'number' ) cell.text = cell.text.toString();\r\n          else if ( typeof cell.text === 'undefined' || cell.text == null ) cell.text = '';\r\n\r\n          // ARG1: `options`\r\n          var opt = cell.options || cell.opts || {}; // Legacy support for `opts` (<= v1.2.0)\r\n          cell.opts = opt; // This odd soln is needed until `opts` can be safely discarded (DEPRECATED)\r\n        }\r\n        // Capture some table options for use in other functions\r\n        cell.opts.lineWeight = opts.lineWeight;\r\n\r\n        // 2: Create a cell object for each table column\r\n        currRow.push({ text:'', opts:cell.opts });\r\n\r\n        // 3: Parse cell contents into lines (**MAGIC HAPPENSS HERE**)\r\n        lines = parseTextToLines(cell, (opts.colW[iCell]/ONEPT));\r\n        arrCellsLines.push( lines );\r\n        //if (opts.debug) console.log('Cell:'+iCell+' - lines:'+lines.length);\r\n\r\n        // 4: Keep track of max line count within all row cells\r\n        if ( lines.length > intMaxLineCnt ) { intMaxLineCnt = lines.length; intMaxColIdx = iCell; }\r\n        var lineHeight = inch2Emu((cell.opts.font_size || opts.font_size || DEF_FONT_SIZE) * LINEH_MODIFIER / 100);\r\n        // NOTE: Exempt cells with `rowspan` from increasing lineHeight (or we could create a new slide when unecessary!)\r\n        if ( cell.opts && cell.opts.rowspan ) lineHeight = 0;\r\n\r\n        // 5: Add cell margins to lineHeight (if any)\r\n        if ( cell.opts.margin ) {\r\n          if ( cell.opts.margin[0] ) lineHeight += (cell.opts.margin[0]*ONEPT) / intMaxLineCnt;\r\n          if ( cell.opts.margin[2] ) lineHeight += (cell.opts.margin[2]*ONEPT) / intMaxLineCnt;\r\n        }\r\n\r\n        // Add to array\r\n        arrCellsLineHeights.push( Math.round(lineHeight) );\r\n      });\r\n\r\n      // D: AUTO-PAGING: Add text one-line-a-time to this row's cells until: lines are exhausted OR table H limit is hit\r\n      for (var idx=0; idx<intMaxLineCnt; idx++) {\r\n        // 1: Add the current line to cell\r\n        for (var col=0; col<arrCellsLines.length; col++) {\r\n          // A: Commit this slide to Presenation if table Height limit is hit\r\n          if ( emuTabCurrH + arrCellsLineHeights[intMaxColIdx] > emuSlideTabH ) {\r\n            if (opts.debug) console.log('--------------- New Slide Created ---------------');\r\n            if (opts.debug) console.log(' (calc) '+ (emuTabCurrH/EMU).toFixed(1) +'+'+ (arrCellsLineHeights[intMaxColIdx]/EMU).toFixed(1) +' > '+ emuSlideTabH/EMU.toFixed(1));\r\n            if (opts.debug) console.log('--------------- New Slide Created ---------------');\r\n            // 1: Add the current row to table\r\n            // NOTE: Edge cases can occur where we create a new slide only to have no more lines\r\n            // ....: and then a blank row sits at the bottom of a table!\r\n            // ....: Hence, we verify all cells have text before adding this final row.\r\n            $$.each(currRow, function(i,cell){\r\n              if (cell.text.length > 0 ) {\r\n                // IMPORTANT: use jQuery extend (deep copy) or cell will mutate!!\r\n                arrRows.push( $$.extend(true, [], currRow) );\r\n                return false; // break out of .each loop\r\n              }\r\n            });\r\n            // 2: Add new Slide with current array of table rows\r\n            arrObjSlides.push( $$.extend(true, [], arrRows) );\r\n            // 3: Empty rows for new Slide\r\n            arrRows.length = 0;\r\n            // 4: Reset current table height for new Slide\r\n            emuTabCurrH = 0; // This row's emuRowH w/b added below\r\n            // 5: Empty current row's text (continue adding lines where we left off below)\r\n            $$.each(currRow,function(i,cell){ cell.text = ''; });\r\n            // 6: Auto-Paging Options: addHeaderToEach\r\n            if ( opts.addHeaderToEach && arrObjTabHeadRows ) {\r\n              var headRow = [];\r\n              $$.each(arrObjTabHeadRows[0], function(iCell,cell){\r\n                headRow.push({ text:cell.text, opts:cell.opts });\r\n                var lines = parseTextToLines(cell,(opts.colW[iCell]/ONEPT));\r\n                if ( lines.length > intMaxLineCnt ) { intMaxLineCnt = lines.length; intMaxColIdx = iCell; }\r\n              });\r\n              arrRows.push( $$.extend(true, [], headRow) );\r\n            }\r\n          }\r\n\r\n          // B: Add next line of text to this cell\r\n          if ( arrCellsLines[col][idx] ) currRow[col].text += arrCellsLines[col][idx];\r\n        }\r\n\r\n        // 2: Add this new rows H to overall (use cell with the most lines as the determiner for overall row Height)\r\n        emuTabCurrH += arrCellsLineHeights[intMaxColIdx];\r\n      }\r\n\r\n      if (opts.debug) console.log('-> '+iRow+ ' row done!');\r\n      if (opts.debug) console.log('-> emuTabCurrH (in) . = '+ (emuTabCurrH/EMU).toFixed(1));\r\n\r\n      // E: Flush row buffer - Add the current row to table, then truncate row cell array\r\n      // IMPORTANT: use jQuery extend (deep copy) or cell will mutate!!\r\n      if (currRow.length) arrRows.push( $$.extend(true,[],currRow) );\r\n      currRow.length = 0;\r\n    });\r\n\r\n    // STEP 4-2: Flush final row buffer to slide\r\n    arrObjSlides.push( $$.extend(true,[],arrRows) );\r\n\r\n    // LAST:\r\n    if (opts.debug) { console.log('arrObjSlides count = '+arrObjSlides.length); console.log(arrObjSlides); }\r\n    return arrObjSlides;\r\n  }\r\n\r\n  /**\r\n   * NOTE: Used by both: text and lineChart\r\n   * Creates `a:innerShdw` or `a:outerShdw` depending on pass options `opts`.\r\n   * @param {Object} opts optional shadow properties\r\n   * @param {Object} defaults defaults for unspecified properties in `opts`\r\n   * @see http://officeopenxml.com/drwSp-effects.php\r\n   *  { type: 'outer', blur: 3, offset: (23000 / 12700), angle: 90, color: '000000', opacity: 0.35, rotateWithShape: true };\r\n   */\r\n  function createShadowElement(options, defaults) {\r\n    if ( options === 'none' ) {\r\n      return '<a:effectLst/>';\r\n    }\r\n    var\r\n      strXml = '<a:effectLst>',\r\n      opts   = mix(defaults, options),\r\n      type            = opts.type || 'outer',\r\n      blur            = opts.blur * ONEPT,\r\n      offset          = opts.offset * ONEPT,\r\n      angle           = opts.angle * 60000,\r\n      color           = opts.color,\r\n      opacity         = opts.opacity * 100000,\r\n      rotateWithShape = opts.rotateWithShape ?  1 : 0;\r\n\r\n    strXml += '<a:'+ type +'Shdw sx=\"100000\" sy=\"100000\" kx=\"0\" ky=\"0\"  algn=\"bl\" blurRad=\"'+ blur +'\" ';\r\n    strXml += 'rotWithShape=\"'+ (+rotateWithShape) +'\"';\r\n    strXml += ' dist=\"'+ offset +'\" dir=\"'+ angle +'\">';\r\n    strXml += '<a:srgbClr val=\"'+ color +'\">'; // TODO: should accept scheme colors implemented in Issue #135\r\n    strXml += '<a:alpha val=\"'+ opacity +'\"/></a:srgbClr>';\r\n    strXml += '</a:'+ type +'Shdw>';\r\n    strXml += '</a:effectLst>';\r\n\r\n    return strXml;\r\n  }\r\n\r\n  /**\r\n   * Checks shadow options passed by user and performs corrections if needed.\r\n   * @param {Object} shadowOpts\r\n   */\r\n  function correctShadowOptions(shadowOpts) {\r\n    if ( !shadowOpts || shadowOpts === 'none' ) return;\r\n\r\n    // OPT: `type`\r\n    if ( shadowOpts.type != 'outer' && shadowOpts.type != 'inner' ) {\r\n      console.warn('Warning: shadow.type options are `outer` or `inner`.');\r\n      shadowOpts.type = 'outer';\r\n    }\r\n\r\n    // OPT: `angle`\r\n    if ( shadowOpts.angle ) {\r\n      // A: REALITY-CHECK\r\n      if ( isNaN(Number(shadowOpts.angle)) || shadowOpts.angle < 0 || shadowOpts.angle > 359 ) {\r\n        console.warn('Warning: shadow.angle can only be 0-359');\r\n        shadowOpts.angle = 270;\r\n      }\r\n\r\n      // B: ROBUST: Cast any type of valid arg to int: '12', 12.3, etc. -> 12\r\n      shadowOpts.angle = Math.round(Number(shadowOpts.angle));\r\n    }\r\n\r\n    // OPT: `opacity`\r\n    if ( shadowOpts.opacity ) {\r\n      // A: REALITY-CHECK\r\n      if ( isNaN(Number(shadowOpts.opacity)) || shadowOpts.opacity < 0 || shadowOpts.opacity > 1 ) {\r\n        console.warn('Warning: shadow.opacity can only be 0-1');\r\n        shadowOpts.opacity = 0.75;\r\n      }\r\n\r\n      // B: ROBUST: Cast any type of valid arg to int: '12', 12.3, etc. -> 12\r\n      shadowOpts.opacity = Number(shadowOpts.opacity);\r\n    }\r\n  }\r\n\r\n  function correctGridLineOptions(glOpts) {\r\n    if ( !glOpts || glOpts === 'none' ) return;\r\n    if ( glOpts.size !== undefined && (isNaN(Number(glOpts.size)) || glOpts.size <= 0) ) {\r\n      console.warn('Warning: chart.gridLine.size must be greater than 0.');\r\n      delete glOpts.size; // delete prop to used defaults\r\n    }\r\n    if ( glOpts.style && ['solid', 'dash', 'dot'].indexOf(glOpts.style) < 0 ) {\r\n      console.warn('Warning: chart.gridLine.style options: `solid`, `dash`, `dot`.');\r\n      delete glOpts.style;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {Object} glOpts {size, color, style}\r\n   * @param {Object} defaults {size, color, style}\r\n   * @param {String} type \"major\"(default) | \"minor\"\r\n   */\r\n  function createGridLineElement(glOpts, defaults, type) {\r\n    type = type || 'major';\r\n    var tagName = 'c:'+ type + 'Gridlines';\r\n    var strXml =  '<'+ tagName + '>';\r\n    strXml += ' <c:spPr>';\r\n    strXml += '  <a:ln w=\"' + Math.round((glOpts.size || defaults.size) * ONEPT) +'\" cap=\"flat\">';\r\n    strXml += '  <a:solidFill><a:srgbClr val=\"' + (glOpts.color || defaults.color) + '\"/></a:solidFill>'; // should accept scheme colors as implemented in PR 135\r\n    strXml += '   <a:prstDash val=\"' + (glOpts.style || defaults.style) + '\"/><a:round/>';\r\n    strXml += '  </a:ln>';\r\n    strXml += ' </c:spPr>';\r\n    strXml += '</'+ tagName + '>';\r\n    return strXml;\r\n  }\r\n\r\n  function encodeImageRelations(layout, arrRelsDone) {\r\n    var intRels = 0;\r\n\r\n    layout.rels.forEach(function(rel){\r\n      // Read and Encode each image into base64 for use in export\r\n      if ( rel.type != 'online' && rel.type != 'chart' && !rel.data && $$.inArray(rel.path, arrRelsDone) == -1 ) {\r\n        intRels++;\r\n        convertImgToDataURLviaCanvas(rel);\r\n        arrRelsDone.push(rel.path);\r\n      }\r\n    });\r\n\r\n    return intRels;\r\n  }\r\n\r\n  function createMediaFiles(layout, zip, chartPromises) {\r\n    layout.rels.forEach(function(rel) {\r\n      if ( rel.type == 'chart' ) {\r\n        chartPromises.push(gObjPptxGenerators.createExcelWorksheet(rel, zip));\r\n      }\r\n      else if ( rel.type != 'online' && rel.type != 'hyperlink' ) {\r\n        // A: Loop vars\r\n        var data = rel.data;\r\n\r\n        // B: Users will undoubtedly pass various string formats, so modify as needed\r\n        if      ( data.indexOf(',') == -1 && data.indexOf(';') == -1 ) data = 'image/png;base64,' + data;\r\n        else if ( data.indexOf(',') == -1                            ) data = 'image/png;base64,' + data;\r\n        else if ( data.indexOf(';') == -1                            ) data = 'image/png;' + data;\r\n\r\n        // C: Add media\r\n        zip.file( rel.Target.replace('..','ppt'), data.split(',').pop(), {base64:true} );\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * shallow mix, returns new object\r\n   */\r\n  function mix () {\r\n    var o = {};\r\n    for (var i = 0; i <= arguments.length; i++){\r\n      var oN = arguments[i];\r\n      if(oN){\r\n        Object.keys(oN).forEach(function (key) {\r\n          o[key] = oN[key];\r\n        });\r\n      }\r\n    }\r\n    return o;\r\n  }\r\n\r\n  /* =======================================================================================================\r\n  |\r\n  #     #  #     #  #             #####\r\n   #   #   ##   ##  #            #     #  ######  #    #  ######  #####     ##    #####  #   ####   #    #\r\n    # #    # # # #  #            #        #       ##   #  #       #    #   #  #     #    #  #    #  ##   #\r\n     #     #  #  #  #            #  ####  #####   # #  #  #####   #    #  #    #    #    #  #    #  # #  #\r\n    # #    #     #  #            #     #  #       #  # #  #       #####   ######    #    #  #    #  #  # #\r\n   #   #   #     #  #            #     #  #       #   ##  #       #   #   #    #    #    #  #    #  #   ##\r\n  #     #  #     #  #######       #####   ######  #    #  ######  #    #  #    #    #    #   ####   #    #\r\n  |\r\n  =========================================================================================================\r\n  */\r\n\r\n  /**\r\n  * @see: http://www.datypic.com/sc/ooxml/s-dml-chart.xsd.html\r\n  */\r\n  function makeXmlCharts(rel) {\r\n    // HELPER FUNCS:\r\n    function hasArea (chartType) {\r\n      function has (type) {\r\n        return chartType.some(function (item) {\r\n          return item.type.name === type;\r\n        });\r\n      }\r\n      if (Array.isArray(chartType)) {\r\n        return has('area');\r\n      }\r\n      return chartType.name === 'area';\r\n    }\r\n\r\n    /* ----------------------------------------------------------------------- */\r\n\r\n    // STEP 1: Create chart\r\n    {\r\n      var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>';\r\n      // CHARTSPACE: BEGIN vvv\r\n      strXml += '<c:chartSpace xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">';\r\n      strXml += '<c:date1904 val=\"0\"/>';  // ppt defaults to 1904 dates, excel to 1900\r\n      strXml += '<c:chart>';\r\n\r\n      // OPTION: Title\r\n      if ( rel.opts.showTitle ) {\r\n        strXml += genXmlTitle({\r\n          title: rel.opts.title || 'Chart Title',\r\n          fontSize: rel.opts.titleFontSize || DEF_FONT_TITLE_SIZE,\r\n          color: rel.opts.titleColor,\r\n          fontFace: rel.opts.titleFontFace,\r\n          rotate: rel.opts.titleRotate,\r\n          titleAlign: rel.opts.titleAlign,\r\n          titlePos: rel.opts.titlePos\r\n        });\r\n        strXml += '<c:autoTitleDeleted val=\"0\"/>';\r\n      }\r\n\r\n      strXml += '<c:plotArea>';\r\n      // IMPORTANT: Dont specify layout to enable auto-fit: PPT does a great job maximizing space with all 4 TRBL locations\r\n      if ( rel.opts.layout ) {\r\n        strXml += '<c:layout>';\r\n        strXml += ' <c:manualLayout>';\r\n        strXml += '  <c:layoutTarget val=\"inner\" />';\r\n        strXml += '  <c:xMode val=\"edge\" />';\r\n        strXml += '  <c:yMode val=\"edge\" />';\r\n        strXml += '  <c:x val=\"' + (rel.opts.layout.x || 0) + '\" />';\r\n        strXml += '  <c:y val=\"' + (rel.opts.layout.y || 0) + '\" />';\r\n        strXml += '  <c:w val=\"' + (rel.opts.layout.w || 1) + '\" />';\r\n        strXml += '  <c:h val=\"' + (rel.opts.layout.h || 1) + '\" />';\r\n        strXml += ' </c:manualLayout>';\r\n        strXml += '</c:layout>';\r\n      }\r\n      else {\r\n        strXml += '<c:layout/>';\r\n      }\r\n    }\r\n\r\n    var usesSecondaryValAxis = false;\r\n\r\n    // A: CHART TYPES -----------------------------------------------------------\r\n    if ( Array.isArray(rel.opts.type) ) {\r\n      rel.opts.type.forEach(function (type) {\r\n        var chartType = type.type.name;\r\n        var data = type.data;\r\n        var options = mix(rel.opts, type.options);\r\n        var valAxisId = options.secondaryValAxis ? AXIS_ID_VALUE_SECONDARY : AXIS_ID_VALUE_PRIMARY;\r\n        var catAxisId = options.secondaryCatAxis ? AXIS_ID_CATEGORY_SECONDARY : AXIS_ID_CATEGORY_PRIMARY;\r\n        usesSecondaryValAxis = usesSecondaryValAxis || options.secondaryValAxis;\r\n        strXml += makeChartType(chartType, data, options, valAxisId, catAxisId);\r\n      });\r\n    }\r\n    else {\r\n      var chartType = rel.opts.type.name;\r\n      strXml += makeChartType(chartType, rel.data, rel.opts, AXIS_ID_VALUE_PRIMARY, AXIS_ID_CATEGORY_PRIMARY);\r\n    }\r\n\r\n    // B: AXES -----------------------------------------------------------\r\n    if ( rel.opts.type.name !== 'pie' && rel.opts.type.name !== 'doughnut' ) {\r\n      if ( rel.opts.valAxes && !usesSecondaryValAxis ) {\r\n        throw new Error('Secondary axis must be used by one of the multiple charts');\r\n      }\r\n\r\n      if ( rel.opts.catAxes ) {\r\n        if ( !rel.opts.valAxes || rel.opts.valAxes.length !== rel.opts.catAxes.length ) {\r\n          throw new Error('There must be the same number of value and category axes.');\r\n        }\r\n        strXml += makeCatAxis(mix(rel.opts, rel.opts.catAxes[0]), AXIS_ID_CATEGORY_PRIMARY);\r\n        if ( rel.opts.catAxes[1] ) {\r\n          strXml += makeCatAxis(mix(rel.opts, rel.opts.catAxes[1]), AXIS_ID_CATEGORY_SECONDARY);\r\n        }\r\n      }\r\n      else {\r\n        strXml += makeCatAxis(rel.opts, AXIS_ID_CATEGORY_PRIMARY);\r\n      }\r\n\r\n      rel.opts.hasArea = hasArea(rel.opts.type);\r\n\r\n      if ( rel.opts.valAxes ) {\r\n        strXml += makeValueAxis(mix(rel.opts, rel.opts.valAxes[0]), AXIS_ID_VALUE_PRIMARY, AXIS_ID_CATEGORY_PRIMARY);\r\n        if ( rel.opts.valAxes[1] ) {\r\n          strXml += makeValueAxis(mix(rel.opts, rel.opts.valAxes[1]), AXIS_ID_VALUE_SECONDARY, AXIS_ID_CATEGORY_SECONDARY);\r\n        }\r\n      }\r\n      else {\r\n        strXml += makeValueAxis(rel.opts, AXIS_ID_VALUE_PRIMARY, AXIS_ID_CATEGORY_PRIMARY, AXIS_ID_CATEGORY_SECONDARY);\r\n      }\r\n    }\r\n\r\n    // C: Chart Properties and plotArea Options: Border, Data Table, Fill, Legend\r\n    {\r\n      // NOTE: DataTable goes between '</c:valAx>' and '<c:spPr>'\r\n      if ( rel.opts.showDataTable ) {\r\n        strXml += '<c:dTable>';\r\n        strXml += '  <c:showHorzBorder val=\"'+ (rel.opts.showDataTableHorzBorder == false ? 0 : 1) +'\"/>';\r\n        strXml += '  <c:showVertBorder val=\"'+ (rel.opts.showDataTableVertBorder == false ? 0 : 1) +'\"/>';\r\n        strXml += '  <c:showOutline    val=\"'+ (rel.opts.showDataTableOutline    == false ? 0 : 1) +'\"/>';\r\n        strXml += '  <c:showKeys       val=\"'+ (rel.opts.showDataTableKeys       == false ? 0 : 1) +'\"/>';\r\n        strXml += '  <c:spPr>';\r\n        strXml += '    <a:noFill/>';\r\n        strXml += '    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"tx1\"><a:lumMod val=\"15000\"/><a:lumOff val=\"85000\"/></a:schemeClr></a:solidFill><a:round/></a:ln>';\r\n        strXml += '    <a:effectLst/>';\r\n        strXml += '  </c:spPr>';\r\n        strXml += '  <c:txPr>\\\r\n                    <a:bodyPr rot=\"0\" spcFirstLastPara=\"1\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"1\"/>\\\r\n                    <a:lstStyle/>\\\r\n                    <a:p>\\\r\n                      <a:pPr rtl=\"0\">\\\r\n                        <a:defRPr sz=\"1197\" b=\"0\" i=\"0\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">\\\r\n                          <a:solidFill><a:schemeClr val=\"tx1\"><a:lumMod val=\"65000\"/><a:lumOff val=\"35000\"/></a:schemeClr></a:solidFill>\\\r\n                          <a:latin typeface=\"+mn-lt\"/>\\\r\n                          <a:ea typeface=\"+mn-ea\"/>\\\r\n                          <a:cs typeface=\"+mn-cs\"/>\\\r\n                        </a:defRPr>\\\r\n                      </a:pPr>\\\r\n                      <a:endParaRPr lang=\"en-US\"/>\\\r\n                    </a:p>\\\r\n                  </c:txPr>\\\r\n                </c:dTable>';\r\n      }\r\n\r\n      strXml += '  <c:spPr>';\r\n\r\n      // OPTION: Fill\r\n      strXml += ( rel.opts.fill ? genXmlColorSelection(rel.opts.fill) : '<a:noFill/>' );\r\n\r\n      // OPTION: Border\r\n      strXml += ( rel.opts.border ? '<a:ln w=\"'+ (rel.opts.border.pt * ONEPT) +'\"'+' cap=\"flat\">'+ genXmlColorSelection( rel.opts.border.color ) +'</a:ln>' : '<a:ln><a:noFill/></a:ln>' );\r\n\r\n      // Close shapeProp/plotArea before Legend\r\n      strXml += '    <a:effectLst/>';\r\n      strXml += '  </c:spPr>';\r\n      strXml += '</c:plotArea>';\r\n\r\n      // OPTION: Legend\r\n      // IMPORTANT: Dont specify layout to enable auto-fit: PPT does a great job maximizing space with all 4 TRBL locations\r\n      if ( rel.opts.showLegend ) {\r\n        strXml += '<c:legend>';\r\n        strXml += '<c:legendPos val=\"'+ rel.opts.legendPos +'\"/>';\r\n        strXml += '<c:layout/>';\r\n        strXml += '<c:overlay val=\"0\"/>';\r\n        if ( rel.opts.legendFontSize ) {\r\n          strXml += '<c:txPr>';\r\n          strXml += '  <a:bodyPr/>';\r\n          strXml += '  <a:lstStyle/>';\r\n          strXml += '  <a:p>';\r\n          strXml += '  <a:pPr>';\r\n          strXml += '    <a:defRPr sz=\"'+ (Number(rel.opts.legendFontSize) * 100) +'\"/>';\r\n          strXml += '    </a:pPr>';\r\n          strXml += '    <a:endParaRPr lang=\"en-US\"/>';\r\n          strXml += '  </a:p>';\r\n          strXml += '</c:txPr>';\r\n        }\r\n        strXml += '</c:legend>';\r\n      }\r\n    }\r\n\r\n    strXml += '  <c:plotVisOnly val=\"1\"/>';\r\n    strXml += '  <c:dispBlanksAs val=\"gap\"/>';\r\n    strXml += '</c:chart>';\r\n\r\n    // D: CHARTSPACE SHAPE PROPS\r\n    strXml += '<c:spPr>';\r\n    strXml += '  <a:noFill/>';\r\n    strXml += '  <a:ln w=\"12700\" cap=\"flat\"><a:noFill/><a:miter lim=\"400000\"/></a:ln>';\r\n    strXml += '  <a:effectLst/>';\r\n    strXml += '</c:spPr>';\r\n\r\n    // E: DATA (Add relID)\r\n    strXml += '<c:externalData r:id=\"rId1\"><c:autoUpdate val=\"0\"/></c:externalData>';\r\n\r\n    // LAST: chartSpace end\r\n    strXml += '</c:chartSpace>';\r\n\r\n    return strXml;\r\n  }\r\n\r\n  function makeChartType(chartType, data, opts, valAxisId, catAxisId) {\r\n    var strXml = '';\r\n\r\n    switch ( chartType ) {\r\n    case 'area':\r\n    case 'bar':\r\n    case 'line':\r\n      strXml += '<c:'+ chartType +'Chart>';\r\n      if ( chartType == 'bar' ) strXml += '  <c:barDir val=\"'+ opts.barDir +'\"/>';\r\n      strXml += '  <c:grouping val=\"'+ opts.barGrouping + '\"/>';\r\n      strXml += '  <c:varyColors val=\"0\"/>';\r\n\r\n      // A: \"Series\" block for every data row\r\n      /* EX:\r\n          data: [\r\n             {\r\n               name: 'Region 1',\r\n               labels: ['April', 'May', 'June', 'July'],\r\n               values: [17, 26, 53, 96]\r\n             },\r\n             {\r\n               name: 'Region 2',\r\n               labels: ['April', 'May', 'June', 'July'],\r\n               values: [55, 43, 70, 58]\r\n             }\r\n            ]\r\n        */\r\n\r\n      // NOTE: Maintain the color index by region\r\n      var colorIndex = -1;\r\n      data.forEach(function(obj){\r\n        colorIndex++;\r\n        var idx = obj.index;\r\n        strXml += '<c:ser>';\r\n        strXml += '  <c:idx val=\"'+ idx +'\"/>';\r\n        strXml += '  <c:order val=\"'+ idx +'\"/>';\r\n        strXml += '  <c:tx>';\r\n        strXml += '    <c:strRef>';\r\n        strXml += '      <c:f>Sheet1!$A$'+ (idx+2) +'</c:f>';\r\n        strXml += '      <c:strCache><c:ptCount val=\"1\"/><c:pt idx=\"0\"><c:v>'+ obj.name +'</c:v></c:pt></c:strCache>';\r\n        strXml += '    </c:strRef>';\r\n        strXml += '  </c:tx>';\r\n\r\n        // Fill and Border\r\n        var strSerColor = opts.chartColors[colorIndex % opts.chartColors.length];\r\n\r\n        strXml += '  <c:spPr>';\r\n        if ( strSerColor == 'transparent' ) {\r\n          strXml += '<a:noFill/>';\r\n        }\r\n        else if ( opts.chartColorsOpacity ) {\r\n          strXml += '<a:solidFill>'+ createColorElement(strSerColor, '<a:alpha val=\"50000\"/>') +'</a:solidFill>';\r\n        }\r\n        else {\r\n          strXml += '<a:solidFill>'+ createColorElement(strSerColor) +'</a:solidFill>';\r\n        }\r\n\r\n        if ( chartType == 'line' ) {\r\n          if ( opts.lineSize == 0) {\r\n            strXml += '<a:ln><a:noFill/></a:ln>';\r\n          }\r\n          else {\r\n            strXml += '<a:ln w=\"' + (opts.lineSize * ONEPT) + '\" cap=\"flat\"><a:solidFill>' + createColorElement(strSerColor) + '</a:solidFill>';\r\n            strXml += '<a:prstDash val=\"' + (opts.line_dash || 'solid') + '\"/><a:round/></a:ln>';\r\n          }\r\n        }\r\n        else if ( opts.dataBorder ) {\r\n          strXml += '<a:ln w=\"'+ (opts.dataBorder.pt * ONEPT) +'\" cap=\"flat\"><a:solidFill>'+ createColorElement(opts.dataBorder.color) +'</a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>';\r\n        }\r\n\r\n        strXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW);\r\n\r\n        strXml += '  </c:spPr>';\r\n\r\n        // LINE CHART ONLY: `marker`\r\n        if ( chartType == 'line' ) {\r\n          strXml += '<c:marker>';\r\n          strXml += '  <c:symbol val=\"'+ opts.lineDataSymbol +'\"/>';\r\n          if ( opts.lineDataSymbolSize ) {\r\n            // Defaults to \"auto\" otherwise (but this is usually too small, so there is a default)\r\n            strXml += '  <c:size val=\"'+ opts.lineDataSymbolSize +'\"/>';\r\n          }\r\n          strXml += '  <c:spPr>';\r\n          strXml += '    <a:solidFill>' + createColorElement(opts.chartColors[(idx+1 > opts.chartColors.length ? (Math.floor(Math.random() * opts.chartColors.length)) : idx)]) +'</a:solidFill>';\r\n\r\n          var symbolLineColor = opts.lineDataSymbolLineColor || strSerColor;\r\n          strXml += '    <a:ln w=\"' + opts.lineDataSymbolLineSize + '\" cap=\"flat\"><a:solidFill>'+ createColorElement(symbolLineColor) +'</a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>';\r\n          strXml += '    <a:effectLst/>';\r\n          strXml += '  </c:spPr>';\r\n          strXml += '</c:marker>';\r\n        }\r\n\r\n        // Color bar chart bars various colors\r\n        // Allow users with a single data set to pass their own array of colors (check for this using != ours)\r\n        if (( data.length === 1 || opts.valueBarColors ) && opts.chartColors != BARCHART_COLORS ) {\r\n          // Series Data Point colors\r\n          obj.values.forEach(function(value,index){\r\n            var arrColors = (value < 0 ? (opts.invertedColors || BARCHART_COLORS) : opts.chartColors);\r\n\r\n            strXml += '  <c:dPt>';\r\n            strXml += '    <c:idx val=\"'+ index +'\"/>';\r\n            strXml += '      <c:invertIfNegative val=\"'+ (opts.invertedColors ? 0 : 1) +'\"/>';\r\n            strXml += '    <c:bubble3D val=\"0\"/>';\r\n            strXml += '    <c:spPr>';\r\n            if ( opts.lineSize === 0 ){\r\n              strXml += '<a:ln><a:noFill/></a:ln>';\r\n            }\r\n            else {\r\n              strXml += '<a:solidFill>';\r\n              strXml += ' <a:srgbClr val=\"'+ arrColors[index % arrColors.length] +'\"/>';\r\n              strXml += '</a:solidFill>';\r\n            }\r\n            strXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW);\r\n            strXml += '    </c:spPr>';\r\n            strXml += '  </c:dPt>';\r\n          });\r\n        }\r\n\r\n        // 2: \"Categories\"\r\n        {\r\n          strXml += '<c:cat>';\r\n          if ( opts.catLabelFormatCode ) {\r\n            // Use 'numRef' as catLabelFormatCode implies that we are expecting numbers here\r\n            strXml += '  <c:numRef>';\r\n            strXml += '    <c:f>Sheet1!'+ '$B$1:$'+ getExcelColName(obj.labels.length) +'$1' +'</c:f>';\r\n            strXml += '    <c:numCache>';\r\n            strXml += '      <c:formatCode>'+ opts.catLabelFormatCode +'</c:formatCode>';\r\n            strXml += '      <c:ptCount val=\"'+ obj.labels.length +'\"/>';\r\n            obj.labels.forEach(function(label,idx){ strXml += '<c:pt idx=\"'+ idx +'\"><c:v>'+ decodeXmlEntities(label) +'</c:v></c:pt>'; });\r\n            strXml += '    </c:numCache>';\r\n            strXml += '  </c:numRef>';\r\n          }\r\n          else {\r\n            strXml += '  <c:strRef>';\r\n            strXml += '    <c:f>Sheet1!'+ '$B$1:$'+ getExcelColName(obj.labels.length) +'$1' +'</c:f>';\r\n            strXml += '    <c:strCache>';\r\n            strXml += '      <c:ptCount val=\"'+ obj.labels.length +'\"/>';\r\n            obj.labels.forEach(function(label,idx){ strXml += '<c:pt idx=\"'+ idx +'\"><c:v>'+ decodeXmlEntities(label) +'</c:v></c:pt>'; });\r\n            strXml += '    </c:strCache>';\r\n            strXml += '  </c:strRef>';\r\n          }\r\n          strXml += '</c:cat>';\r\n        }\r\n\r\n        // 3: \"Values\"\r\n        {\r\n          strXml += '  <c:val>';\r\n          strXml += '    <c:numRef>';\r\n          strXml += '      <c:f>Sheet1!'+ '$B$'+ (idx+2) +':$'+ getExcelColName(obj.labels.length) +'$'+ (idx+2) +'</c:f>';\r\n          strXml += '      <c:numCache>';\r\n          strXml += '        <c:ptCount val=\"'+ obj.labels.length +'\"/>';\r\n          obj.values.forEach(function(value,idx){ strXml += '<c:pt idx=\"'+ idx +'\"><c:v>'+ (value || '') +'</c:v></c:pt>'; });\r\n          strXml += '      </c:numCache>';\r\n          strXml += '    </c:numRef>';\r\n          strXml += '  </c:val>';\r\n        }\r\n\r\n        // LINE CHART ONLY: `smooth`\r\n        if ( chartType == 'line' ) strXml += '<c:smooth val=\"'+ (opts.lineSmooth ? '1' : '0' ) +'\"/>';\r\n\r\n        // 4: Close \"SERIES\"\r\n        strXml += '</c:ser>';\r\n\r\n      }); // end forEach\r\n\r\n      // 1: \"Data Labels\"\r\n      strXml += '  <c:dLbls>';\r\n      strXml += '    <c:numFmt formatCode=\"'+ opts.dataLabelFormatCode +'\" sourceLinked=\"0\"/>';\r\n      strXml += '    <c:txPr>';\r\n      strXml += '      <a:bodyPr/>';\r\n      strXml += '      <a:lstStyle/>';\r\n      strXml += '      <a:p><a:pPr>';\r\n      strXml += '        <a:defRPr b=\"0\" i=\"0\" strike=\"noStrike\" sz=\"'+ (opts.dataLabelFontSize || DEF_FONT_SIZE) +'00\" u=\"none\">';\r\n      strXml += '          <a:solidFill>'+ createColorElement(opts.dataLabelColor || DEF_FONT_COLOR) +'</a:solidFill>';\r\n      strXml += '          <a:latin typeface=\"'+ (opts.dataLabelFontFace || 'Arial') +'\"/>';\r\n      strXml += '        </a:defRPr>';\r\n      strXml += '      </a:pPr></a:p>';\r\n      strXml += '    </c:txPr>';\r\n      if ( opts.type != 'area' ) strXml += '    <c:dLblPos val=\"'+ (opts.dataLabelPosition || 'outEnd') +'\"/>';\r\n      strXml += '    <c:showLegendKey val=\"0\"/>';\r\n      strXml += '    <c:showVal val=\"'+ (opts.showValue ? '1' : '0') +'\"/>';\r\n      strXml += '    <c:showCatName val=\"0\"/>';\r\n      strXml += '    <c:showSerName val=\"0\"/>';\r\n      strXml += '    <c:showPercent val=\"0\"/>';\r\n      strXml += '    <c:showBubbleSize val=\"0\"/>';\r\n      strXml += '    <c:showLeaderLines val=\"0\"/>';\r\n      strXml += '  </c:dLbls>';\r\n\r\n      if ( chartType == 'bar' ) {\r\n        strXml += '  <c:gapWidth val=\"'+ opts.barGapWidthPct +'\"/>';\r\n        strXml += '  <c:overlap val=\"'+ (opts.barGrouping.indexOf('tacked') > -1 ? 100 : 0) +'\"/>';\r\n      }\r\n      else if ( chartType == 'line' ) {\r\n        strXml += '  <c:marker val=\"1\"/>';\r\n      }\r\n\r\n      // order matters - category first\r\n      strXml += '  <c:axId val=\"'+ catAxisId +'\"/>';\r\n      strXml += '  <c:axId val=\"'+ valAxisId +'\"/>';\r\n\r\n      strXml += '</c:'+ chartType +'Chart>';\r\n\r\n      // Done with CHART.BAR/LINE\r\n      break;\r\n\r\n    case 'pie':\r\n    case 'doughnut':\r\n      // Use the same var name so code blocks from barChart are interchangeable\r\n      var obj = data[0];\r\n\r\n      /* EX:\r\n          data: [\r\n           {\r\n             name: 'Project Status',\r\n             labels: ['Red', 'Amber', 'Green', 'Unknown'],\r\n             values: [10, 20, 38, 2]\r\n           }\r\n          ]\r\n        */\r\n\r\n      // 1: Start Chart\r\n      strXml += '<c:'+ chartType +'Chart>';\r\n      strXml += '  <c:varyColors val=\"0\"/>';\r\n      strXml += '<c:ser>';\r\n      strXml += '  <c:idx val=\"0\"/>';\r\n      strXml += '  <c:order val=\"0\"/>';\r\n      strXml += '  <c:tx>';\r\n      strXml += '    <c:strRef>';\r\n      strXml += '      <c:f>Sheet1!$A$2</c:f>';\r\n      strXml += '      <c:strCache>';\r\n      strXml += '        <c:ptCount val=\"1\"/>';\r\n      strXml += '        <c:pt idx=\"0\"><c:v>'+ decodeXmlEntities(obj.name) +'</c:v></c:pt>';\r\n      strXml += '      </c:strCache>';\r\n      strXml += '    </c:strRef>';\r\n      strXml += '  </c:tx>';\r\n      strXml += '  <c:spPr>';\r\n      strXml += '    <a:solidFill><a:schemeClr val=\"accent1\"/></a:solidFill>';\r\n      strXml += '    <a:ln w=\"9525\" cap=\"flat\"><a:solidFill><a:srgbClr val=\"F9F9F9\"/></a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>';\r\n      if ( opts.dataNoEffects ) {\r\n        strXml += '<a:effectLst/>';\r\n      }\r\n      else {\r\n        strXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW);\r\n      }\r\n      strXml += '  </c:spPr>';\r\n      strXml += '<c:explosion val=\"0\"/>';\r\n\r\n      // 2: \"Data Point\" block for every data row\r\n      obj.labels.forEach(function(label,idx){\r\n        strXml += '<c:dPt>';\r\n        strXml += '  <c:idx val=\"'+ idx +'\"/>';\r\n        strXml += '  <c:explosion val=\"0\"/>';\r\n        strXml += '  <c:spPr>';\r\n        strXml += '    <a:solidFill>'+ createColorElement(opts.chartColors[(idx+1 > opts.chartColors.length ? (Math.floor(Math.random() * opts.chartColors.length)) : idx)]) +'</a:solidFill>';\r\n        if ( opts.dataBorder ) {\r\n          strXml += '<a:ln w=\"'+ (opts.dataBorder.pt * ONEPT) +'\" cap=\"flat\"><a:solidFill>'+ createColorElement(opts.dataBorder.color) +'</a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>';\r\n        }\r\n        strXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW);\r\n        strXml += '  </c:spPr>';\r\n        strXml += '</c:dPt>';\r\n      });\r\n\r\n      // 3: \"Data Label\" block for every data Label\r\n      strXml += '<c:dLbls>';\r\n      obj.labels.forEach(function(label,idx){\r\n        strXml += '<c:dLbl>';\r\n        strXml += '  <c:idx val=\"'+ idx +'\"/>';\r\n        strXml += '    <c:numFmt formatCode=\"'+ opts.dataLabelFormatCode +'\" sourceLinked=\"0\"/>';\r\n        strXml += '    <c:txPr>';\r\n        strXml += '      <a:bodyPr/><a:lstStyle/>';\r\n        strXml += '      <a:p><a:pPr>';\r\n        strXml += '        <a:defRPr b=\"0\" i=\"0\" strike=\"noStrike\" sz=\"'+ (opts.dataLabelFontSize || DEF_FONT_SIZE) +'00\" u=\"none\">';\r\n        strXml += '          <a:solidFill>'+ createColorElement(opts.dataLabelColor || DEF_FONT_COLOR) +'</a:solidFill>';\r\n        strXml += '          <a:latin typeface=\"'+ (opts.dataLabelFontFace || 'Arial') +'\"/>';\r\n        strXml += '        </a:defRPr>';\r\n        strXml += '      </a:pPr></a:p>';\r\n        strXml += '    </c:txPr>';\r\n        if (chartType == 'pie') {\r\n          strXml += '    <c:dLblPos val=\"'+ (opts.dataLabelPosition || 'inEnd') +'\"/>';\r\n        }\r\n        strXml += '    <c:showLegendKey val=\"0\"/>';\r\n        strXml += '    <c:showVal val=\"'+ (opts.showValue ? '1' : '0') +'\"/>';\r\n        strXml += '    <c:showCatName val=\"'+ (opts.showLabel ? '1' : '0') +'\"/>';\r\n        strXml += '    <c:showSerName val=\"0\"/>';\r\n        strXml += '    <c:showPercent val=\"'+ (opts.showPercent ? '1' : '0') +'\"/>';\r\n        strXml += '    <c:showBubbleSize val=\"0\"/>';\r\n        strXml += '  </c:dLbl>';\r\n      });\r\n      strXml += '<c:numFmt formatCode=\"'+ opts.dataLabelFormatCode +'\" sourceLinked=\"0\"/>\\\r\n                <c:txPr>\\\r\n                  <a:bodyPr/>\\\r\n                  <a:lstStyle/>\\\r\n                  <a:p>\\\r\n                    <a:pPr>\\\r\n                      <a:defRPr b=\"0\" i=\"0\" strike=\"noStrike\" sz=\"1800\" u=\"none\">\\\r\n                        <a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:latin typeface=\"Arial\"/>\\\r\n                      </a:defRPr>\\\r\n                    </a:pPr>\\\r\n                  </a:p>\\\r\n                </c:txPr>\\\r\n                ' + (chartType == 'pie' ? '<c:dLblPos val=\"ctr\"/>' : '') + '\\\r\n                <c:showLegendKey val=\"0\"/>\\\r\n                <c:showVal val=\"0\"/>\\\r\n                <c:showCatName val=\"1\"/>\\\r\n                <c:showSerName val=\"0\"/>\\\r\n                <c:showPercent val=\"1\"/>\\\r\n                <c:showBubbleSize val=\"0\"/>\\\r\n                <c:showLeaderLines val=\"0\"/>';\r\n      strXml += '</c:dLbls>';\r\n\r\n      // 2: \"Categories\"\r\n      strXml += '<c:cat>';\r\n      strXml += '  <c:strRef>';\r\n      strXml += '    <c:f>Sheet1!'+ '$B$1:$'+ getExcelColName(obj.labels.length) +'$1' +'</c:f>';\r\n      strXml += '    <c:strCache>';\r\n      strXml += '      <c:ptCount val=\"'+ obj.labels.length +'\"/>';\r\n      obj.labels.forEach(function(label,idx){ strXml += '<c:pt idx=\"'+ idx +'\"><c:v>'+ decodeXmlEntities(label) +'</c:v></c:pt>'; });\r\n      strXml += '    </c:strCache>';\r\n      strXml += '  </c:strRef>';\r\n      strXml += '</c:cat>';\r\n\r\n      // 3: Create vals\r\n      strXml += '  <c:val>';\r\n      strXml += '    <c:numRef>';\r\n      strXml += '      <c:f>Sheet1!'+ '$B$2:$'+ getExcelColName(obj.labels.length) +'$'+ 2 +'</c:f>';\r\n      strXml += '      <c:numCache>';\r\n      strXml += '        <c:ptCount val=\"'+ obj.labels.length +'\"/>';\r\n      obj.values.forEach(function(value,idx){ strXml += '<c:pt idx=\"'+ idx +'\"><c:v>'+ (value || '') +'</c:v></c:pt>'; });\r\n      strXml += '      </c:numCache>';\r\n      strXml += '    </c:numRef>';\r\n      strXml += '  </c:val>';\r\n\r\n      // 4: Close \"SERIES\"\r\n      strXml += '  </c:ser>';\r\n      strXml += '  <c:firstSliceAng val=\"0\"/>';\r\n      if ( chartType == 'doughnut' ) strXml += '  <c:holeSize val=\"' + (opts.holeSize || 50) + '\"/>';\r\n      strXml += '</c:'+ chartType +'Chart>';\r\n\r\n      // Done with CHART.PIE\r\n      break;\r\n    }\r\n\r\n    return strXml;\r\n  }\r\n\r\n  function makeCatAxis(opts, axisId) {\r\n    var strXml = '';\r\n\r\n    // Start cat axis tag\r\n    strXml += '<c:'+ (opts.catLabelFormatCode ? 'dateAx' : 'catAx') +'>';\r\n\r\n    if ( opts.showCatAxisTitle ) {\r\n      strXml += genXmlTitle({\r\n        title:    opts.catAxisTitle || 'Axis Title',\r\n        fontSize: opts.catAxisTitleFontSize,\r\n        color:    opts.catAxisTitleColor,\r\n        fontFace: opts.catAxisTitleFontFace,\r\n        rotate:   opts.catAxisTitleRotate\r\n      });\r\n    }\r\n\r\n    strXml += '  <c:axId val=\"'+ axisId +'\"/>';\r\n    strXml += '  <c:scaling><c:orientation val=\"'+ (opts.catAxisOrientation || (opts.barDir == 'col' ? 'minMax' : 'minMax')) +'\"/></c:scaling>';\r\n    strXml += '  <c:delete val=\"'+ (opts.catAxisHidden ? 1 : 0) +'\"/>';\r\n    strXml += '  <c:axPos val=\"'+ (opts.barDir == 'col' ? 'b' : 'l') +'\"/>';\r\n    strXml += ( opts.catGridLine !== 'none' ? createGridLineElement(opts.catGridLine, DEF_CHART_GRIDLINE) : '' );\r\n    strXml += '  <c:numFmt formatCode=\"'+ (opts.catLabelFormatCode || 'General') +'\" sourceLinked=\"0\"/>';\r\n    strXml += '  <c:majorTickMark val=\"out\"/>';\r\n    strXml += '  <c:minorTickMark val=\"none\"/>';\r\n    strXml += '  <c:tickLblPos val=\"'+ (opts.barDir == 'col' ? 'low' : 'nextTo') +'\"/>';\r\n    strXml += '  <c:spPr>';\r\n    strXml += '    <a:ln w=\"12700\" cap=\"flat\"><a:solidFill><a:srgbClr val=\"888888\"/></a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>';\r\n    strXml += '  </c:spPr>';\r\n    strXml += '  <c:txPr>';\r\n    strXml += '    <a:bodyPr/>';  // don't specify rot 0 so we get the auto behavior\r\n    strXml += '    <a:lstStyle/>';\r\n    strXml += '    <a:p>';\r\n    strXml += '    <a:pPr>';\r\n    strXml += '<a:defRPr b=\"0\" i=\"0\" strike=\"noStrike\" sz=\"'+ (opts.catAxisLabelFontSize || DEF_FONT_SIZE) +'00\" u=\"none\">';\r\n    strXml += '<a:solidFill><a:srgbClr val=\"'+ (opts.catAxisLabelColor || DEF_FONT_COLOR) +'\"/></a:solidFill>';\r\n    strXml += '<a:latin typeface=\"'+ (opts.catAxisLabelFontFace || 'Arial') +'\"/>';\r\n    strXml += '   </a:defRPr>';\r\n    strXml += '  </a:pPr>';\r\n    strXml += '  </a:p>';\r\n    strXml += ' </c:txPr>';\r\n    strXml += ' <c:crossAx val=\"'+ axisId +'\"/>';\r\n    strXml += ' <c:crosses val=\"autoZero\"/>';\r\n    strXml += ' <c:auto val=\"1\"/>';\r\n    strXml += ' <c:lblAlgn val=\"ctr\"/>';\r\n    strXml += ' <c:noMultiLvlLbl val=\"1\"/>';\r\n    if ( opts.catAxisLabelFrequency ) strXml += ' <c:tickLblSkip val=\"' +  opts.catAxisLabelFrequency + '\"/>';\r\n\r\n    // Issue#149: PPT will auto-adjust these as needed after calcing the date bounds, so we only include them when specified by user\r\n    if ( opts.catLabelFormatCode ) {\r\n      ['catAxisBaseTimeUnit','catAxisMajorTimeUnit','catAxisMinorTimeUnit'].forEach(function(opt){\r\n        // Validate input as poorly chosen/garbage options will cause chart corruption and it wont render at all!\r\n        if ( opts[opt] && (typeof opts[opt] !== 'string' || ['days','months','years'].indexOf(opt.toLowerCase()) == -1) ) {\r\n          console.warn('`'+opt+'` must be one of: \\'days\\',\\'months\\',\\'years\\' !');\r\n          opts[opt] = null;\r\n        }\r\n      });\r\n      if ( opts.catAxisBaseTimeUnit )  strXml += ' <c:baseTimeUnit  val=\"'+ opts.catAxisBaseTimeUnit.toLowerCase()  +'\"/>';\r\n      if ( opts.catAxisMajorTimeUnit ) strXml += ' <c:majorTimeUnit val=\"'+ opts.catAxisMajorTimeUnit.toLowerCase() +'\"/>';\r\n      if ( opts.catAxisMinorTimeUnit ) strXml += ' <c:minorTimeUnit val=\"'+ opts.catAxisMinorTimeUnit.toLowerCase() +'\"/>';\r\n      if ( opts.catAxisMajorUnit )     strXml += ' <c:majorUnit     val=\"'+ opts.catAxisMajorUnit +'\"/>';\r\n      if ( opts.catAxisMinorUnit )     strXml += ' <c:minorUnit     val=\"'+ opts.catAxisMinorUnit +'\"/>';\r\n    }\r\n\r\n    // Close cat axis tag\r\n    strXml += '</c:'+ (opts.catLabelFormatCode ? 'dateAx' : 'catAx') +'>';\r\n\r\n    return strXml;\r\n  }\r\n\r\n  function makeValueAxis(opts, valAxisId) {\r\n    var axisPos = valAxisId === AXIS_ID_VALUE_PRIMARY ? (opts.barDir == 'col' ? 'l' : 'b') : (opts.barDir == 'col' ? 'r' : 't');\r\n    var strXml = '';\r\n    var isRight = axisPos === 'r' || axisPos === 't';\r\n    var crosses = isRight ? 'max' : 'autoZero';\r\n    var crossAxId = valAxisId === AXIS_ID_VALUE_PRIMARY ? AXIS_ID_CATEGORY_PRIMARY : AXIS_ID_CATEGORY_SECONDARY;\r\n\r\n    strXml += '<c:valAx>';\r\n    if (opts.showValAxisTitle) {\r\n      strXml += genXmlTitle({\r\n        title: opts.valAxisTitle || 'Axis Title',\r\n        fontSize: opts.valAxisTitleFontSize,\r\n        color: opts.valAxisTitleColor,\r\n        fontFace: opts.valAxisTitleFontFace,\r\n        rotate: opts.valAxisTitleRotate\r\n      });\r\n    }\r\n    strXml += '  <c:axId val=\"'+ valAxisId +'\"/>';\r\n    strXml += '  <c:scaling>';\r\n    strXml += '    <c:orientation val=\"'+ (opts.valAxisOrientation || (opts.barDir == 'col' ? 'minMax' : 'minMax')) +'\"/>';\r\n    if (opts.valAxisMaxVal) strXml += '<c:max val=\"'+ opts.valAxisMaxVal +'\"/>';\r\n    if (opts.valAxisMinVal) strXml += '<c:min val=\"'+ opts.valAxisMinVal +'\"/>';\r\n    strXml += '  </c:scaling>';\r\n    strXml += '  <c:delete val=\"'+ (opts.valAxisHidden ? 1 : 0) +'\"/>';\r\n    strXml += '  <c:axPos val=\"'+ axisPos +'\"/>';\r\n    if (opts.valGridLine != 'none') strXml += createGridLineElement(opts.valGridLine, DEF_CHART_GRIDLINE);\r\n    strXml += ' <c:numFmt formatCode=\"'+ (opts.valAxisLabelFormatCode ? opts.valAxisLabelFormatCode : 'General') +'\" sourceLinked=\"0\"/>';\r\n    strXml += ' <c:majorTickMark val=\"out\"/>';\r\n    strXml += ' <c:minorTickMark val=\"none\"/>';\r\n    strXml += ' <c:tickLblPos val=\"'+ (opts.barDir == 'col' ? 'nextTo' : 'low') +'\"/>';\r\n    strXml += '<c:spPr>';\r\n    strXml += '  <a:ln w=\"12700\" cap=\"flat\"><a:solidFill><a:srgbClr val=\"888888\"/></a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>';\r\n    strXml += '</c:spPr>';\r\n    strXml += ' <c:txPr>';\r\n    strXml += '  <a:bodyPr/>'; // don't specify rot=0 so we can get the PPT default\r\n    strXml += '  <a:lstStyle/>';\r\n    strXml += '  <a:p>';\r\n    strXml += '    <a:pPr>';\r\n    strXml += '      <a:defRPr b=\"0\" i=\"0\" strike=\"noStrike\" sz=\"'+ (opts.valAxisLabelFontSize || DEF_FONT_SIZE) +'00\" u=\"none\">';\r\n    strXml += '        <a:solidFill><a:srgbClr val=\"'+ (opts.valAxisLabelColor || DEF_FONT_COLOR) +'\"/></a:solidFill>';\r\n    strXml += '        <a:latin typeface=\"'+ (opts.valAxisLabelFontFace || 'Arial') +'\"/>';\r\n    strXml += '      </a:defRPr>';\r\n    strXml += '    </a:pPr>';\r\n    strXml += '  </a:p>';\r\n    strXml += ' </c:txPr>';\r\n    strXml += ' <c:crossAx val=\"'+ crossAxId +'\"/>';\r\n    strXml += ' <c:crosses val=\"'+ crosses +'\"/>';\r\n    strXml += ' <c:crossBetween val=\"'+ ( opts.hasArea ? 'midCat' : 'between' ) +'\"/>';\r\n    if ( opts.valAxisMajorUnit ) strXml += ' <c:majorUnit val=\"'+ opts.valAxisMajorUnit +'\"/>';\r\n    strXml += '</c:valAx>';\r\n\r\n    return strXml;\r\n  }\r\n\r\n  /**\r\n  * DESC: Convert degrees (0..360) to Powerpoint rot value\r\n  */\r\n  function convertRotationDegrees(d) {\r\n    d = d || 0;\r\n    return (d > 360 ? (d - 360) : d) * 60000;\r\n  }\r\n\r\n  /**\r\n  * DESC: Generate the XML for title elements used for the char and axis titles\r\n  */\r\n  function genXmlTitle(opts) {\r\n    var align = ( opts.titleAlign == 'left' ? 'l' : (opts.titleAlign == 'right' ? 'r' : false) );\r\n    var strXml = '';\r\n    strXml += '<c:title>';\r\n    strXml += ' <c:tx>';\r\n    strXml += '  <c:rich>';\r\n    if ( opts.rotate ) {\r\n      strXml += '  <a:bodyPr rot=\"' + convertRotationDegrees(opts.rotate) + '\"/>';\r\n    }\r\n    else {\r\n      strXml += '  <a:bodyPr/>';  // don't specify rotation to get default (ex. vertical for cat axis)\r\n    }\r\n    strXml += '  <a:lstStyle/>';\r\n    strXml += '  <a:p>';\r\n    strXml += ( align ? '<a:pPr algn=\"'+ align +'\">' : '<a:pPr>' );\r\n    var sizeAttr = '';\r\n    if ( opts.fontSize ) {\r\n      // only set the font size if specified.  Powerpoint will handle the default size\r\n      sizeAttr = 'sz=\"'+ opts.fontSize +'00\"';\r\n    }\r\n    strXml += '      <a:defRPr b=\"0\" i=\"0\" strike=\"noStrike\" '+ sizeAttr +' u=\"none\">';\r\n    strXml += '        <a:solidFill><a:srgbClr val=\"'+ (opts.color || DEF_FONT_COLOR) +'\"/></a:solidFill>';\r\n    strXml += '        <a:latin typeface=\"'+ (opts.fontFace || 'Arial') +'\"/>';\r\n    strXml += '      </a:defRPr>';\r\n    strXml += '    </a:pPr>';\r\n    strXml += '    <a:r>';\r\n    strXml += '      <a:rPr b=\"0\" i=\"0\" strike=\"noStrike\" '+ sizeAttr +' u=\"none\">';\r\n    strXml += '        <a:solidFill><a:srgbClr val=\"'+ (opts.color || DEF_FONT_COLOR) +'\"/></a:solidFill>';\r\n    strXml += '        <a:latin typeface=\"'+ (opts.fontFace || 'Arial') +'\"/>';\r\n    strXml += '      </a:rPr>';\r\n    strXml += '      <a:t>'+ (decodeXmlEntities(opts.title) || '') +'</a:t>';\r\n    strXml += '    </a:r>';\r\n    strXml += '  </a:p>';\r\n    strXml += '  </c:rich>';\r\n    strXml += ' </c:tx>';\r\n    if ( opts.titlePos && opts.titlePos.x && opts.titlePos.y ) {\r\n      strXml += '<c:layout>';\r\n      strXml += '  <c:manualLayout>';\r\n      strXml += '    <c:xMode val=\"edge\"/>';\r\n      strXml += '    <c:yMode val=\"edge\"/>';\r\n      strXml += '    <c:x val=\"'+ opts.titlePos.x +'\"/>';\r\n      strXml += '    <c:y val=\"'+ opts.titlePos.y +'\"/>';\r\n      strXml += '  </c:manualLayout>';\r\n      strXml += '</c:layout>';\r\n    }\r\n    else {\r\n      strXml += ' <c:layout/>';\r\n    }\r\n    strXml += ' <c:overlay val=\"0\"/>';\r\n    strXml += '</c:title>';\r\n    return strXml;\r\n  }\r\n\r\n  /**\r\n  * DESC: Generate the XML for text and its options (bold, bullet, etc) including text runs (word-level formatting)\r\n  * EX:\r\n    <p:txBody>\r\n      <a:bodyPr wrap=\"none\" lIns=\"50800\" tIns=\"50800\" rIns=\"50800\" bIns=\"50800\" anchor=\"ctr\">\r\n      </a:bodyPr>\r\n      <a:lstStyle/>\r\n      <a:p>\r\n        <a:pPr marL=\"228600\" indent=\"-228600\"><a:buSzPct val=\"100000\"/><a:buChar char=\"&#x2022;\"/></a:pPr>\r\n        <a:r>\r\n        <a:t>bullet 1 </a:t>\r\n        </a:r>\r\n        <a:r>\r\n        <a:rPr>\r\n          <a:solidFill><a:srgbClr val=\"7B2CD6\"/></a:solidFill>\r\n        </a:rPr>\r\n        <a:t>colored text</a:t>\r\n        </a:r>\r\n      </a:p>\r\n      </p:txBody>\r\n  * NOTES:\r\n  * - PPT text lines [lines followed by line-breaks] are createing using <p>-aragraph's\r\n  * - Bullets are a paragprah-level formatting device\r\n  *\r\n  * @param slideObj (object) - slideObj -OR- table `cell` object\r\n  * @returns XML string containing the param object's text and formatting\r\n  */\r\n  function genXmlTextBody(slideObj) {\r\n    // FIRST: Shapes without text, etc. may be sent here during build, but have no text to render so return an empty string\r\n    if ( !slideObj.options.isTableCell && (typeof slideObj.text === 'undefined' || slideObj.text == null) ) return '';\r\n\r\n    // Create options if needed\r\n    if ( !slideObj.options ) slideObj.options = {};\r\n\r\n    // Vars\r\n    var arrTextObjects = [];\r\n    var tagStart = ( slideObj.options.isTableCell ? '<a:txBody>'  : '<p:txBody>' );\r\n    var tagClose = ( slideObj.options.isTableCell ? '</a:txBody>' : '</p:txBody>' );\r\n    var strSlideXml = tagStart;\r\n    var strXmlBullet = '', strXmlLnSpc = '';\r\n    var bulletLvl0Margin = 342900;\r\n    var paragraphPropXml = '<a:pPr ';\r\n\r\n    // STEP 1: Modify slideObj to be consistent array of `{ text:'', options:{} }`\r\n    /* CASES:\r\n      addText( 'string' )\r\n      addText( 'line1\\n line2' )\r\n      addText( ['barry','allen'] )\r\n      addText( [{text'word1'}, {text:'word2'}] )\r\n      addText( [{text'line1\\n line2'}, {text:'end word'}] )\r\n    */\r\n    // A: Handle string/number\r\n    if ( typeof slideObj.text === 'string' || typeof slideObj.text === 'number' ) {\r\n      slideObj.text = [ {text:slideObj.text.toString(), options:(slideObj.options || {})} ];\r\n    }\r\n\r\n    // STEP 2: Grab options, format line-breaks, etc.\r\n    if ( Array.isArray(slideObj.text) ) {\r\n      slideObj.text.forEach(function(obj,idx){\r\n        // A: Set options\r\n        obj.options = obj.options || slideObj.options || {};\r\n        if ( idx == 0 && !obj.options.bullet && slideObj.options.bullet ) obj.options.bullet = slideObj.options.bullet;\r\n\r\n        // B: Cast to text-object and fix line-breaks (if needed)\r\n        if ( typeof obj.text === 'string' || typeof obj.text === 'number' ) {\r\n          obj.text = obj.text.toString().replace(/\\r*\\n/g, CRLF);\r\n          // Plain strings like \"hello \\n world\" need to have lineBreaks set to break as intended\r\n          if ( obj.text.indexOf(CRLF) > -1 ) obj.options.breakLine = true;\r\n        }\r\n\r\n        // C: If text string has line-breaks, then create a separate text-object for each (much easier than dealing with split inside a loop below)\r\n        if ( obj.text.split(CRLF).length > 0 ) {\r\n          obj.text.toString().split(CRLF).forEach(function(line){\r\n            // Add line-breaks if not bullets/aligned (we add CRLF for those below in STEP 2)\r\n            line += ( obj.options.breakLine && !obj.options.bullet && !obj.options.align ? CRLF : '' );\r\n            arrTextObjects.push( {text:line, options:obj.options} );\r\n          });\r\n        }\r\n        else {\r\n          // NOTE: The replace used here is for non-textObjects (plain strings) eg:'hello\\nworld'\r\n          arrTextObjects.push( obj );\r\n        }\r\n      });\r\n    }\r\n\r\n    // STEP 3: Add bodyProperties\r\n    {\r\n      // A: 'bodyPr'\r\n      strSlideXml += genXmlBodyProperties(slideObj.options);\r\n\r\n      // B: 'lstStyle'\r\n      // NOTE: Shape type 'LINE' has different text align needs (a lstStyle.lvl1pPr between bodyPr and p)\r\n      // FIXME: LINE horiz-align doesnt work (text is always to the left inside line) (FYI: the PPT code diff is substantial!)\r\n      if ( slideObj.options.h == 0 && slideObj.options.line && slideObj.options.align ) {\r\n        strSlideXml += '<a:lstStyle><a:lvl1pPr algn=\"l\"/></a:lstStyle>';\r\n      }\r\n      else {\r\n        strSlideXml += '<a:lstStyle/>';\r\n      }\r\n    }\r\n\r\n    // STEP 4: Loop over each text object and create paragraph props, text run, etc.\r\n    arrTextObjects.forEach(function(textObj,idx){\r\n      // Clear/Increment loop vars\r\n      paragraphPropXml = '<a:pPr '+ (textObj.options.rtlMode ? ' rtl=\"1\" ' : '');\r\n      strXmlBullet = '';\r\n      textObj.options.lineIdx = idx;\r\n\r\n      // Inherit pPr-type options from parent shape's `options`\r\n      textObj.options.align = textObj.options.align || slideObj.options.align;\r\n      textObj.options.lineSpacing = textObj.options.lineSpacing || slideObj.options.lineSpacing;\r\n      textObj.options.indentLevel = textObj.options.indentLevel || slideObj.options.indentLevel;\r\n\r\n      // A: Build paragraphProperties\r\n      {\r\n        // OPTION: align\r\n        if ( textObj.options.align ) {\r\n          switch ( textObj.options.align ) {\r\n          case 'r':\r\n          case 'right':\r\n            paragraphPropXml += 'algn=\"r\"';\r\n            break;\r\n          case 'c':\r\n          case 'ctr':\r\n          case 'center':\r\n            paragraphPropXml += 'algn=\"ctr\"';\r\n            break;\r\n          case 'justify':\r\n            paragraphPropXml += 'algn=\"just\"';\r\n            break;\r\n          }\r\n        }\r\n\r\n        if ( textObj.options.lineSpacing ) {\r\n          strXmlLnSpc = '<a:lnSpc><a:spcPts val=\"' + textObj.options.lineSpacing + '00\"/></a:lnSpc>';\r\n        }\r\n\r\n        // OPTION: indent\r\n        if ( textObj.options.indentLevel && !isNaN(Number(textObj.options.indentLevel)) && textObj.options.indentLevel > 0 ) {\r\n          paragraphPropXml += ' lvl=\"' + textObj.options.indentLevel + '\"';\r\n        }\r\n\r\n        // OPTION: bullet\r\n        // NOTE: OOXML uses the unicode character set for Bullets\r\n        // EX: Unicode Character 'BULLET' (U+2022) ==> '<a:buChar char=\"&#x2022;\"/>'\r\n        if ( typeof textObj.options.bullet === 'object' ) {\r\n          if ( textObj.options.bullet.type ) {\r\n            if ( textObj.options.bullet.type.toString().toLowerCase() == 'number' ) {\r\n              paragraphPropXml += ' marL=\"'+ (textObj.options.indentLevel && textObj.options.indentLevel > 0 ? bulletLvl0Margin+(bulletLvl0Margin*textObj.options.indentLevel) : bulletLvl0Margin) +'\" indent=\"-'+bulletLvl0Margin+'\"';\r\n              strXmlBullet = '<a:buSzPct val=\"100000\"/><a:buFont typeface=\"+mj-lt\"/><a:buAutoNum type=\"arabicPeriod\"/>';\r\n            }\r\n          }\r\n          else if ( textObj.options.bullet.code ) {\r\n            var bulletCode = '&#x'+ textObj.options.bullet.code +';';\r\n\r\n            // Check value for hex-ness (s/b 4 char hex)\r\n            if ( /^[0-9A-Fa-f]{4}$/.test(textObj.options.bullet.code) == false ) {\r\n              console.warn('Warning: `bullet.code should be a 4-digit hex code (ex: 22AB)`!');\r\n              bulletCode = BULLET_TYPES['DEFAULT'];\r\n            }\r\n\r\n            paragraphPropXml += ' marL=\"'+ (textObj.options.indentLevel && textObj.options.indentLevel > 0 ? bulletLvl0Margin+(bulletLvl0Margin*textObj.options.indentLevel) : bulletLvl0Margin) +'\" indent=\"-'+bulletLvl0Margin+'\"';\r\n            strXmlBullet = '<a:buSzPct val=\"100000\"/><a:buChar char=\"'+ bulletCode +'\"/>';\r\n          }\r\n        }\r\n        // DEPRECATED: old bool value (FIXME:Drop in 2.0)\r\n        else if ( textObj.options.bullet == true ) {\r\n          paragraphPropXml += ' marL=\"'+ (textObj.options.indentLevel && textObj.options.indentLevel > 0 ? bulletLvl0Margin+(bulletLvl0Margin*textObj.options.indentLevel) : bulletLvl0Margin) +'\" indent=\"-'+bulletLvl0Margin+'\"';\r\n          strXmlBullet = '<a:buSzPct val=\"100000\"/><a:buChar char=\"'+ BULLET_TYPES['DEFAULT'] +'\"/>';\r\n        }\r\n\r\n        // Close Paragraph-Properties --------------------\r\n        // IMPORTANT: strXmlLnSpc must precede strXmlBullet for bullet lineSpacing to work (PPT-Online)\r\n        paragraphPropXml += '>'+ strXmlLnSpc + strXmlBullet +'</a:pPr>';\r\n      }\r\n\r\n      // B: Start paragraph if this is the first text obj, or if current textObj is about to be bulleted or aligned\r\n      if ( idx == 0 ) {\r\n        // Add paragraphProperties right after <p> before textrun(s) begin\r\n        strSlideXml += '<a:p>' + paragraphPropXml;\r\n      }\r\n      else if ( idx > 0 && (typeof textObj.options.bullet !== 'undefined' || typeof textObj.options.align !== 'undefined') ) {\r\n        strSlideXml += '</a:p><a:p>' + paragraphPropXml;\r\n      }\r\n\r\n      // C: Inherit any main options (color, font_size, etc.)\r\n      // We only pass the text.options to genXmlTextRun (not the Slide.options),\r\n      // so the run building function cant just fallback to Slide.color, therefore, we need to do that here before passing options below.\r\n      $$.each(slideObj.options, function(key,val){\r\n        // NOTE: This loop will pick up unecessary keys (`x`, etc.), but it doesnt hurt anything\r\n        if ( key != 'bullet' && !textObj.options[key] ) textObj.options[key] = val;\r\n      });\r\n\r\n      // D: Add formatted textrun\r\n      strSlideXml += genXmlTextRun(textObj.options, textObj.text);\r\n    });\r\n\r\n    // STEP 5: Append 'endParaRPr' (when needed) and close current open paragraph\r\n    // NOTE: (ISSUE#20/#193): Add 'endParaRPr' with font/size props or PPT default (Arial/18pt en-us) is used making row \"too tall\"/not horoning opts\r\n    if ( slideObj.options.isTableCell && (slideObj.options.font_size || slideObj.options.font_face) ) {\r\n      strSlideXml += '<a:endParaRPr lang=\"'+ ( slideObj.options.lang ? slideObj.options.lang : 'en-US' ) +'\" '\r\n        + (slideObj.options.font_size ? ' sz=\"'+ Math.round(slideObj.options.font_size) +'00\"' : '') + ' dirty=\"0\">';\r\n      if ( slideObj.options.font_face ) {\r\n        strSlideXml += '  <a:latin typeface=\"'+ slideObj.options.font_face +'\" charset=\"0\" />';\r\n        strSlideXml += '  <a:ea    typeface=\"'+ slideObj.options.font_face +'\" charset=\"0\" />';\r\n        strSlideXml += '  <a:cs    typeface=\"'+ slideObj.options.font_face +'\" charset=\"0\" />';\r\n      }\r\n      strSlideXml += '</a:endParaRPr>';\r\n    }\r\n    strSlideXml += '</a:p>';\r\n\r\n    // STEP 6: Close the textBody\r\n    strSlideXml += tagClose;\r\n\r\n    // LAST: Return XML\r\n    return strSlideXml;\r\n  }\r\n\r\n  /**\r\n  * DESC: Builds <a:r></a:r> text runs for <a:p> paragraphs in textBody\r\n  * EX:\r\n  <a:r>\r\n    <a:rPr lang=\"en-US\" sz=\"2800\" dirty=\"0\" smtClean=\"0\">\r\n    <a:solidFill>\r\n      <a:srgbClr val=\"00FF00\">\r\n      </a:srgbClr>\r\n    </a:solidFill>\r\n    <a:latin typeface=\"Courier New\" pitchFamily=\"34\" charset=\"0\"/>\r\n    <a:cs typeface=\"Courier New\" pitchFamily=\"34\" charset=\"-120\"/>\r\n    </a:rPr>\r\n    <a:t>Misc font/color, size = 28</a:t>\r\n  </a:r>\r\n  */\r\n  function genXmlTextRun(opts, text_string) {\r\n    var xmlTextRun = '';\r\n    var paraProp = '';\r\n    var parsedText;\r\n\r\n    // BEGIN runProperties\r\n    var startInfo = '<a:rPr lang=\"'+ ( opts.lang ? opts.lang : 'en-US' ) +'\" '+ ( opts.lang ? ' altLang=\"en-US\"' : '' );\r\n    startInfo += ( opts.bold      ? ' b=\"1\"' : '' );\r\n    startInfo += ( opts.font_size ? ' sz=\"'+ Math.round(opts.font_size) +'00\"' : '' ); // NOTE: Use round so sizes like '7.5' wont cause corrupt pres.\r\n    startInfo += ( opts.italic    ? ' i=\"1\"' : '' );\r\n    startInfo += ( opts.underline || opts.hyperlink ? ' u=\"sng\"' : '' );\r\n    startInfo += ( opts.subscript ? ' baseline=\"-40000\"' : (opts.superscript ? ' baseline=\"30000\"' : '') );\r\n    // not doc in API yet: startInfo += ( opts.char_spacing ? ' spc=\"' + (text_info.char_spacing * 100) + '\" kern=\"0\"' : '' ); // IMPORTANT: Also disable kerning; otherwise text won't actually expand\r\n    startInfo += ' dirty=\"0\" smtClean=\"0\">';\r\n    // Color and Font are children of <a:rPr>, so add them now before closing the runProperties tag\r\n    if ( opts.color || opts.font_face ) {\r\n      if ( opts.color ) startInfo += genXmlColorSelection( opts.color );\r\n      if ( opts.font_face ) {\r\n        // NOTE: 'cs' = Complex Script, 'ea' = East Asian (use -120 instead of 0 - see Issue #174)\r\n        startInfo += '<a:latin typeface=\"' + opts.font_face + '\" pitchFamily=\"34\" charset=\"0\"/>'\r\n              + '<a:cs typeface=\"' + opts.font_face + '\" pitchFamily=\"34\" charset=\"-120\"/>'\r\n              + '<a:ea typeface=\"' + opts.font_face + '\" pitchFamily=\"34\" charset=\"-120\"/>';\r\n      }\r\n    }\r\n\r\n    // Hyperlink support\r\n    if ( opts.hyperlink ) {\r\n      if ( typeof opts.hyperlink !== 'object' ) console.log('ERROR: text `hyperlink` option should be an object. Ex: `hyperlink:{url:\\'https://github.com\\'}` ');\r\n      else if ( !opts.hyperlink.url || typeof opts.hyperlink.url !== 'string' ) console.log('ERROR: \\'hyperlink.url is required and/or should be a string\\'');\r\n      else if ( opts.hyperlink.url ) {\r\n        // FIXME-20170410: FUTURE-FEATURE: color (link is always blue in Keynote and PPT online, so usual text run above isnt honored for links..?)\r\n        //startInfo += '<a:uFill>'+ genXmlColorSelection('0000FF') +'</a:uFill>'; // Breaks PPT2010! (Issue#74)\r\n        startInfo += '<a:hlinkClick r:id=\"rId'+ opts.hyperlink.rId +'\" invalidUrl=\"\" action=\"\" tgtFrame=\"\" tooltip=\"'+ (opts.hyperlink.tooltip ? decodeXmlEntities(opts.hyperlink.tooltip) : '') +'\" history=\"1\" highlightClick=\"0\" endSnd=\"0\"/>';\r\n      }\r\n    }\r\n\r\n    // END runProperties\r\n    startInfo += '</a:rPr>';\r\n\r\n    // LINE-BREAKS/MULTI-LINE: Split text into multi-p:\r\n    parsedText = text_string.split(CRLF);\r\n    if ( parsedText.length > 1 ) {\r\n      var outTextData = '';\r\n      for ( var i = 0, total_size_i = parsedText.length; i < total_size_i; i++ ) {\r\n        outTextData += '<a:r>' + startInfo+ '<a:t>' + decodeXmlEntities(parsedText[i]);\r\n        // Stop/Start <p>aragraph as long as there is more lines ahead (otherwise its closed at the end of this function)\r\n        if ( (i + 1) < total_size_i ) outTextData += (opts.breakLine ? CRLF : '') + '</a:t></a:r>';\r\n      }\r\n      xmlTextRun = outTextData;\r\n    }\r\n    else {\r\n      // Handle cases where addText `text` was an array of objects - if a text object doesnt contain a '\\n' it still need alignment!\r\n      // The first pPr-align is done in makeXml - use line countr to ensure we only add subsequently as needed\r\n      xmlTextRun = ( (opts.align && opts.lineIdx > 0) ? paraProp : '') + '<a:r>' + startInfo+ '<a:t>' + decodeXmlEntities(text_string);\r\n    }\r\n\r\n    // Return paragraph with text run\r\n    return xmlTextRun + '</a:t></a:r>';\r\n  }\r\n\r\n  /**\r\n  * DESC: Builds <a:bodyPr></a:bodyPr> tag\r\n  */\r\n  function genXmlBodyProperties(objOptions) {\r\n    var bodyProperties = '<a:bodyPr';\r\n\r\n    if ( objOptions && objOptions.bodyProp ) {\r\n      // A: Enable or disable textwrapping none or square:\r\n      ( objOptions.bodyProp.wrap ) ? bodyProperties += ' wrap=\"' + objOptions.bodyProp.wrap + '\" rtlCol=\"0\"' : bodyProperties += ' wrap=\"square\" rtlCol=\"0\"';\r\n\r\n      // B: Set anchorPoints ('t','ctr',b'):\r\n      if ( objOptions.bodyProp.anchor ) bodyProperties += ' anchor=\"' + objOptions.bodyProp.anchor + '\"';\r\n      //if ( objOptions.bodyProp.anchorCtr ) bodyProperties += ' anchorCtr=\"' + objOptions.bodyProp.anchorCtr + '\"';\r\n\r\n      // C: Textbox margins [padding]:\r\n      if ( objOptions.bodyProp.bIns || objOptions.bodyProp.bIns == 0 ) bodyProperties += ' bIns=\"' + objOptions.bodyProp.bIns + '\"';\r\n      if ( objOptions.bodyProp.lIns || objOptions.bodyProp.lIns == 0 ) bodyProperties += ' lIns=\"' + objOptions.bodyProp.lIns + '\"';\r\n      if ( objOptions.bodyProp.rIns || objOptions.bodyProp.rIns == 0 ) bodyProperties += ' rIns=\"' + objOptions.bodyProp.rIns + '\"';\r\n      if ( objOptions.bodyProp.tIns || objOptions.bodyProp.tIns == 0 ) bodyProperties += ' tIns=\"' + objOptions.bodyProp.tIns + '\"';\r\n\r\n      // D: Close <a:bodyPr element\r\n      bodyProperties += '>';\r\n\r\n      // E: NEW: Add autofit type tags\r\n      if ( objOptions.shrinkText ) bodyProperties += '<a:normAutofit fontScale=\"85000\" lnSpcReduction=\"20000\" />'; // MS-PPT > Format Shape > Text Options: \"Shrink text on overflow\"\r\n      // MS-PPT > Format Shape > Text Options: \"Resize shape to fit text\" [spAutoFit]\r\n      // NOTE: Use of '<a:noAutofit/>' in lieu of '' below causes issues in PPT-2013\r\n      bodyProperties += ( objOptions.bodyProp.autoFit !== false ? '<a:spAutoFit/>' : '' );\r\n\r\n      // LAST: Close bodyProp\r\n      bodyProperties += '</a:bodyPr>';\r\n    }\r\n    else {\r\n      // DEFAULT:\r\n      bodyProperties += ' wrap=\"square\" rtlCol=\"0\">';\r\n      bodyProperties += '</a:bodyPr>';\r\n    }\r\n\r\n    // LAST: Return Close bodyProp\r\n    return ( objOptions.isTableCell ? '<a:bodyPr/>' : bodyProperties );\r\n  }\r\n\r\n  function genXmlColorSelection(color_info, back_info) {\r\n    var colorVal;\r\n    var fillType = 'solid';\r\n    var internalElements = '';\r\n    var outText = '';\r\n\r\n    if ( back_info && typeof back_info === 'string' ) {\r\n      outText += '<p:bg><p:bgPr>';\r\n      outText += genXmlColorSelection( back_info.replace('#',''), false );\r\n      outText += '<a:effectLst/>';\r\n      outText += '</p:bgPr></p:bg>';\r\n    }\r\n\r\n    if ( color_info ) {\r\n      if ( typeof color_info == 'string' ) colorVal = color_info;\r\n      else {\r\n        if ( color_info.type  ) fillType = color_info.type;\r\n        if ( color_info.color ) colorVal = color_info.color;\r\n        if ( color_info.alpha ) internalElements += '<a:alpha val=\"' + (100 - color_info.alpha) + '000\"/>';\r\n      }\r\n\r\n      switch ( fillType ) {\r\n      case 'solid':\r\n        outText += '<a:solidFill>'+ createColorElement(colorVal, internalElements) + '</a:solidFill>';\r\n        break;\r\n      }\r\n    }\r\n\r\n    return outText;\r\n  }\r\n\r\n  // XML-GEN: First 6 functions create the base /ppt files\r\n\r\n  function makeXmlContTypes() {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF;\r\n    strXml += '<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">';\r\n    strXml += ' <Default Extension=\"xml\" ContentType=\"application/xml\"/>';\r\n    strXml += ' <Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\"/>';\r\n    strXml += ' <Default Extension=\"jpeg\" ContentType=\"image/jpeg\"/>';\r\n    strXml += ' <Default Extension=\"png\" ContentType=\"image/png\"/>';\r\n    strXml += ' <Default Extension=\"gif\" ContentType=\"image/gif\"/>';\r\n    strXml += ' <Default Extension=\"m4v\" ContentType=\"video/mp4\"/>'; // hard-coded as extn!=type\r\n    strXml += ' <Default Extension=\"mp4\" ContentType=\"video/mp4\"/>'; // same here, we have to add as it wont be added in loop below\r\n    gObjPptx.slides.forEach(function(slide){\r\n      slide.rels.forEach(function(rel){\r\n        if ( rel.type != 'image' && rel.type != 'online' && rel.type != 'chart' && rel.extn != 'm4v' && strXml.indexOf(rel.type) == -1 )\r\n          strXml += ' <Default Extension=\"'+ rel.extn +'\" ContentType=\"'+ rel.type +'\"/>';\r\n      });\r\n    });\r\n    strXml += ' <Default Extension=\"vml\" ContentType=\"application/vnd.openxmlformats-officedocument.vmlDrawing\"/>';\r\n    strXml += ' <Default Extension=\"xlsx\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"/>';\r\n\r\n    strXml += ' <Override PartName=\"/docProps/core.xml\" ContentType=\"application/vnd.openxmlformats-package.core-properties+xml\"/>';\r\n    strXml += ' <Override PartName=\"/docProps/app.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.extended-properties+xml\"/>';\r\n    strXml += ' <Override PartName=\"/ppt/presentation.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml\"/>';\r\n    strXml += ' <Override PartName=\"/ppt/presProps.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.presProps+xml\"/>';\r\n    strXml += ' <Override PartName=\"/ppt/tableStyles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml\"/>';\r\n    strXml += ' <Override PartName=\"/ppt/theme/theme1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.theme+xml\"/>';\r\n    strXml += ' <Override PartName=\"/ppt/viewProps.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.viewProps+xml\"/>';\r\n\r\n    gObjPptx.slides.forEach(function(slide, idx){\r\n      strXml += '<Override PartName=\"/ppt/slideMasters/slideMaster'+ (idx+1) +'.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml\"/>';\r\n      strXml += '<Override PartName=\"/ppt/slides/slide'            + (idx+1) +'.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.slide+xml\"/>';\r\n      // add charts if any\r\n      slide.rels.forEach(function(rel){\r\n        if ( rel.type == 'chart' ) {\r\n          strXml += ' <Override PartName=\"'+ rel.Target +'\" ContentType=\"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\"/>';\r\n        }\r\n      });\r\n    });\r\n\r\n    gObjPptx.slideLayouts.forEach(function(layout,idx) {\r\n      strXml += '<Override PartName=\"/ppt/slideLayouts/slideLayout'+ ( idx + 1 ) +'.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml\"/>';\r\n      layout.rels.forEach(function(rel){\r\n        if ( rel.type == 'chart' ) {\r\n          strXml += ' <Override PartName=\"'+ rel.Target +'\" ContentType=\"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\"/>';\r\n        }\r\n      });\r\n    });\r\n    gObjPptx.masterSlide.rels.forEach(function(rel) {\r\n      if ( rel.type == 'chart' ) {\r\n        strXml += ' <Override PartName=\"'+ rel.Target +'\" ContentType=\"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\"/>';\r\n      }\r\n      if ( rel.type != 'image' && rel.type != 'online' && rel.type != 'chart' && rel.extn != 'm4v' && strXml.indexOf(rel.type) == -1 )\r\n        strXml += ' <Default Extension=\"'+ rel.extn +'\" ContentType=\"'+ rel.type +'\"/>';\r\n    });\r\n\r\n    strXml += '</Types>';\r\n\r\n    return strXml;\r\n  }\r\n\r\n  function makeXmlRootRels() {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF\r\n          + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'\r\n          + '  <Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\" Target=\"docProps/app.xml\"/>'\r\n          + '  <Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\" Target=\"docProps/core.xml\"/>'\r\n          + '  <Relationship Id=\"rId3\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"ppt/presentation.xml\"/>'\r\n          + '</Relationships>';\r\n    return strXml;\r\n  }\r\n\r\n  function makeXmlApp() {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF;\r\n    strXml += '<Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\" xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\">';\r\n    strXml += '<TotalTime>0</TotalTime>';\r\n    strXml += '<Words>0</Words>';\r\n    strXml += '<Application>Microsoft Office PowerPoint</Application>';\r\n    strXml += '<PresentationFormat>On-screen Show</PresentationFormat>';\r\n    strXml += '<Paragraphs>0</Paragraphs>';\r\n    strXml += '<Slides>'+ gObjPptx.slides.length +'</Slides>';\r\n    strXml += '<Notes>0</Notes>';\r\n    strXml += '<HiddenSlides>0</HiddenSlides>';\r\n    strXml += '<MMClips>0</MMClips>';\r\n    strXml += '<ScaleCrop>false</ScaleCrop>';\r\n    strXml += '<HeadingPairs>';\r\n    strXml += '  <vt:vector size=\"4\" baseType=\"variant\">';\r\n    strXml += '    <vt:variant><vt:lpstr>Theme</vt:lpstr></vt:variant>';\r\n    strXml += '    <vt:variant><vt:i4>1</vt:i4></vt:variant>';\r\n    strXml += '    <vt:variant><vt:lpstr>Slide Titles</vt:lpstr></vt:variant>';\r\n    strXml += '    <vt:variant><vt:i4>'+ gObjPptx.slides.length +'</vt:i4></vt:variant>';\r\n    strXml += '  </vt:vector>';\r\n    strXml += '</HeadingPairs>';\r\n    strXml += '<TitlesOfParts>';\r\n    strXml += '<vt:vector size=\"'+ (gObjPptx.slides.length+1) +'\" baseType=\"lpstr\">';\r\n    strXml += '<vt:lpstr>Office Theme</vt:lpstr>';\r\n    $$.each(gObjPptx.slides, function(idx){ strXml += '<vt:lpstr>Slide '+ (idx+1) +'</vt:lpstr>'; });\r\n    strXml += '</vt:vector>';\r\n    strXml += '</TitlesOfParts>';\r\n    strXml += '<Company>'+gObjPptx.company+'</Company>';\r\n    strXml += '<LinksUpToDate>false</LinksUpToDate>';\r\n    strXml += '<SharedDoc>false</SharedDoc>';\r\n    strXml += '<HyperlinksChanged>false</HyperlinksChanged>';\r\n    strXml += '<AppVersion>15.0000</AppVersion>';\r\n    strXml += '</Properties>';\r\n\r\n    return strXml;\r\n  }\r\n\r\n  function makeXmlCore() {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF;\r\n    strXml += '<cp:coreProperties xmlns:cp=\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:dcterms=\"http://purl.org/dc/terms/\" xmlns:dcmitype=\"http://purl.org/dc/dcmitype/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">';\r\n    strXml += '<dc:title>'+ decodeXmlEntities(gObjPptx.title) +'</dc:title>';\r\n    strXml += '<dc:subject>'+ decodeXmlEntities(gObjPptx.subject) +'</dc:subject>';\r\n    strXml += '<dc:creator>'+ decodeXmlEntities(gObjPptx.author) +'</dc:creator>';\r\n    strXml += '<cp:lastModifiedBy>'+ decodeXmlEntities(gObjPptx.author) +'</cp:lastModifiedBy>';\r\n    strXml += '<cp:revision>'+ gObjPptx.revision +'</cp:revision>';\r\n    strXml += '<dcterms:created xsi:type=\"dcterms:W3CDTF\">'+ new Date().toISOString() +'</dcterms:created>';\r\n    strXml += '<dcterms:modified xsi:type=\"dcterms:W3CDTF\">'+ new Date().toISOString() +'</dcterms:modified>';\r\n    strXml += '</cp:coreProperties>';\r\n    return strXml;\r\n  }\r\n\r\n  function makeXmlPresentationRels() {\r\n    var intRelNum = 0;\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF;\r\n    strXml += '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">';\r\n    strXml += '  <Relationship Id=\"rId1\" Target=\"slideMasters/slideMaster1.xml\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster\"/>';\r\n    intRelNum++;\r\n    for ( var idx=1; idx<=gObjPptx.slides.length; idx++ ) {\r\n      intRelNum++;\r\n      strXml += '  <Relationship Id=\"rId'+ intRelNum +'\" Target=\"slides/slide'+ idx +'.xml\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide\"/>';\r\n    }\r\n    intRelNum++;\r\n    strXml += '  <Relationship Id=\"rId'+  intRelNum    +'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/presProps\" Target=\"presProps.xml\"/>'\r\n        + '  <Relationship Id=\"rId'+ (intRelNum+1) +'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/viewProps\" Target=\"viewProps.xml\"/>'\r\n        + '  <Relationship Id=\"rId'+ (intRelNum+2) +'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\" Target=\"theme/theme1.xml\"/>'\r\n        + '  <Relationship Id=\"rId'+ (intRelNum+3) +'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles\" Target=\"tableStyles.xml\"/>'\r\n        + '</Relationships>';\r\n\r\n    return strXml;\r\n  }\r\n\r\n  // XML-GEN: Next 5 functions run 1-N times (once for each Slide)\r\n\r\n  /**\r\n   * Generates the XML slide resource from a Slide object\r\n   * @param {Object} inSlide - The slide object to transform into XML\r\n   * @return {string} strSlideXml - Slide OOXML\r\n  */\r\n  function makeXmlSlide(inSlide) {\r\n    // STEP 1: Generate slide XML - wrap generated text in full XML envelope\r\n    var strSlideXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF;\r\n    strSlideXml += '<p:sld xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\">';\r\n    strSlideXml += gObjPptxGenerators.slideObjectToXml(inSlide);\r\n    strSlideXml += '<p:clrMapOvr><a:masterClrMapping/></p:clrMapOvr>';\r\n    strSlideXml += '</p:sld>';\r\n\r\n    // LAST: Return\r\n    return strSlideXml;\r\n  }\r\n\r\n  /**\r\n   * Generates the XML layout resource from a layout object\r\n   * @param {Object} slideLayoutObject slide object that represents layout\r\n   * @return {String} complete XML string ready to be saved as a file\r\n  */\r\n  function makeXmlLayout(slideLayoutObject) {\r\n    var strXml =  '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + CRLF;\r\n    strXml += '<p:sldLayout xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\" preserve=\"1\" userDrawn=\"1\">';\r\n    strXml += gObjPptxGenerators.slideObjectToXml(slideLayoutObject);\r\n    strXml += '<p:clrMapOvr><a:masterClrMapping/></p:clrMapOvr>';\r\n    strXml += '</p:sldLayout>';\r\n    return strXml;\r\n  }\r\n\r\n  /**\r\n   * Generates XML for the master file..\r\n   * @param {Object} slideObject slide object that represents master slide layout\r\n   * @return {String} complete XML string ready to be saved as a file\r\n  */\r\n  function makeXmlMaster(slideObject) {\r\n    var strSlideXml = gObjPptxGenerators.slideObjectToXml(slideObject);\r\n\r\n    // NOTE: Pass layouts as static rels because they are not referrenced any time\r\n    var layoutDefs = gObjPptx.slideLayouts.map(function(layoutDef,idx){\r\n      return '<p:sldLayoutId id=\"' + (LAYOUT_IDX_SERIES_BASE + idx) + '\" r:id=\"rId' + (slideObject.rels.length + idx + 1) + '\" />';\r\n    });\r\n\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + CRLF;\r\n    strXml += '<p:sldMaster xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\">';\r\n    strXml += strSlideXml;\r\n    strXml += '<p:clrMap bg1=\"lt1\" tx1=\"dk1\" bg2=\"lt2\" tx2=\"dk2\" accent1=\"accent1\" accent2=\"accent2\" accent3=\"accent3\" accent4=\"accent4\" accent5=\"accent5\" accent6=\"accent6\" hlink=\"hlink\" folHlink=\"folHlink\" />';\r\n    strXml += '<p:sldLayoutIdLst>' + layoutDefs.join('') + '</p:sldLayoutIdLst>';\r\n    strXml += '<p:hf sldNum=\"0\" hdr=\"0\" ftr=\"0\" dt=\"0\" />';\r\n    strXml += '<p:txStyles>'\r\n      + ' <p:titleStyle>'\r\n      + '  <a:lvl1pPr algn=\"ctr\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"0\"/></a:spcBef><a:buNone/><a:defRPr sz=\"4400\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mj-lt\"/><a:ea typeface=\"+mj-ea\"/><a:cs typeface=\"+mj-cs\"/></a:defRPr></a:lvl1pPr>'\r\n      + ' </p:titleStyle>'\r\n      + ' <p:bodyStyle>'\r\n      + '  <a:lvl1pPr marL=\"342900\" indent=\"-342900\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"3200\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl1pPr>'\r\n      + '  <a:lvl2pPr marL=\"742950\" indent=\"-285750\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl2pPr>'\r\n      + '  <a:lvl3pPr marL=\"1143000\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2400\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl3pPr>'\r\n      + '  <a:lvl4pPr marL=\"1600200\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl4pPr>'\r\n      + '  <a:lvl5pPr marL=\"2057400\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl5pPr>'\r\n      + '  <a:lvl6pPr marL=\"2514600\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl6pPr>'\r\n      + '  <a:lvl7pPr marL=\"2971800\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl7pPr>'\r\n      + '  <a:lvl8pPr marL=\"3429000\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl8pPr>'\r\n      + '  <a:lvl9pPr marL=\"3886200\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"?\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl9pPr>'\r\n      + ' </p:bodyStyle>'\r\n      + ' <p:otherStyle>'\r\n      + '  <a:defPPr><a:defRPr lang=\"en-US\"/></a:defPPr>'\r\n      + '  <a:lvl1pPr marL=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl1pPr>'\r\n      + '  <a:lvl2pPr marL=\"457200\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl2pPr>'\r\n      + '  <a:lvl3pPr marL=\"914400\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl3pPr>'\r\n      + '  <a:lvl4pPr marL=\"1371600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl4pPr>'\r\n      + '  <a:lvl5pPr marL=\"1828800\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl5pPr>'\r\n      + '  <a:lvl6pPr marL=\"2286000\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl6pPr>'\r\n      + '  <a:lvl7pPr marL=\"2743200\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl7pPr>'\r\n      + '  <a:lvl8pPr marL=\"3200400\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl8pPr>'\r\n      + '  <a:lvl9pPr marL=\"3657600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl9pPr>'\r\n      + ' </p:otherStyle>'\r\n      + '</p:txStyles>';\r\n    strXml += '</p:sldMaster>';\r\n    return strXml;\r\n  }\r\n\r\n  /**\r\n   * Generates XML string for a slide layout relation file.\r\n   * @param {Number} layoutNumber 1-indexed number of a layout that relations are generated for\r\n   * @return {String} complete XML string ready to be saved as a file\r\n   */\r\n  function makeXmlSlideLayoutRel(layoutNumber) {\r\n    return gObjPptxGenerators.slideObjectRelationsToXml(\r\n      gObjPptx.slideLayouts[layoutNumber - 1],\r\n      [{\r\n        target:'../slideMasters/slideMaster1.xml', type:'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster'\r\n      }]\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Generates XML string for a slide relation file.\r\n   * @param {Number} slideNumber 1-indexed number of a layout that relations are generated for\r\n   * @return {String} complete XML string ready to be saved as a file\r\n   */\r\n  function makeXmlSlideRel(slideNumber) {\r\n    return gObjPptxGenerators.slideObjectRelationsToXml(\r\n      gObjPptx.slides[slideNumber - 1],\r\n      [{\r\n        target: '../slideLayouts/slideLayout'+ getLayoutIdxForSlide(slideNumber) +'.xml',\r\n        type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout'\r\n      }]\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Generates XML string for the master file.\r\n   * @param {Object} masterSlideObject slide object\r\n   * @return {String} complete XML string ready to be saved as a file\r\n   */\r\n  function makeXmlMasterRel(masterSlideObject) {\r\n    var defaultRels = gObjPptx.slideLayouts.map(function(layoutDef, idx) {\r\n      return { target: '../slideLayouts/slideLayout'+ (idx + 1) +'.xml', type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout' };\r\n    });\r\n    defaultRels.push({ target: '../theme/theme1.xml', type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme' });\r\n\r\n    return gObjPptxGenerators.slideObjectRelationsToXml(\r\n      masterSlideObject,\r\n      defaultRels\r\n    );\r\n  }\r\n\r\n  /**\r\n   * For the passed slide number, resolves name of a layout that is used for.\r\n   * @param {Number} slideNumber\r\n   * @return {Number} slide number\r\n   */\r\n  function getLayoutIdxForSlide(slideNumber) {\r\n    var layoutName = gObjPptx.slides[slideNumber - 1].layout;\r\n\r\n    for (var i=0; i<gObjPptx.slideLayouts.length; i++) {\r\n      if (gObjPptx.slideLayouts[i].name === layoutName) {\r\n        return (i + 1);\r\n      }\r\n    }\r\n\r\n    // IMPORTANT: Return 1 (for `slideLayout1.xml`) as lack of a def means legacy (deprecated) master was used\r\n    // meaning all of its objects are in Layout1 and every slide that references it uses this layout.\r\n    return 1;\r\n  }\r\n\r\n  // XML-GEN: Last 5 functions create root /ppt files\r\n\r\n  function makeXmlTheme() {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF;\r\n    strXml += '<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" name=\"Office Theme\">\\\r\n            <a:themeElements>\\\r\n              <a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1>\\\r\n              <a:dk2><a:srgbClr val=\"A7A7A7\"/></a:dk2>\\\r\n              <a:lt2><a:srgbClr val=\"535353\"/></a:lt2><a:accent1><a:srgbClr val=\"4F81BD\"/></a:accent1><a:accent2><a:srgbClr val=\"C0504D\"/></a:accent2><a:accent3>\\\r\n              <a:srgbClr val=\"9BBB59\"/></a:accent3><a:accent4><a:srgbClr val=\"8064A2\"/></a:accent4><a:accent5><a:srgbClr val=\"4BACC6\"/></a:accent5>\\\r\n              <a:accent6><a:srgbClr val=\"F79646\"/></a:accent6><a:hlink><a:srgbClr val=\"0000FF\"/></a:hlink><a:folHlink><a:srgbClr val=\"800080\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Arial\"/><a:ea typeface=\"Arial\"/><a:cs typeface=\"Arial\"/><a:font script=\"Jpan\" typeface=\"MS P????\"/><a:font script=\"Hang\" typeface=\"?? ??\"/><a:font script=\"Hans\" typeface=\"??\"/><a:font script=\"Hant\" typeface=\"????\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Angsana New\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/></a:majorFont><a:minorFont><a:latin typeface=\"Arial\"/><a:ea typeface=\"Arial\"/><a:cs typeface=\"Arial\"/><a:font script=\"Jpan\" typeface=\"MS P????\"/><a:font script=\"Hang\" typeface=\"?? ??\"/><a:font script=\"Hans\" typeface=\"??\"/><a:font script=\"Hant\" typeface=\"????\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Cordia New\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/>\\\r\n              </a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"50000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"35000\"><a:schemeClr val=\"phClr\"><a:tint val=\"37000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:tint val=\"15000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"1\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:shade val=\"51000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"80000\"><a:schemeClr val=\"phClr\"><a:shade val=\"93000\"/><a:satMod val=\"130000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"94000\"/><a:satMod val=\"135000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"16200000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"><a:shade val=\"95000\"/><a:satMod val=\"105000\"/></a:schemeClr></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"25400\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln><a:ln w=\"38100\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"20000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"38000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"40000\" dist=\"23000\" dir=\"5400000\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"35000\"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst=\"orthographicFront\"><a:rot lat=\"0\" lon=\"0\" rev=\"0\"/></a:camera><a:lightRig rig=\"threePt\" dir=\"t\"><a:rot lat=\"0\" lon=\"0\" rev=\"1200000\"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w=\"63500\" h=\"25400\"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"40000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"40000\"><a:schemeClr val=\"phClr\"><a:tint val=\"45000\"/><a:shade val=\"99000\"/><a:satMod val=\"350000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"20000\"/><a:satMod val=\"255000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"-80000\" r=\"50000\" b=\"180000\"/></a:path></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"80000\"/><a:satMod val=\"300000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"30000\"/><a:satMod val=\"200000\"/></a:schemeClr></a:gs></a:gsLst><a:path path=\"circle\"><a:fillToRect l=\"50000\" t=\"50000\" r=\"50000\" b=\"50000\"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/>\\\r\n            </a:theme>';\r\n    return strXml;\r\n  }\r\n\r\n  function makeXmlPresentation() {\r\n    var intCurPos = 0;\r\n    // REF: http://www.datypic.com/sc/ooxml/t-p_CT_Presentation.html\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF\r\n      + '<p:presentation xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" '\r\n      + 'xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" '\r\n      + 'xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\" '+ (gObjPptx.rtlMode ? 'rtl=\"1\"' : '') +' saveSubsetFonts=\"1\">';\r\n\r\n    // STEP 1: Build SLIDE master list\r\n    strXml += '<p:sldMasterIdLst><p:sldMasterId id=\"2147483648\" r:id=\"rId1\"/></p:sldMasterIdLst>';\r\n    strXml += '<p:sldIdLst>';\r\n    for ( var idx=0; idx<gObjPptx.slides.length; idx++ ) {\r\n      strXml += '<p:sldId id=\"' + (idx + 256) + '\" r:id=\"rId' + (idx + 2) + '\"/>';\r\n    }\r\n    strXml += '</p:sldIdLst>';\r\n\r\n    // STEP 2: Build SLIDE text styles\r\n    strXml += '<p:sldSz cx=\"'+ gObjPptx.pptLayout.width +'\" cy=\"'+ gObjPptx.pptLayout.height +'\" type=\"'+ gObjPptx.pptLayout.name +'\"/>'\r\n        + '<p:notesSz cx=\"'+ gObjPptx.pptLayout.height +'\" cy=\"' + gObjPptx.pptLayout.width + '\"/>'\r\n        + '<p:defaultTextStyle>';\r\n    + '  <a:defPPr><a:defRPr lang=\"en-US\"/></a:defPPr>';\r\n    for ( idx=1; idx<10; idx++ ) {\r\n      strXml += '  <a:lvl' + idx + 'pPr marL=\"' + intCurPos + '\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\">'\r\n          + '    <a:defRPr sz=\"1800\" kern=\"1200\">'\r\n          + '      <a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill>'\r\n          + '      <a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/>'\r\n          + '    </a:defRPr>'\r\n          + '  </a:lvl' + idx + 'pPr>';\r\n      intCurPos += 457200;\r\n    }\r\n    strXml += '</p:defaultTextStyle>';\r\n\r\n    strXml += '<p:extLst><p:ext uri=\"{EFAFB233-063F-42B5-8137-9DF3F51BA10A}\"><p15:sldGuideLst xmlns:p15=\"http://schemas.microsoft.com/office/powerpoint/2012/main\"/></p:ext></p:extLst>'\r\n        + '</p:presentation>';\r\n\r\n    return strXml;\r\n  }\r\n\r\n  function makeXmlPresProps() {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF\r\n          + '<p:presentationPr xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\">'\r\n          + '  <p:extLst>'\r\n          + '    <p:ext uri=\"{E76CE94A-603C-4142-B9EB-6D1370010A27}\"><p14:discardImageEditData xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"0\"/></p:ext>'\r\n          + '    <p:ext uri=\"{D31A062A-798A-4329-ABDD-BBA856620510}\"><p14:defaultImageDpi xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"220\"/></p:ext>'\r\n          + '    <p:ext uri=\"{FD5EFAAD-0ECE-453E-9831-46B23BE46B34}\"><p15:chartTrackingRefBased xmlns:p15=\"http://schemas.microsoft.com/office/powerpoint/2012/main\" val=\"1\"/></p:ext>'\r\n          + '  </p:extLst>'\r\n          + '</p:presentationPr>';\r\n    return strXml;\r\n  }\r\n\r\n  function makeXmlTableStyles() {\r\n    // SEE: http://openxmldeveloper.org/discussions/formats/f/13/p/2398/8107.aspx\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF\r\n          + '<a:tblStyleLst xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" def=\"{5C22544A-7EE6-4342-B048-85BDC9FD1C3A}\"/>';\r\n    return strXml;\r\n  }\r\n\r\n  function makeXmlViewProps() {\r\n    var strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+CRLF\r\n          + '<p:viewPr xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\">'\r\n          + '<p:normalViewPr><p:restoredLeft sz=\"15620\"/><p:restoredTop sz=\"94660\"/></p:normalViewPr>'\r\n          + '<p:slideViewPr>'\r\n          + '  <p:cSldViewPr>'\r\n          + '    <p:cViewPr varScale=\"1\"><p:scale><a:sx n=\"64\" d=\"100\"/><a:sy n=\"64\" d=\"100\"/></p:scale><p:origin x=\"-1392\" y=\"-96\"/></p:cViewPr>'\r\n          + '    <p:guideLst><p:guide orient=\"horz\" pos=\"2160\"/><p:guide pos=\"2880\"/></p:guideLst>'\r\n          + '  </p:cSldViewPr>'\r\n          + '</p:slideViewPr>'\r\n          + '<p:notesTextViewPr>'\r\n          + '  <p:cViewPr><p:scale><a:sx n=\"100\" d=\"100\"/><a:sy n=\"100\" d=\"100\"/></p:scale><p:origin x=\"0\" y=\"0\"/></p:cViewPr>'\r\n          + '</p:notesTextViewPr>'\r\n          + '<p:gridSpacing cx=\"78028800\" cy=\"78028800\"/>'\r\n          + '</p:viewPr>';\r\n    return strXml;\r\n  }\r\n\r\n  /* ===============================================================================================\r\n  |\r\n  ######                                             #     ######   ###\r\n  #     #  #    #  #####   #       #   ####         # #    #     #   #\r\n  #     #  #    #  #    #  #       #  #    #       #   #   #     #   #\r\n  ######   #    #  #####   #       #  #           #     #  ######    #\r\n  #        #    #  #    #  #       #  #           #######  #         #\r\n  #        #    #  #    #  #       #  #    #      #     #  #         #\r\n  #         ####   #####   ######  #   ####       #     #  #        ###\r\n  |\r\n  ==================================================================================================\r\n  */\r\n\r\n  /**\r\n   * Expose a couple private helper functions from above\r\n   */\r\n  this.inch2Emu = inch2Emu;\r\n  this.rgbToHex = rgbToHex;\r\n\r\n  /**\r\n   * Gets the version of this library\r\n   */\r\n  this.getVersion = function getVersion() {\r\n    return APP_VER +'.'+ APP_REL;\r\n  };\r\n\r\n  /**\r\n   * Gets the Presentation's Slide Layout {object} from `LAYOUTS`\r\n   */\r\n  this.getLayout = function getLayout() {\r\n    return gObjPptx.pptLayout;\r\n  };\r\n\r\n  /**\r\n   * Set Right-to-Left (RTL) mode for users whose language requires this setting\r\n   */\r\n  this.setRTL = function setRTL(inBool) {\r\n    if ( typeof inBool !== 'boolean' ) return;\r\n    else {\r\n      gObjPptx.rtlMode = inBool;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Sets the Presentation's Slide Layout {object}: [screen4x3, screen16x9, widescreen]\r\n   * @see https://support.office.com/en-us/article/Change-the-size-of-your-slides-040a811c-be43-40b9-8d04-0de5ed79987e\r\n   * @param {string} inLayout - a const name from LAYOUTS variable\r\n   * @param {object} inLayout - an object with user-defined w/h\r\n   */\r\n  this.setLayout = function setLayout(inLayout) {\r\n    // Allow custom slide size (inches) [ISSUE #29]\r\n    if ( typeof inLayout === 'object' && inLayout.width && inLayout.height ) {\r\n      LAYOUTS['LAYOUT_USER'].width  = Math.round(Number(inLayout.width ) * EMU);\r\n      LAYOUTS['LAYOUT_USER'].height = Math.round(Number(inLayout.height) * EMU);\r\n\r\n      gObjPptx.pptLayout = LAYOUTS['LAYOUT_USER'];\r\n    }\r\n    else if ( $$.inArray(inLayout, Object.keys(LAYOUTS)) > -1 ) {\r\n      gObjPptx.pptLayout = LAYOUTS[inLayout];\r\n    }\r\n    else {\r\n      console.warn('UNKNOWN LAYOUT! Valid values = ' + Object.keys(LAYOUTS));\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Sets the Presentation's Title\r\n   */\r\n  this.setTitle = function setTitle(inStrTitle) {\r\n    gObjPptx.title = inStrTitle || 'PptxGenJS Presentation';\r\n  };\r\n\r\n  /**\r\n   * Sets the Presentation's Author\r\n   */\r\n  this.setAuthor = function setAuthor(inStrAuthor) {\r\n    gObjPptx.author = inStrAuthor || 'PptxGenJS';\r\n  };\r\n\r\n  /**\r\n   * DESC: Sets the Presentation's Revision\r\n   * NOTE: PowerPoint requires `revision` be: number only (without \".\" or \",\") otherwise, PPT will throw errors upon opening Presentation.\r\n   */\r\n  this.setRevision = function setRevision(inStrRevision) {\r\n    gObjPptx.revision = inStrRevision || '1';\r\n    gObjPptx.revision = gObjPptx.revision.replace(/[\\.\\,\\-]+/gi,'');\r\n    if ( isNaN(gObjPptx.revision) ) gObjPptx.revision = '1';\r\n  };\r\n\r\n  /**\r\n   * Sets the Presentation's Subject\r\n   */\r\n  this.setSubject = function setSubject(inStrSubject) {\r\n    gObjPptx.subject = inStrSubject || 'PptxGenJS Presentation';\r\n  };\r\n\r\n  /**\r\n   * Sets the Presentation's Company\r\n   */\r\n  this.setCompany = function setCompany(inStrCompany) {\r\n    gObjPptx.company = inStrCompany || 'PptxGenJS';\r\n  };\r\n\r\n  /**\r\n   * Export the Presentation to an .pptx file\r\n   * @param {string} [inStrExportName] - Filename to use for the export\r\n   */\r\n  this.save = function save(inStrExportName, funcCallback, outputType) {\r\n    var intRels = 0, arrRelsDone = [];\r\n\r\n    // STEP 1: Set export properties\r\n    if ( funcCallback ) gObjPptx.saveCallback = funcCallback;\r\n    if ( inStrExportName ) gObjPptx.fileName = inStrExportName;\r\n\r\n    // STEP 2: Read/Encode Images\r\n    // PERF: Only send unique paths for encoding (encoding func will find and fill *ALL* matching paths across the Presentation)\r\n\r\n    // A: Slide rels\r\n    gObjPptx.slides.forEach(function(slide){ intRels += encodeImageRelations(slide, arrRelsDone); });\r\n\r\n    // B: Layout rels\r\n    gObjPptx.slideLayouts.forEach(function(layout){ intRels += encodeImageRelations(layout, arrRelsDone); });\r\n\r\n    // C: Master Slide rels\r\n    intRels += encodeImageRelations(gObjPptx.masterSlide, arrRelsDone);\r\n\r\n    // STEP 3: Export now if there's no images to encode (otherwise, last async imgConvert call above will call exportFile)\r\n    if ( intRels == 0 ) doExportPresentation(outputType);\r\n  };\r\n\r\n  /**\r\n   * Add a new Slide to the Presentation\r\n   * @returns {Object[]} slideObj - The new Slide object\r\n   */\r\n  this.addNewSlide = function addNewSlide(inMaster, inMasterOpts) {\r\n    // DEPRECATED: moving to only `inMaster` soon (deprecated in 1.8.0)\r\n    inMasterOpts = ( inMasterOpts && typeof inMasterOpts === 'object' ? inMasterOpts : {} );\r\n    var slideObj = {};\r\n    var slideNum = gObjPptx.slides.length;\r\n    var pageNum  = (slideNum + 1);\r\n\r\n    // A: Add this SLIDE to PRESENTATION, Add default values as well\r\n    gObjPptx.slides[slideNum] = {\r\n      slide: slideObj,\r\n      name: 'Slide ' + pageNum,\r\n      numb: pageNum,\r\n      data: [],\r\n      rels: [],\r\n      slideNumberObj: null,\r\n      hasSlideNumber: false,\r\n      layout: inMaster || '[ default ]'\r\n    };\r\n\r\n    // ==========================================================================\r\n    // PUBLIC METHODS:\r\n    // ==========================================================================\r\n\r\n    slideObj.getPageNumber = function() {\r\n      return pageNum;\r\n    };\r\n\r\n    // WARN: DEPRECATED: (leaves in 1.5 or 2.0 at latest)\r\n    slideObj.hasSlideNumber = function( inBool ) {\r\n      if ( inBool ) gObjPptx.slides[slideNum].hasSlideNumber = inBool;\r\n      else return gObjPptx.slides[slideNum].hasSlideNumber;\r\n    };\r\n    slideObj.slideNumber = function( inObj ) {\r\n      if ( inObj && typeof inObj === 'object' ) gObjPptx.slides[slideNum].slideNumberObj = inObj;\r\n      else return gObjPptx.slides[slideNum].slideNumberObj;\r\n    };\r\n\r\n    /**\r\n     * Generate the chart based on input data.\r\n     *\r\n     * OOXML Chart Spec: ISO/IEC 29500-1:2016(E)\r\n     *\r\n     * @param {object} renderType should belong to: 'column', 'pie'\r\n     * @param {object} data a JSON object with follow the following format\r\n     * {\r\n     *   title: 'eSurvey chart',\r\n     *   data: [\r\n     *    {\r\n     *      name: 'Income',\r\n     *      labels: ['2005', '2006', '2007', '2008', '2009'],\r\n     *      values: [23.5, 26.2, 30.1, 29.5, 24.6]\r\n     *    },\r\n     *    {\r\n     *      name: 'Expense',\r\n     *      labels: ['2005', '2006', '2007', '2008', '2009'],\r\n     *      values: [18.1, 22.8, 23.9, 25.1, 25]\r\n     *    }\r\n     *   ]\r\n     * }\r\n     */\r\n    slideObj.addChart = function ( type, data, opt ) {\r\n      gObjPptxGenerators.addChartDefinition(type, data, opt, gObjPptx.slides[slideNum]);\r\n      return this;\r\n    };\r\n\r\n    // WARN: DEPRECATED: Will soon take a single {object} as argument (per current docs 20161120)\r\n    // FUTURE: slideObj.addImage = function(opt){\r\n    // NOTE: Remote images (eg: \"http://whatev.com/blah\"/from web and/or remote server arent supported yet - we'd need to create an <img>, load it, then send to canvas: https://stackoverflow.com/questions/164181/how-to-fetch-a-remote-image-to-display-in-a-canvas)\r\n    slideObj.addImage = function( strImagePath, intPosX, intPosY, intSizeX, intSizeY, strImageData ) {\r\n      if (intPosX === undefined && typeof(strImagePath) === 'object') {\r\n        intPosX = gObjPptx.slides[slideNum];\r\n      }\r\n      gObjPptxGenerators.addImageDefinition(strImagePath, intPosX || gObjPptx.slides[slideNum], intPosY, intSizeX, intSizeY, strImageData, gObjPptx.slides[slideNum]);\r\n      return this;\r\n    };\r\n\r\n    slideObj.addMedia = function( opt ) {\r\n      var intRels  = 1;\r\n      var intPosX  = (opt.x || 0);\r\n      var intPosY  = (opt.y || 0);\r\n      var intSizeX = (opt.w || 2);\r\n      var intSizeY = (opt.h || 2);\r\n      var strData  = (opt.data || '');\r\n      var strLink  = (opt.link || '');\r\n      var strPath  = (opt.path || '');\r\n      var strType  = (opt.type || 'audio');\r\n      var strExtn  = 'mp3';\r\n\r\n      // STEP 1: REALITY-CHECK\r\n      if ( !strPath && !strData && strType != 'online' ) {\r\n        console.error('ERROR: `addMedia()` requires either \\'data\\' or \\'path\\' values!');\r\n        return null;\r\n      }\r\n      else if ( strData && strData.toLowerCase().indexOf('base64,') == -1 ) {\r\n        console.error('ERROR: Media `data` value lacks a base64 header! Ex: \\'video/mpeg;base64,NMP[...]\\')');\r\n        return null;\r\n      }\r\n      // Online Video: requires `link`\r\n      if ( strType == 'online' && !strLink ) {\r\n        console.error('ERROR: online videos require `link` value');\r\n        return null;\r\n      }\r\n      // Client-Browser: Cant base64 anything except png basically!\r\n      if ( typeof window !== 'undefined' && window.location.href.indexOf('file:') == 0 && !strData && strType != 'online' ) {\r\n        console.error('ERROR: Client browsers cannot encode media - use pre-encoded base64 `data` or use Node.js');\r\n        return null;\r\n      }\r\n\r\n      // STEP 2: Set vars for this Slide\r\n      var slideObjNum = gObjPptx.slides[slideNum].data.length;\r\n      var slideObjRels = gObjPptx.slides[slideNum].rels;\r\n\r\n      strType = ( strData ? strData.split(';')[0].split('/')[0] : strType );\r\n      strExtn = ( strData ? strData.split(';')[0].split('/')[1] : strPath.split('.').pop() );\r\n\r\n      gObjPptx.slides[slideNum].data[slideObjNum]       = {};\r\n      gObjPptx.slides[slideNum].data[slideObjNum].type  = 'media';\r\n      gObjPptx.slides[slideNum].data[slideObjNum].mtype = strType;\r\n      gObjPptx.slides[slideNum].data[slideObjNum].media = (strPath || 'preencoded.mov');\r\n\r\n      // STEP 3: Set media properties & options\r\n      gObjPptx.slides[slideNum].data[slideObjNum].options    = {};\r\n      gObjPptx.slides[slideNum].data[slideObjNum].options.x  = intPosX;\r\n      gObjPptx.slides[slideNum].data[slideObjNum].options.y  = intPosY;\r\n      gObjPptx.slides[slideNum].data[slideObjNum].options.cx = intSizeX;\r\n      gObjPptx.slides[slideNum].data[slideObjNum].options.cy = intSizeY;\r\n\r\n      // STEP 4: Add this media to this Slide Rels (rId/rels count spans all slides! Count all media to get next rId)\r\n      // NOTE: rId starts at 2 (hence the intRels+1 below) as slideLayout.xml is rId=1!\r\n      $$.each(gObjPptx.slides, function(i,slide){ intRels += slide.rels.length; });\r\n\r\n      if ( strType == 'online' ) {\r\n        slideObjRels.push({\r\n          path: (strPath || 'preencoded'+strExtn),\r\n          type: 'online',\r\n          extn: strExtn,\r\n          data: 'dummy',\r\n          rId:  (intRels+1),\r\n          Target: strLink\r\n        });\r\n        gObjPptx.slides[slideNum].data[slideObjNum].mediaRid = slideObjRels[slideObjRels.length-1].rId;\r\n        // Add preview/overlay image\r\n        slideObjRels.push({\r\n          data: IMG_PLAYBTN,\r\n          path: 'preencoded.png',\r\n          type: 'image/png',\r\n          extn: 'png',\r\n          rId:  (intRels+2),\r\n          Target: '../media/image' + intRels + '.png'\r\n        });\r\n      }\r\n      else {\r\n        // Audio/Video files consume *TWO* rId's:\r\n        // <Relationship Id=\"rId2\" Target=\"../media/media1.mov\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/video\"/>\r\n        // <Relationship Id=\"rId3\" Target=\"../media/media1.mov\" Type=\"http://schemas.microsoft.com/office/2007/relationships/media\"/>\r\n        slideObjRels.push({\r\n          path: (strPath || 'preencoded'+strExtn),\r\n          type: strType+'/'+strExtn,\r\n          extn: strExtn,\r\n          data: (strData || ''),\r\n          rId:  (intRels+1),\r\n          Target: '../media/media' + intRels + '.' + strExtn\r\n        });\r\n        gObjPptx.slides[slideNum].data[slideObjNum].mediaRid = slideObjRels[slideObjRels.length-1].rId;\r\n        slideObjRels.push({\r\n          path: (strPath || 'preencoded'+strExtn),\r\n          type: strType+'/'+strExtn,\r\n          extn: strExtn,\r\n          data: (strData || ''),\r\n          rId:  (intRels+2),\r\n          Target: '../media/media' + intRels + '.' + strExtn\r\n        });\r\n        // Add preview/overlay image\r\n        slideObjRels.push({\r\n          data: IMG_PLAYBTN,\r\n          path: 'preencoded.png',\r\n          type: 'image/png',\r\n          extn: 'png',\r\n          rId:  (intRels+3),\r\n          Target: '../media/image' + intRels + '.png'\r\n        });\r\n      }\r\n\r\n      // LAST: Return this Slide\r\n      return this;\r\n    };\r\n\r\n    slideObj.addShape = function( shape, opt ) {\r\n      gObjPptxGenerators.addShapeDefinition(shape, opt, gObjPptx.slides[slideNum]);\r\n      return this;\r\n    };\r\n\r\n    // RECURSIVE: (sometimes)\r\n    // WARN: DEPRECATED: Will soon combine 2nd and 3rd arguments into single {object} (20161216-v1.1.2) (1.5 or 2.0 at the latest)\r\n    // FUTURE: slideObj.addTable = function(arrTabRows, inOpt){\r\n    // TODO: Move to gObjPptxGenerators\r\n    // TODO: dont forget to update \"this.color\" to \"target.slide.color\" !!!\r\n    slideObj.addTable = function( arrTabRows, inOpt, tabOpt ) {\r\n      var opt = ( inOpt && typeof inOpt === 'object' ? inOpt : {} );\r\n      for (var attr in tabOpt) { opt[attr] = tabOpt[attr]; } // FIXME: DEPRECATED: merge opts for now for non-breaking fix (20161216)\r\n\r\n      // STEP 1: REALITY-CHECK\r\n      if ( arrTabRows == null || arrTabRows.length == 0 || !Array.isArray(arrTabRows) ) {\r\n        console.warn('[warn] addTable: Array expected! USAGE: slide.addTable( [rows], {options} );');\r\n        return null;\r\n      }\r\n\r\n      // STEP 2: Row setup: Handle case where user passed in a simple 1-row array. EX: `[\"cell 1\", \"cell 2\"]`\r\n      //var arrRows = $$.extend(true,[],arrTabRows);\r\n      //if ( !Array.isArray(arrRows[0]) ) arrRows = [ $$.extend(true,[],arrTabRows) ];\r\n      var arrRows = arrTabRows;\r\n      if ( !Array.isArray(arrRows[0]) ) arrRows = [ arrTabRows ];\r\n\r\n      // STEP 3: Set options\r\n      opt.x          = getSmartParseNumber( (opt.x || (EMU/2)), 'X' );\r\n      opt.y          = getSmartParseNumber( (opt.y || EMU), 'Y' );\r\n      opt.cy         = opt.h || opt.cy; // NOTE: Dont set default `cy` - leaving it null triggers auto-rowH in `makeXMLSlide()`\r\n      if ( opt.cy ) opt.cy = getSmartParseNumber( opt.cy, 'Y' );\r\n      opt.h          = opt.cy;\r\n      opt.autoPage   = ( opt.autoPage == false ? false : true );\r\n      opt.font_size  = opt.font_size || DEF_FONT_SIZE;\r\n      opt.lineWeight = ( typeof opt.lineWeight !== 'undefined' && !isNaN(Number(opt.lineWeight)) ? Number(opt.lineWeight) : 0 );\r\n      opt.margin     = (opt.marginPt || opt.margin); // (Legacy Support/DEPRECATED)\r\n      opt.margin     = (opt.margin == 0 || opt.margin ? opt.margin : DEF_CELL_MARGIN_PT);\r\n      if ( !isNaN(opt.margin) ) opt.margin = [Number(opt.margin), Number(opt.margin), Number(opt.margin), Number(opt.margin)];\r\n      if ( opt.lineWeight > 1 ) opt.lineWeight = 1;\r\n      else if ( opt.lineWeight < -1 ) opt.lineWeight = -1;\r\n      // Set default color if needed (table option > inherit from Slide > default to black)\r\n      if ( !opt.color ) opt.color = opt.color || this.color || DEF_FONT_COLOR;\r\n\r\n      // Set/Calc table width\r\n      // Get slide margins - start with default values, then adjust if master or slide margins exist\r\n      var arrTableMargin = DEF_SLIDE_MARGIN_IN;\r\n      // Case 1: Master margins\r\n      if ( inMaster && typeof inMaster.margin !== 'undefined' ) {\r\n        if ( Array.isArray(inMaster.margin) ) arrTableMargin = inMaster.margin;\r\n        else if ( !isNaN(Number(inMaster.margin)) ) arrTableMargin = [Number(inMaster.margin), Number(inMaster.margin), Number(inMaster.margin), Number(inMaster.margin)];\r\n      }\r\n      // Case 2: Table margins\r\n      /* FIXME: add `margin` option to slide options\r\n        else if ( slideObj.margin ) {\r\n          if ( Array.isArray(slideObj.margin) ) arrTableMargin = slideObj.margin;\r\n          else if ( !isNaN(Number(slideObj.margin)) ) arrTableMargin = [Number(slideObj.margin), Number(slideObj.margin), Number(slideObj.margin), Number(slideObj.margin)];\r\n        }\r\n      */\r\n\r\n      // Calc table width depending upon what data we have - several scenarios exist (including bad data, eg: colW doesnt match col count)\r\n      if ( opt.w || opt.cx ) {\r\n        opt.cx = getSmartParseNumber( (opt.w || opt.cx), 'X' );\r\n        opt.w = opt.cx;\r\n      }\r\n      else if ( opt.colW ) {\r\n        if ( typeof opt.colW === 'string' || typeof opt.colW === 'number' ) {\r\n          opt.cx = Math.floor(Number(opt.colW) * arrRows[0].length);\r\n          opt.w = opt.cx;\r\n        }\r\n        else if ( opt.colW && Array.isArray(opt.colW) && opt.colW.length != arrRows[0].length ) {\r\n          console.warn('addTable: colW.length != data.length! Defaulting to evenly distributed col widths.');\r\n\r\n          var numColWidth = Math.floor( ( (gObjPptx.pptLayout.width/EMU) - arrTableMargin[1] - arrTableMargin[3] ) / arrRows[0].length );\r\n          opt.colW = [];\r\n          for (var idx=0; idx<arrRows[0].length; idx++) { opt.colW.push( numColWidth ); }\r\n          opt.cx = Math.floor(numColWidth * arrRows[0].length);\r\n          opt.w = opt.cx;\r\n        }\r\n      }\r\n      else {\r\n        var numTabWidth = ( (gObjPptx.pptLayout.width/EMU) - arrTableMargin[1] - arrTableMargin[3] );\r\n        opt.cx = Math.floor(numTabWidth);\r\n        opt.w = opt.cx;\r\n      }\r\n\r\n      // STEP 4: Convert units to EMU now (we use different logic in makeSlide->table - smartCalc is not used)\r\n      if ( opt.x            < 20 ) opt.x  = inch2Emu(opt.x);\r\n      if ( opt.y            < 20 ) opt.y  = inch2Emu(opt.y);\r\n      if ( opt.cx           < 20 ) opt.cx = inch2Emu(opt.cx);\r\n      if ( opt.cy && opt.cy < 20 ) opt.cy = inch2Emu(opt.cy);\r\n\r\n      // STEP 5: Check for fine-grained formatting, disable auto-page when found\r\n      // Since genXmlTextBody already checks for text array ( text:[{},..{}] ) we're done!\r\n      // Text in individual cells will be formatted as they are added by calls to genXmlTextBody within table builder\r\n      arrRows.forEach(function(row){\r\n        row.forEach(function(cell){\r\n          if ( cell && cell.text && Array.isArray(cell.text) ) opt.autoPage = false;\r\n        });\r\n      });\r\n\r\n      // STEP 6: Create hyperlink rels\r\n      createHyperlinkRels(arrRows, gObjPptx.slides[slideNum].rels);\r\n\r\n      // STEP 7: Auto-Paging: (via {options} and used internally)\r\n      // (used internally by `addSlidesForTable()` to not engage recursion - we've already paged the table data, just add this one)\r\n      if ( opt && opt.autoPage == false ) {\r\n        // Add data (NOTE: Use `extend` to avoid mutation)\r\n        gObjPptx.slides[slideNum].data[gObjPptx.slides[slideNum].data.length] = {\r\n          type:       'table',\r\n          arrTabRows: arrRows,\r\n          options:    $$.extend(true,{},opt)\r\n        };\r\n      }\r\n      else {\r\n        // Loop over rows and create 1-N tables as needed (ISSUE#21)\r\n        getSlidesForTableRows(arrRows,opt).forEach(function(arrRows,idx){\r\n          // A: Create new Slide when needed, otherwise, use existing (NOTE: More than 1 table can be on a Slide, so we will go up AND down the Slide chain)\r\n          var currSlide = ( !gObjPptx.slides[slideNum+idx] ? addNewSlide(inMaster, inMasterOpts) : gObjPptx.slides[slideNum+idx].slide );\r\n\r\n          // B: Reset opt.y to `option`/`margin` after first Slide (ISSUE#43, ISSUE#47, ISSUE#48)\r\n          if ( idx > 0 ) opt.y = inch2Emu( opt.newPageStartY || arrTableMargin[0] );\r\n\r\n          // C: Add this table to new Slide\r\n          opt.autoPage = false;\r\n          currSlide.addTable(arrRows, $$.extend(true,{},opt));\r\n        });\r\n      }\r\n\r\n      // LAST: Return this Slide\r\n      return this;\r\n    };\r\n\r\n    slideObj.addText = function( text, options ) {\r\n      gObjPptxGenerators.addTextDefinition(text, options, gObjPptx.slides[slideNum]);\r\n      return this;\r\n    };\r\n\r\n    // ==========================================================================\r\n    // POST-METHODS:\r\n    // ==========================================================================\r\n\r\n    // NOTE: Use legacy method to add Slide Number as a regular object (an actual Footer slideNum is created and can be enabled in PPT, but i cannot make it show by default arg!, so i'm cheating)\r\n    var objLayout = gObjPptx.slideLayouts.filter(function(layout){ return layout.name == inMaster; })[0];\r\n    if ( objLayout && objLayout.slideNumberObj && !slideObj.slideNumber() ) gObjPptx.slides[slideNum].slideNumberObj = objLayout.slideNumberObj;\r\n\r\n    // Add Master-Slide objects (if any)\r\n    // DEPRECATED - REMOVE in 2.0.0 (20170829)\r\n    // (new `defineSlideMaster()` is a better soln and produces *Actual* layout slides, not merely adding objs to Slide!)\r\n    // for now this function in parallel with defineSlideMaster() providing backwards compatibility\r\n    if ( inMaster && typeof inMaster === 'object' ) {\r\n      // Add Slide Master objects in order\r\n      $$.each(inMaster, function(key,val){\r\n        // ISSUE#7: Allow bkgd image/color override on Slide-level\r\n        if ( key == 'bkgd' && inMasterOpts.bkgd ) val = inMasterOpts.bkgd;\r\n\r\n        // Background color/image\r\n        // DEPRECATED `src` is replaced by `path` in v1.5.0\r\n        if ( key == 'bkgd' ) {\r\n          gObjPptxGenerators.addBackgroundDefinition(val, gObjPptx.slides[slideNum]);\r\n        }\r\n\r\n        // Images **DEPRECATED** (v1.5.0)\r\n        if ( key == 'images' && Array.isArray(val) && val.length > 0 ) {\r\n          $$.each(val, function(i,image){\r\n            slideObj.addImage({\r\n              data: (image.data || ''),\r\n              path: (image.path || image.src || ''),\r\n              x: inch2Emu(image.x),\r\n              y: inch2Emu(image.y),\r\n              w: inch2Emu(image.w || image.cx),\r\n              h: inch2Emu(image.h || image.cy)\r\n            });\r\n          });\r\n        }\r\n\r\n        // Shapes **DEPRECATED** (v1.5.0)\r\n        if ( key == 'shapes' && Array.isArray(val) && val.length > 0 ) {\r\n          $$.each(val, function(i,shape){\r\n            // 1: Grab all options (x, y, color, etc.)\r\n            var objOpts = {};\r\n            $$.each(Object.keys(shape), function(i,key){ if ( shape[key] != 'type' ) objOpts[key] = shape[key]; });\r\n            // 2: Create object using 'type'\r\n            if      ( shape.type == 'text'      ) slideObj.addText(shape.text, objOpts);\r\n            else if ( shape.type == 'line'      ) slideObj.addShape(gObjPptxShapes.LINE, objOpts);\r\n            else if ( shape.type == 'rectangle' ) slideObj.addShape(gObjPptxShapes.RECTANGLE, objOpts);\r\n          });\r\n        }\r\n\r\n        // Add all Slide Master objects in the order they were given (Issue#53)\r\n        if ( key == 'objects' && Array.isArray(val) && val.length > 0 ) {\r\n          val.forEach(function(object){\r\n            var key = Object.keys(object)[0];\r\n            if      ( MASTER_OBJECTS[key] && key == 'chart' ) slideObj.addChart( CHART_TYPES[(object.chart.type||'').toUpperCase()], object.chart.data, object.chart.opts );\r\n            else if ( MASTER_OBJECTS[key] && key == 'image' ) slideObj.addImage(object[key]);\r\n            else if ( MASTER_OBJECTS[key] && key == 'line'  ) slideObj.addShape(gObjPptxShapes.LINE, object[key]);\r\n            else if ( MASTER_OBJECTS[key] && key == 'rect'  ) slideObj.addShape(gObjPptxShapes.RECTANGLE, object[key]);\r\n            else if ( MASTER_OBJECTS[key] && key == 'text'  ) slideObj.addText(object[key].text, object[key].options);\r\n          });\r\n        }\r\n      });\r\n\r\n      // Add Slide Numbers\r\n      if ( typeof inMaster.isNumbered !== 'undefined' ) slideObj.hasSlideNumber(inMaster.isNumbered); // DEPRECATED\r\n      if ( inMaster.slideNumber && typeof inMaster.slideNumber === 'object' ) slideObj.slideNumber(inMaster.slideNumber);\r\n      else if ( inMasterOpts.slideNumber && typeof inMasterOpts.slideNumber === 'object' ) slideObj.slideNumber(inMasterOpts.slideNumber);\r\n    }\r\n\r\n    // LAST: Return this Slide\r\n    return slideObj;\r\n  };\r\n\r\n  /**\r\n   * Adds a new slide master [layout] to the presentation.\r\n   * @param {Object} inObjMasterDef - layout definition\r\n   * @return {Object} this\r\n   */\r\n  this.defineSlideMaster = function defineSlideMaster(inObjMasterDef) {\r\n    if ( !inObjMasterDef.title ) { throw Error('defineSlideMaster() object argument requires a `title` value.'); }\r\n\r\n    var objLayout = {\r\n      name : inObjMasterDef.title,\r\n      slide: {},\r\n      data : [],\r\n      rels : [],\r\n      margin: inObjMasterDef.margin || DEF_SLIDE_MARGIN_IN,\r\n      slideNumberObj: null\r\n    };\r\n\r\n    // STEP 1: Create the Slide Master/Layout\r\n    gObjPptxGenerators.createSlideObject(inObjMasterDef, objLayout);\r\n\r\n    // STEP 2: Add it to layout defs\r\n    gObjPptx.slideLayouts.push(objLayout);\r\n\r\n    // LAST:\r\n    return this;\r\n  };\r\n\r\n  /**\r\n   * Reproduces an HTML table as a PowerPoint table - including column widths, style, etc. - creates 1 or more slides as needed\r\n   * \"Auto-Paging is the future!\" --Elon Musk\r\n   *\r\n   * @param {string} tabEleId - The HTML Element ID of the table\r\n   * @param {array} inOpts - An array of options (e.g.: tabsize)\r\n   */\r\n  this.addSlidesForTable = function addSlidesForTable(tabEleId, inOpts) {\r\n    var api = this;\r\n    var opts = inOpts || {};\r\n    var arrObjTabHeadRows = [], arrObjTabBodyRows = [], arrObjTabFootRows = [];\r\n    var arrColW = [], arrTabColW = [];\r\n    var intTabW = 0;\r\n\r\n    // REALITY-CHECK:\r\n    if ( $$('#'+tabEleId).length == 0 ) { console.error('Table \"'+tabEleId+'\" does not exist!'); return; }\r\n\r\n    var arrInchMargins = [0.5, 0.5, 0.5, 0.5]; // TRBL-style\r\n    opts.margin = (opts.marginPt || opts.margin); // (Legacy Support/DEPRECATED)\r\n    opts.margin = (opts.margin || opts.margin == 0 ? opts.margin : 0.5);\r\n\r\n    if ( opts.master ) {\r\n      if ( typeof opts.master === 'string' ) {\r\n        var objLayout = gObjPptx.slideLayouts.filter(function(layout){ return layout.name == opts.master; })[0];\r\n        if ( objLayout && objLayout.margin ) {\r\n          if ( Array.isArray(objLayout.margin) ) arrInchMargins = objLayout.margin;\r\n          else if ( !isNaN(objLayout.margin) ) arrInchMargins = [objLayout.margin, objLayout.margin, objLayout.margin, objLayout.margin];\r\n          opts.margin = arrInchMargins;\r\n        }\r\n      }\r\n      // LEGACY SUPPORT: DEPRECATED:\r\n      else if ( typeof opts.master === 'object' && opts.master.margin ) {\r\n        if ( Array.isArray(opts.master.margin) ) arrInchMargins = opts.master.margin;\r\n        else if ( !isNaN(opts.master.margin) ) arrInchMargins = [opts.master.margin, opts.master.margin, opts.master.margin, opts.master.margin];\r\n        opts.margin = arrInchMargins;\r\n      }\r\n    }\r\n    else if ( opts && opts.margin ) {\r\n      if ( Array.isArray(opts.margin) ) arrInchMargins = opts.margin;\r\n      else if ( !isNaN(opts.margin) ) arrInchMargins = [opts.margin, opts.margin, opts.margin, opts.margin];\r\n    }\r\n    var emuSlideTabW = ( opts.w ? inch2Emu(opts.w) : (gObjPptx.pptLayout.width  - inch2Emu(arrInchMargins[1] + arrInchMargins[3])) );\r\n    //var emuSlideTabH = ( opts.h ? inch2Emu(opts.h) : (gObjPptx.pptLayout.height - inch2Emu(arrInchMargins[0] + arrInchMargins[2])) );\r\n\r\n    // STEP 1: Grab table col widths\r\n    $$.each(['thead','tbody','tfoot'], function(i,val){\r\n      if ( $$('#'+tabEleId+' > '+val+' > tr').length > 0 ) {\r\n        $$('#'+tabEleId+' > '+val+' > tr:first-child').find('> th, > td').each(function(){\r\n          // FIXME: This is a hack - guessing at col widths when colspan\r\n          if ( $$(this).attr('colspan') ) {\r\n            for (var idx=0; idx<$$(this).attr('colspan'); idx++ ) {\r\n              arrTabColW.push( Math.round($$(this).outerWidth()/$$(this).attr('colspan')) );\r\n            }\r\n          }\r\n          else {\r\n            arrTabColW.push( $$(this).outerWidth() );\r\n          }\r\n        });\r\n        return false; // break out of .each loop\r\n      }\r\n    });\r\n    $$.each(arrTabColW, function(i,colW){ intTabW += colW; });\r\n\r\n    // STEP 2: Calc/Set column widths by using same column width percent from HTML table\r\n    $$.each(arrTabColW, function(i,colW){\r\n      var intMinWidth = $$('#'+tabEleId+' thead tr:first-child th:nth-child('+ (i+1) +')').data('pptx-min-width');\r\n      var intCalcWidth = Number(((emuSlideTabW * (colW / intTabW * 100) ) / 100 / EMU).toFixed(2));\r\n      arrColW.push( (intMinWidth > intCalcWidth ? intMinWidth : intCalcWidth) );\r\n    });\r\n\r\n    // STEP 3: Iterate over each table element and create data arrays (text and opts)\r\n    // NOTE: We create 3 arrays instead of one so we can loop over body then show header/footer rows on first and last page\r\n    $$.each(['thead','tbody','tfoot'], function(i,val){\r\n      $$('#'+tabEleId+' > '+val+' > tr').each(function(i,row){\r\n        var arrObjTabCells = [];\r\n        $$(row).find('> th, > td').each(function(i,cell){\r\n          // A: Get RGB text/bkgd colors\r\n          var arrRGB1 = [];\r\n          var arrRGB2 = [];\r\n          arrRGB1 = $$(cell).css('color').replace(/\\s+/gi,'').replace('rgba(','').replace('rgb(','').replace(')','').split(',');\r\n          arrRGB2 = $$(cell).css('background-color').replace(/\\s+/gi,'').replace('rgba(','').replace('rgb(','').replace(')','').split(',');\r\n          // ISSUE#57: jQuery default is this rgba value of below giving unstyled tables a black bkgd, so use white instead (FYI: if cell has `background:#000000` jQuery returns 'rgb(0, 0, 0)', so this soln is pretty solid)\r\n          if ( $$(cell).css('background-color') == 'rgba(0, 0, 0, 0)' || $$(cell).css('background-color') == 'transparent' ) arrRGB2 = [255,255,255];\r\n\r\n          // B: Create option object\r\n          var objOpts = {\r\n            font_size: $$(cell).css('font-size').replace(/\\D/gi,''),\r\n            bold:      (( $$(cell).css('font-weight') == 'bold' || Number($$(cell).css('font-weight')) >= 500 ) ? true : false),\r\n            color:     rgbToHex( Number(arrRGB1[0]), Number(arrRGB1[1]), Number(arrRGB1[2]) ),\r\n            fill:      rgbToHex( Number(arrRGB2[0]), Number(arrRGB2[1]), Number(arrRGB2[2]) )\r\n          };\r\n          if ( $$.inArray($$(cell).css('text-align'), ['left','center','right','start','end']) > -1 ) objOpts.align = $$(cell).css('text-align').replace('start','left').replace('end','right');\r\n          if ( $$.inArray($$(cell).css('vertical-align'), ['top','middle','bottom']) > -1 ) objOpts.valign = $$(cell).css('vertical-align');\r\n\r\n          // C: Add padding [margin] (if any)\r\n          // NOTE: Margins translate: px->pt 1:1 (e.g.: a 20px padded cell looks the same in PPTX as 20pt Text Inset/Padding)\r\n          if ( $$(cell).css('padding-left') ) {\r\n            objOpts.margin = [];\r\n            $$.each(['padding-top', 'padding-right', 'padding-bottom', 'padding-left'],function(i,val){\r\n              objOpts.margin.push( Math.round($$(cell).css(val).replace(/\\D/gi,'')) );\r\n            });\r\n          }\r\n\r\n          // D: Add colspan (if any)\r\n          if ( $$(cell).attr('colspan') ) objOpts.colspan = $$(cell).attr('colspan');\r\n\r\n          // E: Add border (if any)\r\n          if ( $$(cell).css('border-top-width') || $$(cell).css('border-right-width') || $$(cell).css('border-bottom-width') || $$(cell).css('border-left-width') ) {\r\n            objOpts.border = [];\r\n            $$.each(['top','right','bottom','left'], function(i,val){\r\n              var intBorderW = Math.round( Number($$(cell).css('border-'+val+'-width').replace('px','')) );\r\n              var arrRGB = [];\r\n              arrRGB = $$(cell).css('border-'+val+'-color').replace(/\\s+/gi,'').replace('rgba(','').replace('rgb(','').replace(')','').split(',');\r\n              var strBorderC = rgbToHex( Number(arrRGB[0]), Number(arrRGB[1]), Number(arrRGB[2]) );\r\n              objOpts.border.push( {pt:intBorderW, color:strBorderC} );\r\n            });\r\n          }\r\n\r\n          // F: Massage cell text so we honor linebreak tag as a line break during line parsing\r\n          var $cell2 = $$(cell).clone();\r\n          $cell2.html( $$(cell).html().replace(/<br[^>]*>/gi,'\\n') );\r\n\r\n          // LAST: Add cell\r\n          arrObjTabCells.push({\r\n            text: $$.trim( $cell2.text() ),\r\n            opts: objOpts\r\n          });\r\n        });\r\n        switch (val) {\r\n        case 'thead': arrObjTabHeadRows.push( arrObjTabCells ); break;\r\n        case 'tbody': arrObjTabBodyRows.push( arrObjTabCells ); break;\r\n        case 'tfoot': arrObjTabFootRows.push( arrObjTabCells ); break;\r\n        default:\r\n        }\r\n      });\r\n    });\r\n\r\n    // STEP 4: NOTE: `margin` is \"cell margin (pt)\" everywhere else tables are used, so explicitly convert to \"slide margin\" here\r\n    if (opts.margin) {\r\n      opts.slideMargin = opts.margin;\r\n      delete(opts.margin);\r\n    }\r\n    // STEP 5: Break table into Slides as needed\r\n    // Pass head-rows as there is an option to add to each table and the parse func needs this daa to fulfill that option\r\n    opts.arrObjTabHeadRows = arrObjTabHeadRows || '';\r\n    opts.colW = arrColW;\r\n\r\n    getSlidesForTableRows( arrObjTabHeadRows.concat(arrObjTabBodyRows).concat(arrObjTabFootRows), opts )\r\n      .forEach(function(arrTabRows){\r\n      // A: Create new Slide\r\n        var newSlide = ( opts.master ? api.addNewSlide(opts.master) : api.addNewSlide() );\r\n\r\n        // B: Add table to Slide\r\n        newSlide.addTable(arrTabRows, {x:(opts.x || arrInchMargins[3]), y:(opts.y || arrInchMargins[0]), w:(emuSlideTabW/EMU), colW:arrColW, autoPage:false});\r\n\r\n        // C: Add any additional objects\r\n        if ( opts.addImage ) newSlide.addImage({ path:opts.addImage.url, x:opts.addImage.x, y:opts.addImage.y, w:opts.addImage.w, h:opts.addImage.h });\r\n        if ( opts.addShape ) newSlide.addShape( opts.addShape.shape, (opts.addShape.opts || {}) );\r\n        if ( opts.addTable ) newSlide.addTable( opts.addTable.rows,  (opts.addTable.opts || {}) );\r\n        if ( opts.addText  ) newSlide.addText(  opts.addText.text,   (opts.addText.opts  || {}) );\r\n      });\r\n  };\r\n};\r\n\r\n// B: Export module\r\nmodule.exports = PptxGenJS;"]}